(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const In=Symbol("Comlink.proxy"),Ee=Symbol("Comlink.endpoint"),Se=Symbol("Comlink.releaseProxy"),pn=Symbol("Comlink.finalizer"),U=Symbol("Comlink.thrown"),Tn=n=>typeof n=="object"&&n!==null||typeof n=="function",Ae={canHandle:n=>Tn(n)&&n[In],serialize(n){const{port1:e,port2:t}=new MessageChannel;return bn(n,e),[t,[t]]},deserialize(n){return n.start(),Re(n)}},Fe={canHandle:n=>Tn(n)&&U in n,serialize({value:n}){let e;return n instanceof Error?e={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:e={isError:!1,value:n},[e,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},Hn=new Map([["proxy",Ae],["throw",Fe]]);function Ce(n,e){for(const t of n)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function bn(n,e=globalThis,t=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!Ce(t,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:o,type:a,path:f}=Object.assign({path:[]},i.data),u=(i.data.argumentList||[]).map(C);let s;try{const l=f.slice(0,-1).reduce((h,p)=>h[p],n),c=f.reduce((h,p)=>h[p],n);switch(a){case"GET":s=c;break;case"SET":l[f.slice(-1)[0]]=C(i.data.value),s=!0;break;case"APPLY":s=c.apply(l,u);break;case"CONSTRUCT":{const h=new c(...u);s=Le(h)}break;case"ENDPOINT":{const{port1:h,port2:p}=new MessageChannel;bn(n,p),s=He(h,[h])}break;case"RELEASE":s=void 0;break;default:return}}catch(l){s={value:l,[U]:0}}Promise.resolve(s).catch(l=>({value:l,[U]:0})).then(l=>{const[c,h]=Q(l);e.postMessage(Object.assign(Object.assign({},c),{id:o}),h),a==="RELEASE"&&(e.removeEventListener("message",r),Ln(e),pn in n&&typeof n[pn]=="function"&&n[pn]())}).catch(l=>{const[c,h]=Q({value:new TypeError("Unserializable return value"),[U]:0});e.postMessage(Object.assign(Object.assign({},c),{id:o}),h)})}),e.start&&e.start()}function Pe(n){return n.constructor.name==="MessagePort"}function Ln(n){Pe(n)&&n.close()}function Re(n,e){return yn(n,[],e)}function K(n){if(n)throw new Error("Proxy has been released and is not useable")}function qn(n){return T(n,{type:"RELEASE"}).then(()=>{Ln(n)})}const Z=new WeakMap,J="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{const e=(Z.get(n)||0)-1;Z.set(n,e),e===0&&qn(n)});function je(n,e){const t=(Z.get(e)||0)+1;Z.set(e,t),J&&J.register(n,e,n)}function Ie(n){J&&J.unregister(n)}function yn(n,e=[],t=function(){}){let r=!1;const i=new Proxy(t,{get(o,a){if(K(r),a===Se)return()=>{Ie(i),qn(n),r=!0};if(a==="then"){if(e.length===0)return{then:()=>i};const f=T(n,{type:"GET",path:e.map(u=>u.toString())}).then(C);return f.then.bind(f)}return yn(n,[...e,a])},set(o,a,f){K(r);const[u,s]=Q(f);return T(n,{type:"SET",path:[...e,a].map(l=>l.toString()),value:u},s).then(C)},apply(o,a,f){K(r);const u=e[e.length-1];if(u===Ee)return T(n,{type:"ENDPOINT"}).then(C);if(u==="bind")return yn(n,e.slice(0,-1));const[s,l]=On(f);return T(n,{type:"APPLY",path:e.map(c=>c.toString()),argumentList:s},l).then(C)},construct(o,a){K(r);const[f,u]=On(a);return T(n,{type:"CONSTRUCT",path:e.map(s=>s.toString()),argumentList:f},u).then(C)}});return je(i,n),i}function Te(n){return Array.prototype.concat.apply([],n)}function On(n){const e=n.map(Q);return[e.map(t=>t[0]),Te(e.map(t=>t[1]))]}const Dn=new WeakMap;function He(n,e){return Dn.set(n,e),n}function Le(n){return Object.assign(n,{[In]:!0})}function Q(n){for(const[e,t]of Hn)if(t.canHandle(n)){const[r,i]=t.serialize(n);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:n},Dn.get(n)||[]]}function C(n){switch(n.type){case"HANDLER":return Hn.get(n.name).deserialize(n.value);case"RAW":return n.value}}function T(n,e,t){return new Promise(r=>{const i=qe();n.addEventListener("message",function o(a){!a.data||!a.data.id||a.data.id!==i||(n.removeEventListener("message",o),r(a.data))}),n.start&&n.start(),n.postMessage(Object.assign({id:i},e),t)})}function qe(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function Oe(n,e=n/2){const t=new Float32Array(n),r=(n-1)/2;let i=0;for(let o=0;o<n;o++)t[o]=Math.exp(-.5*Math.pow((o-r)/e,2)),i+=t[o];for(let o=0;o<n;o++)t[o]/=i;return t}function wn(n,e){const t=[],r=e*2+1,i=Oe(r,e/2),o=n[0].length;for(let a=0;a<n.length;a++){const f=new Float32Array(o);for(let u=0;u<o;u++){let s=0,l=0;for(let c=-e;c<=e;c++)a+c>=0&&a+c<n.length&&(s+=n[a+c][u]*i[c+e],l+=i[c+e]);f[u]=s/l}t.push(f)}return t}function De(n,e,t){const r=new Int32Array(e),i=[];return n.forEach((o,a)=>{for(let s=-t;s<=t;s++)a+s>=0&&a+s<n.length&&r[n[a+s]]++;let f=-1,u=-1;for(let s=0;s<e;s++)r[s]>f&&(f=r[s],u=s),r[s]=0;i.push(u)}),i}function nn(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function ze(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function zn(n){let e,t,r;n.length!==2?(e=nn,t=(f,u)=>nn(n(f),u),r=(f,u)=>n(f)-u):(e=n===nn||n===ze?n:Ve,t=n,r=n);function i(f,u,s=0,l=f.length){if(s<l){if(e(u,u)!==0)return l;do{const c=s+l>>>1;t(f[c],u)<0?s=c+1:l=c}while(s<l)}return s}function o(f,u,s=0,l=f.length){if(s<l){if(e(u,u)!==0)return l;do{const c=s+l>>>1;t(f[c],u)<=0?s=c+1:l=c}while(s<l)}return s}function a(f,u,s=0,l=f.length){const c=i(f,u,s,l-1);return c>s&&r(f[c-1],u)>-r(f[c],u)?c-1:c}return{left:i,center:a,right:o}}function Ve(){return 0}function _e(n){return n===null?NaN:+n}const Be=zn(nn).right;zn(_e).center;const Ge=Math.sqrt(50),Ye=Math.sqrt(10),We=Math.sqrt(2);function en(n,e,t){const r=(e-n)/Math.max(0,t),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Ge?10:o>=Ye?5:o>=We?2:1;let f,u,s;return i<0?(s=Math.pow(10,-i)/a,f=Math.round(n*s),u=Math.round(e*s),f/s<n&&++f,u/s>e&&--u,s=-s):(s=Math.pow(10,i)*a,f=Math.round(n/s),u=Math.round(e/s),f*s<n&&++f,u*s>e&&--u),u<f&&.5<=t&&t<2?en(n,e,t*2):[f,u,s]}function Xe(n,e,t){if(e=+e,n=+n,t=+t,!(t>0))return[];if(n===e)return[n];const r=e<n,[i,o,a]=r?en(e,n,t):en(n,e,t);if(!(o>=i))return[];const f=o-i+1,u=new Array(f);if(r)if(a<0)for(let s=0;s<f;++s)u[s]=(o-s)/-a;else for(let s=0;s<f;++s)u[s]=(o-s)*a;else if(a<0)for(let s=0;s<f;++s)u[s]=(i+s)/-a;else for(let s=0;s<f;++s)u[s]=(i+s)*a;return u}function Mn(n,e,t){return e=+e,n=+n,t=+t,en(n,e,t)[2]}function Ue(n,e,t){e=+e,n=+n,t=+t;const r=e<n,i=r?Mn(e,n,t):Mn(n,e,t);return(r?-1:1)*(i<0?1/-i:i)}function V(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function tn(n,e){var t=Object.create(n.prototype);for(var r in e)t[r]=e[r];return t}function P(){}var _=.7,rn=1/_,H="\\s*([+-]?\\d+)\\s*",B="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",k="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ke=/^#([0-9a-f]{3,8})$/,Ze=new RegExp(`^rgb\\(${H},${H},${H}\\)$`),Je=new RegExp(`^rgb\\(${k},${k},${k}\\)$`),Qe=new RegExp(`^rgba\\(${H},${H},${H},${B}\\)$`),nt=new RegExp(`^rgba\\(${k},${k},${k},${B}\\)$`),et=new RegExp(`^hsl\\(${B},${k},${k}\\)$`),tt=new RegExp(`^hsla\\(${B},${k},${k},${B}\\)$`),Vn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};V(P,G,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:_n,formatHex:_n,formatHex8:rt,formatHsl:it,formatRgb:Bn,toString:Bn});function _n(){return this.rgb().formatHex()}function rt(){return this.rgb().formatHex8()}function it(){return Kn(this).formatHsl()}function Bn(){return this.rgb().formatRgb()}function G(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=Ke.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?Gn(e):t===3?new b(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?an(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?an(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ze.exec(n))?new b(e[1],e[2],e[3],1):(e=Je.exec(n))?new b(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Qe.exec(n))?an(e[1],e[2],e[3],e[4]):(e=nt.exec(n))?an(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=et.exec(n))?Un(e[1],e[2]/100,e[3]/100,1):(e=tt.exec(n))?Un(e[1],e[2]/100,e[3]/100,e[4]):Vn.hasOwnProperty(n)?Gn(Vn[n]):n==="transparent"?new b(NaN,NaN,NaN,0):null}function Gn(n){return new b(n>>16&255,n>>8&255,n&255,1)}function an(n,e,t,r){return r<=0&&(n=e=t=NaN),new b(n,e,t,r)}function Yn(n){return n instanceof P||(n=G(n)),n?(n=n.rgb(),new b(n.r,n.g,n.b,n.opacity)):new b}function d(n,e,t,r){return arguments.length===1?Yn(n):new b(n,e,t,r??1)}function b(n,e,t,r){this.r=+n,this.g=+e,this.b=+t,this.opacity=+r}V(b,d,tn(P,{brighter(n){return n=n==null?rn:Math.pow(rn,n),new b(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?_:Math.pow(_,n),new b(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new b(R(this.r),R(this.g),R(this.b),on(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Wn,formatHex:Wn,formatHex8:at,formatRgb:Xn,toString:Xn}));function Wn(){return`#${j(this.r)}${j(this.g)}${j(this.b)}`}function at(){return`#${j(this.r)}${j(this.g)}${j(this.b)}${j((isNaN(this.opacity)?1:this.opacity)*255)}`}function Xn(){const n=on(this.opacity);return`${n===1?"rgb(":"rgba("}${R(this.r)}, ${R(this.g)}, ${R(this.b)}${n===1?")":`, ${n})`}`}function on(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function R(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function j(n){return n=R(n),(n<16?"0":"")+n.toString(16)}function Un(n,e,t,r){return r<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new w(n,e,t,r)}function Kn(n){if(n instanceof w)return new w(n.h,n.s,n.l,n.opacity);if(n instanceof P||(n=G(n)),!n)return new w;if(n instanceof w)return n;n=n.rgb();var e=n.r/255,t=n.g/255,r=n.b/255,i=Math.min(e,t,r),o=Math.max(e,t,r),a=NaN,f=o-i,u=(o+i)/2;return f?(e===o?a=(t-r)/f+(t<r)*6:t===o?a=(r-e)/f+2:a=(e-t)/f+4,f/=u<.5?o+i:2-o-i,a*=60):f=u>0&&u<1?0:a,new w(a,f,u,n.opacity)}function ot(n,e,t,r){return arguments.length===1?Kn(n):new w(n,e,t,r??1)}function w(n,e,t,r){this.h=+n,this.s=+e,this.l=+t,this.opacity=+r}V(w,ot,tn(P,{brighter(n){return n=n==null?rn:Math.pow(rn,n),new w(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?_:Math.pow(_,n),new w(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*e,i=2*t-r;return new b(kn(n>=240?n-240:n+120,i,r),kn(n,i,r),kn(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new w(Zn(this.h),sn(this.s),sn(this.l),on(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=on(this.opacity);return`${n===1?"hsl(":"hsla("}${Zn(this.h)}, ${sn(this.s)*100}%, ${sn(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Zn(n){return n=(n||0)%360,n<0?n+360:n}function sn(n){return Math.max(0,Math.min(1,n||0))}function kn(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const st=Math.PI/180,ft=180/Math.PI,fn=18,Jn=.96422,Qn=1,ne=.82521,ee=4/29,L=6/29,te=3*L*L,ut=L*L*L;function re(n){if(n instanceof N)return new N(n.l,n.a,n.b,n.opacity);if(n instanceof $)return ie(n);n instanceof b||(n=Yn(n));var e=En(n.r),t=En(n.g),r=En(n.b),i=Nn((.2225045*e+.7168786*t+.0606169*r)/Qn),o,a;return e===t&&t===r?o=a=i:(o=Nn((.4360747*e+.3850649*t+.1430804*r)/Jn),a=Nn((.0139322*e+.0971045*t+.7141733*r)/ne)),new N(116*i-16,500*(o-i),200*(i-a),n.opacity)}function ct(n,e,t,r){return arguments.length===1?re(n):new N(n,e,t,r??1)}function N(n,e,t,r){this.l=+n,this.a=+e,this.b=+t,this.opacity=+r}V(N,ct,tn(P,{brighter(n){return new N(this.l+fn*(n??1),this.a,this.b,this.opacity)},darker(n){return new N(this.l-fn*(n??1),this.a,this.b,this.opacity)},rgb(){var n=(this.l+16)/116,e=isNaN(this.a)?n:n+this.a/500,t=isNaN(this.b)?n:n-this.b/200;return e=Jn*vn(e),n=Qn*vn(n),t=ne*vn(t),new b($n(3.1338561*e-1.6168667*n-.4906146*t),$n(-.9787684*e+1.9161415*n+.033454*t),$n(.0719453*e-.2289914*n+1.4052427*t),this.opacity)}}));function Nn(n){return n>ut?Math.pow(n,1/3):n/te+ee}function vn(n){return n>L?n*n*n:te*(n-ee)}function $n(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function En(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function lt(n){if(n instanceof $)return new $(n.h,n.c,n.l,n.opacity);if(n instanceof N||(n=re(n)),n.a===0&&n.b===0)return new $(NaN,0<n.l&&n.l<100?0:NaN,n.l,n.opacity);var e=Math.atan2(n.b,n.a)*ft;return new $(e<0?e+360:e,Math.sqrt(n.a*n.a+n.b*n.b),n.l,n.opacity)}function Sn(n,e,t,r){return arguments.length===1?lt(n):new $(n,e,t,r??1)}function $(n,e,t,r){this.h=+n,this.c=+e,this.l=+t,this.opacity=+r}function ie(n){if(isNaN(n.h))return new N(n.l,0,0,n.opacity);var e=n.h*st;return new N(n.l,Math.cos(e)*n.c,Math.sin(e)*n.c,n.opacity)}V($,Sn,tn(P,{brighter(n){return new $(this.h,this.c,this.l+fn*(n??1),this.opacity)},darker(n){return new $(this.h,this.c,this.l-fn*(n??1),this.opacity)},rgb(){return ie(this).rgb()}}));var un=n=>()=>n;function ae(n,e){return function(t){return n+t*e}}function ht(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(r){return Math.pow(n+r*e,t)}}function gt(n,e){var t=e-n;return t?ae(n,t>180||t<-180?t-360*Math.round(t/360):t):un(isNaN(n)?e:n)}function dt(n){return(n=+n)==1?Y:function(e,t){return t-e?ht(e,t,n):un(isNaN(e)?t:e)}}function Y(n,e){var t=e-n;return t?ae(n,t):un(isNaN(n)?e:n)}var oe=function n(e){var t=dt(e);function r(i,o){var a=t((i=d(i)).r,(o=d(o)).r),f=t(i.g,o.g),u=t(i.b,o.b),s=Y(i.opacity,o.opacity);return function(l){return i.r=a(l),i.g=f(l),i.b=u(l),i.opacity=s(l),i+""}}return r.gamma=n,r}(1);function mt(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,r=e.slice(),i;return function(o){for(i=0;i<t;++i)r[i]=n[i]*(1-o)+e[i]*o;return r}}function xt(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function pt(n,e){var t=e?e.length:0,r=n?Math.min(t,n.length):0,i=new Array(r),o=new Array(t),a;for(a=0;a<r;++a)i[a]=Cn(n[a],e[a]);for(;a<t;++a)o[a]=e[a];return function(f){for(a=0;a<r;++a)o[a]=i[a](f);return o}}function bt(n,e){var t=new Date;return n=+n,e=+e,function(r){return t.setTime(n*(1-r)+e*r),t}}function cn(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function yt(n,e){var t={},r={},i;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in n?t[i]=Cn(n[i],e[i]):r[i]=e[i];return function(o){for(i in t)r[i]=t[i](o);return r}}var An=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fn=new RegExp(An.source,"g");function wt(n){return function(){return n}}function Mt(n){return function(e){return n(e)+""}}function kt(n,e){var t=An.lastIndex=Fn.lastIndex=0,r,i,o,a=-1,f=[],u=[];for(n=n+"",e=e+"";(r=An.exec(n))&&(i=Fn.exec(e));)(o=i.index)>t&&(o=e.slice(t,o),f[a]?f[a]+=o:f[++a]=o),(r=r[0])===(i=i[0])?f[a]?f[a]+=i:f[++a]=i:(f[++a]=null,u.push({i:a,x:cn(r,i)})),t=Fn.lastIndex;return t<e.length&&(o=e.slice(t),f[a]?f[a]+=o:f[++a]=o),f.length<2?u[0]?Mt(u[0].x):wt(e):(e=u.length,function(s){for(var l=0,c;l<e;++l)f[(c=u[l]).i]=c.x(s);return f.join("")})}function Cn(n,e){var t=typeof e,r;return e==null||t==="boolean"?un(e):(t==="number"?cn:t==="string"?(r=G(e))?(e=r,oe):kt:e instanceof G?oe:e instanceof Date?bt:xt(e)?mt:Array.isArray(e)?pt:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?yt:cn)(n,e)}function Nt(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}function vt(n){return function(e,t){var r=n((e=Sn(e)).h,(t=Sn(t)).h),i=Y(e.c,t.c),o=Y(e.l,t.l),a=Y(e.opacity,t.opacity);return function(f){return e.h=r(f),e.c=i(f),e.l=o(f),e.opacity=a(f),e+""}}}var se=vt(gt);function $t(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function ln(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function q(n){return n=ln(Math.abs(n)),n?n[1]:NaN}function Et(n,e){return function(t,r){for(var i=t.length,o=[],a=0,f=n[0],u=0;i>0&&f>0&&(u+f+1>r&&(f=Math.max(1,r-u)),o.push(t.substring(i-=f,i+f)),!((u+=f+1)>r));)f=n[a=(a+1)%n.length];return o.reverse().join(e)}}function St(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var At=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hn(n){if(!(e=At.exec(n)))throw new Error("invalid format: "+n);var e;return new Pn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}hn.prototype=Pn.prototype;function Pn(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Pn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ft(n){n:for(var e=n.length,t=1,r=-1,i;t<e;++t)switch(n[t]){case".":r=i=t;break;case"0":r===0&&(r=t),i=t;break;default:if(!+n[t])break n;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var fe;function Ct(n,e){var t=ln(n,e);if(!t)return n+"";var r=t[0],i=t[1],o=i-(fe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+ln(n,Math.max(0,e+o-1))[0]}function ue(n,e){var t=ln(n,e);if(!t)return n+"";var r=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var ce={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:$t,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>ue(n*100,e),r:ue,s:Ct,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function le(n){return n}var he=Array.prototype.map,ge=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Pt(n){var e=n.grouping===void 0||n.thousands===void 0?le:Et(he.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",o=n.numerals===void 0?le:St(he.call(n.numerals,String)),a=n.percent===void 0?"%":n.percent+"",f=n.minus===void 0?"−":n.minus+"",u=n.nan===void 0?"NaN":n.nan+"";function s(c){c=hn(c);var h=c.fill,p=c.align,x=c.sign,S=c.symbol,A=c.zero,F=c.width,D=c.comma,v=c.precision,X=c.trim,m=c.type;m==="n"?(D=!0,m="g"):ce[m]||(v===void 0&&(v=12),X=!0,m="g"),(A||h==="0"&&p==="=")&&(A=!0,h="0",p="=");var M=S==="$"?t:S==="#"&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",or=S==="$"?r:/[%p]/.test(m)?a:"",Ne=ce[m],sr=/[defgprs%]/.test(m);v=v===void 0?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function ve(g){var I=M,y=or,z,$e,dn;if(m==="c")y=Ne(g)+y,g="";else{g=+g;var mn=g<0||1/g<0;if(g=isNaN(g)?u:Ne(Math.abs(g),v),X&&(g=Ft(g)),mn&&+g==0&&x!=="+"&&(mn=!1),I=(mn?x==="("?x:f:x==="-"||x==="("?"":x)+I,y=(m==="s"?ge[8+fe/3]:"")+y+(mn&&x==="("?")":""),sr){for(z=-1,$e=g.length;++z<$e;)if(dn=g.charCodeAt(z),48>dn||dn>57){y=(dn===46?i+g.slice(z+1):g.slice(z))+y,g=g.slice(0,z);break}}}D&&!A&&(g=e(g,1/0));var xn=I.length+g.length+y.length,E=xn<F?new Array(F-xn+1).join(h):"";switch(D&&A&&(g=e(E+g,E.length?F-y.length:1/0),E=""),p){case"<":g=I+g+y+E;break;case"=":g=I+E+g+y;break;case"^":g=E.slice(0,xn=E.length>>1)+I+g+y+E.slice(xn);break;default:g=E+I+g+y;break}return o(g)}return ve.toString=function(){return c+""},ve}function l(c,h){var p=s((c=hn(c),c.type="f",c)),x=Math.max(-8,Math.min(8,Math.floor(q(h)/3)))*3,S=Math.pow(10,-x),A=ge[8+x/3];return function(F){return p(S*F)+A}}return{format:s,formatPrefix:l}}var gn,de,me;Rt({thousands:",",grouping:[3],currency:["$",""]});function Rt(n){return gn=Pt(n),de=gn.format,me=gn.formatPrefix,gn}function jt(n){return Math.max(0,-q(Math.abs(n)))}function It(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(q(e)/3)))*3-q(Math.abs(n)))}function Tt(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,q(e)-q(n))+1}function Ht(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function Lt(n){return function(){return n}}function qt(n){return+n}var xe=[0,1];function O(n){return n}function Rn(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:Lt(isNaN(e)?NaN:.5)}function Ot(n,e){var t;return n>e&&(t=n,n=e,e=t),function(r){return Math.max(n,Math.min(e,r))}}function Dt(n,e,t){var r=n[0],i=n[1],o=e[0],a=e[1];return i<r?(r=Rn(i,r),o=t(a,o)):(r=Rn(r,i),o=t(o,a)),function(f){return o(r(f))}}function zt(n,e,t){var r=Math.min(n.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Rn(n[a],n[a+1]),o[a]=t(e[a],e[a+1]);return function(f){var u=Be(n,f,1,r)-1;return o[u](i[u](f))}}function Vt(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function _t(){var n=xe,e=xe,t=Cn,r,i,o,a=O,f,u,s;function l(){var h=Math.min(n.length,e.length);return a!==O&&(a=Ot(n[0],n[h-1])),f=h>2?zt:Dt,u=s=null,c}function c(h){return h==null||isNaN(h=+h)?o:(u||(u=f(n.map(r),e,t)))(r(a(h)))}return c.invert=function(h){return a(i((s||(s=f(e,n.map(r),cn)))(h)))},c.domain=function(h){return arguments.length?(n=Array.from(h,qt),l()):n.slice()},c.range=function(h){return arguments.length?(e=Array.from(h),l()):e.slice()},c.rangeRound=function(h){return e=Array.from(h),t=Nt,l()},c.clamp=function(h){return arguments.length?(a=h?!0:O,l()):a!==O},c.interpolate=function(h){return arguments.length?(t=h,l()):t},c.unknown=function(h){return arguments.length?(o=h,c):o},function(h,p){return r=h,i=p,l()}}function Bt(){return _t()(O,O)}function Gt(n,e,t,r){var i=Ue(n,e,t),o;switch(r=hn(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(n),Math.abs(e));return r.precision==null&&!isNaN(o=It(i,a))&&(r.precision=o),me(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Tt(i,Math.max(Math.abs(n),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=jt(i))&&(r.precision=o-(r.type==="%")*2);break}}return de(r)}function Yt(n){var e=n.domain;return n.ticks=function(t){var r=e();return Xe(r[0],r[r.length-1],t??10)},n.tickFormat=function(t,r){var i=e();return Gt(i[0],i[i.length-1],t??10,r)},n.nice=function(t){t==null&&(t=10);var r=e(),i=0,o=r.length-1,a=r[i],f=r[o],u,s,l=10;for(f<a&&(s=a,a=f,f=s,s=i,i=o,o=s);l-- >0;){if(s=Mn(a,f,t),s===u)return r[i]=a,r[o]=f,e(r);if(s>0)a=Math.floor(a/s)*s,f=Math.ceil(f/s)*s;else if(s<0)a=Math.ceil(a*s)/s,f=Math.floor(f*s)/s;else break;u=s}return n},n}function jn(){var n=Bt();return n.copy=function(){return Vt(n,jn())},Ht.apply(n,arguments),Yt(n)}function W(n,e,t){this.k=n,this.x=e,this.y=t}W.prototype={constructor:W,scale:function(n){return n===1?this:new W(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new W(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},W.prototype;const Wt=[0,7,2,9,4,11,6,1,8,3,10,5];jn().domain([0,1/12,2/12,2.8/12,3.8/12,4.3/12,5.3/12,6.8/12,8/12,8.8/12,9.3/12,10.5/12,1]).interpolate(se).range([d("#FE0000"),d("#FF7300"),d("#FFAA01"),d("#FFD300"),d("#FFFF01"),d("#9FEE00"),d("#01CC00"),d("#009899"),d("#1241AB"),d("#3914B1"),d("#7209AC"),d("#CD0174"),d("#FE0000")]),jn().domain([0,1/12,2/12,3/12,4/12,5/12,6/12,7/12,8/12,9/12,10/12,11/12,1]).interpolate(se).range([d("#da321f"),d("#e06300"),d("#e89b00"),d("#ebcb03"),d("#9fbb04"),d("#2cbe03"),d("#03b779"),d("#06b3bd"),d("#3875cc"),d("#7503db"),d("#c203ae"),d("#e84b90"),d("#da321f")]);const pe=2*Math.PI;function be(n,e,t){for(var r=0,i=0,o=0,a=0;a<n.length;a++){let f=(a+t)%12;r+=n[a]*e[f],i+=n[a]*n[a],o+=e[f]*e[f]}return i=Math.sqrt(i),o=Math.sqrt(o),r/(i*o)}const Xt=[1.7917,-1.2083,.2917,-1.2083,1.2917,.7917,-1.2083,1.2917,-1.2083,.2917,-1.7083,.7917],Ut=[1.7917,-1.2083,.2917,1.2917,-1.2083,.7917,-1.2083,1.2917,.2917,-1.2083,-1.7083,.7917];function ye(n,e,t){const r=t-e;let i=new Float32Array(12);for(let o=e;o<t;o++)for(let a=0;a<12;a++)i[a]+=n[o][a]/r;return Kt(i)}function we(n){const e=Me(n);let t=0,r=0,i=0;for(let f=0;f<24;f++){const u=f<12?f:(f+3)%12,s=Wt[u]/12*pe,l=Math.max(0,e[f]);i+=Math.abs(l)/12,t+=l*Math.cos(s),r+=l*Math.sin(s)}const o=(1+Math.atan2(r,t)/pe)%1,a=Math.sqrt(t*t+r*r)/(i*12);return[o,a,i]}function Kt(n){const e=Me(n);let t=Number.NEGATIVE_INFINITY,r=-1;return e.forEach((i,o)=>{i>t&&(t=i,r=o)}),r}function Me(n){const e=Xt,t=Ut,r=n.reduce((c,h)=>c+h)/12,i=[],o=[];for(let c=0;c<12;c++)i.push(n.reduce((h,p,x)=>h+(p-r)*e[(12+x-c)%12])),o.push(n.reduce((h,p,x)=>h+(p-r)*t[(12+x-c)%12]));const a=Math.sqrt(n.reduce((c,h,p)=>c+Math.pow(h-r,2))),f=Math.sqrt(e.reduce((c,h)=>c+Math.pow(h,2))),u=Math.sqrt(t.reduce((c,h)=>c+Math.pow(h,2))),s=[],l=[];for(let c=0;c<12;c++)s.push(i[c]/(a*f)),l.push(o[c]/(a*u));return[...s,...l]}const Zt=["C","C♯","D","E♭","E","F","F♯","G","G♯","A","B♭","B"],Jt=[0,7,2,9,4,11,6,1,8,3,10,5],ke={major:{name:"Major",weight:1,template:[1,0,0,0,.8,0,0,.5,0,0,0,0]},minor:{name:"minor",weight:1,template:[1,0,0,.8,0,0,0,.5,0,0,0,0]},sus2:{name:"Sus2",weight:.9,template:[1,0,1,0,0,0,0,1,0,0,0,0]},sus4:{name:"Sus4",weight:.9,template:[1,0,0,0,0,1,0,1,0,0,0,0]},dim:{name:"Dim",weight:.9,template:[1,0,0,1,0,0,1,0,0,0,0,0]},aug:{name:"Aug",weight:.9,template:[1,0,0,0,1,0,0,0,1,0,0,0]},maj7:{name:"Maj7",weight:.7,template:[1,0,0,0,1,0,0,1,0,0,0,1]},seven:{name:"7",weight:.7,template:[1,0,0,0,1,0,0,1,0,0,1,0]},min7:{name:"min7",weight:.7,template:[1,0,0,1,0,0,0,1,0,0,1,0]},min6:{name:"min6",weight:.7,template:[1,0,0,1,0,0,0,1,0,1,0,0]},min7b5:{name:"min7/b5",weight:.7,template:[1,0,0,1,0,0,1,0,0,0,1,0]},minmaj7:{name:"minMaj7",weight:.7,template:[1,0,0,1,0,0,0,1,0,0,0,1]},sus27:{name:"Sus2/7",weight:.7,template:[1,0,1,0,0,0,0,1,0,0,0,1]},sus47:{name:"Sus4/7",weight:.7,template:[1,0,0,0,0,1,0,1,0,0,0,1]},dim6:{name:"Dim6",weight:.7,template:[1,0,0,1,0,0,1,0,0,1,0,0]},maj7sharp5:{name:"Maj7/#5",weight:.7,template:[1,0,0,0,1,0,0,0,1,0,0,1]}};function Qt(n){const e=[];return n.forEach(t=>{e.push(nr(t))}),e}function nr(n){const e=[];for(let t=0;t<12;t++)e.push(be(n,ke.major.template,12-t));for(let t=0;t<12;t++)e.push(be(n,ke.minor.template,12-t));return e}function er(n,e){const t=[],r=n[0].length,i=e*2+1;for(let o=0;o<n.length;o++){const a=new Float32Array(r);for(let s=-e;s<=e;s++)if(o+s>=0&&o+s<n.length){const l=n[o+s];for(let c=0;c<r;c++)a[c]+=l[c]/i}let f=0,u=0;for(let s=0;s<r;s++)a[s]>f&&(f=a[s],u=s);for(let s=0;s<r;s++)s!==u&&(a[s]=0);t.push(a)}return t}function tr(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].findIndex(r=>r!==0));return e}function rr(n){const e=[];let t=0;for(let r=0;r<n.length;r++){const i=n[r];i!==t&&(t=i,e.length>0&&(e[e.length-1].endSample=r),e.push({name:ar(i),index:i,angle:ir(i),startSample:r}))}return e[e.length-1].endSample=n.length,e}function ir(n){const e=n>=12?(n+3)%12:n;return Jt[e]/12}function ar(n){return`${Zt[n%12]}${n>=12?"m":""}`}bn({computeChords(n,e,t,r){const i=ye(n,0,n.length),o=.5,f=1/r*.5,u=wn(e,f),s=Qt(u),l=er(s,2),c=tr(l),h=De(c,24,f),p=rr(h),x=[];for(let m=0;m<p.length;m++){const M=p[m];M.start=M.startSample*r,M.end=M.endSample*r,M.end-M.start<o?x.length>0&&(x[x.length-1].endSample=M.endSample,x[x.length-1].end=M.end):x.push(M)}const S=wn(e,5),A=wn(e,75),F=150,D=[],v=[],X=[];for(let m=0;m<S.length;m++)D.push(we(S[m])),v.push(we(A[m])),X.push(ye(e,Math.max(0,m-F/2),Math.min(e.length-1,m+F/2)));return{chords:x,chordsVector:l,key:i,tonalityFeatureSmall:D,tonalityFeatureLarge:v,keyFeature:X}}})})();
