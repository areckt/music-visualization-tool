var Fl=Object.defineProperty;var Dl=(B,O,_)=>O in B?Fl(B,O,{enumerable:!0,configurable:!0,writable:!0,value:_}):B[O]=_;var V=(B,O,_)=>(Dl(B,typeof O!="symbol"?O+"":O,_),_),er=(B,O,_)=>{if(!O.has(B))throw TypeError("Cannot "+_)};var ot=(B,O,_)=>(er(B,O,"read from private field"),_?_.call(B):O.get(B)),rr=(B,O,_)=>{if(O.has(B))throw TypeError("Cannot add the same private member more than once");O instanceof WeakSet?O.add(B):O.set(B,_)},Ee=(B,O,_,_t)=>(er(B,O,"write to private field"),_t?_t.call(B,_):O.set(B,_),_);var nr=(B,O,_)=>(er(B,O,"access private method"),_);(function(){"use strict";var Yt,sr,At,J;var B=Object.freeze({__proto__:null,get default(){return Nt}});/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const O=Symbol("Comlink.proxy"),_=Symbol("Comlink.endpoint"),_t=Symbol("Comlink.releaseProxy"),Ne=Symbol("Comlink.finalizer"),Wt=Symbol("Comlink.thrown"),or=n=>typeof n=="object"&&n!==null||typeof n=="function",xn={canHandle:n=>or(n)&&n[O],serialize(n){const{port1:t,port2:r}=new MessageChannel;return Ie(n,t),[r,[r]]},deserialize(n){return n.start(),In(n)}},Sn={canHandle:n=>or(n)&&Wt in n,serialize({value:n}){let t;return n instanceof Error?t={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:t={isError:!1,value:n},[t,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},ir=new Map([["proxy",xn],["throw",Sn]]);function En(n,t){for(const r of n)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function Ie(n,t=globalThis,r=["*"]){t.addEventListener("message",function e(s){if(!s||!s.data)return;if(!En(r,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:o,type:i,path:l}=Object.assign({path:[]},s.data),a=(s.data.argumentList||[]).map(mt);let u;try{const f=l.slice(0,-1).reduce((c,d)=>c[d],n),h=l.reduce((c,d)=>c[d],n);switch(i){case"GET":u=h;break;case"SET":f[l.slice(-1)[0]]=mt(s.data.value),u=!0;break;case"APPLY":u=h.apply(f,a);break;case"CONSTRUCT":{const c=new h(...a);u=Fn(c)}break;case"ENDPOINT":{const{port1:c,port2:d}=new MessageChannel;Ie(n,d),u=zn(c,[c])}break;case"RELEASE":u=void 0;break;default:return}}catch(f){u={value:f,[Wt]:0}}Promise.resolve(u).catch(f=>({value:f,[Wt]:0})).then(f=>{const[h,c]=Jt(f);t.postMessage(Object.assign(Object.assign({},h),{id:o}),c),i==="RELEASE"&&(t.removeEventListener("message",e),lr(t),Ne in n&&typeof n[Ne]=="function"&&n[Ne]())}).catch(f=>{const[h,c]=Jt({value:new TypeError("Unserializable return value"),[Wt]:0});t.postMessage(Object.assign(Object.assign({},h),{id:o}),c)})}),t.start&&t.start()}function Nn(n){return n.constructor.name==="MessagePort"}function lr(n){Nn(n)&&n.close()}function In(n,t){return Te(n,[],t)}function Xt(n){if(n)throw new Error("Proxy has been released and is not useable")}function ar(n){return Et(n,{type:"RELEASE"}).then(()=>{lr(n)})}const Qt=new WeakMap,Kt="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{const t=(Qt.get(n)||0)-1;Qt.set(n,t),t===0&&ar(n)});function Tn(n,t){const r=(Qt.get(t)||0)+1;Qt.set(t,r),Kt&&Kt.register(n,t,n)}function jn(n){Kt&&Kt.unregister(n)}function Te(n,t=[],r=function(){}){let e=!1;const s=new Proxy(r,{get(o,i){if(Xt(e),i===_t)return()=>{jn(s),ar(n),e=!0};if(i==="then"){if(t.length===0)return{then:()=>s};const l=Et(n,{type:"GET",path:t.map(a=>a.toString())}).then(mt);return l.then.bind(l)}return Te(n,[...t,i])},set(o,i,l){Xt(e);const[a,u]=Jt(l);return Et(n,{type:"SET",path:[...t,i].map(f=>f.toString()),value:a},u).then(mt)},apply(o,i,l){Xt(e);const a=t[t.length-1];if(a===_)return Et(n,{type:"ENDPOINT"}).then(mt);if(a==="bind")return Te(n,t.slice(0,-1));const[u,f]=ur(l);return Et(n,{type:"APPLY",path:t.map(h=>h.toString()),argumentList:u},f).then(mt)},construct(o,i){Xt(e);const[l,a]=ur(i);return Et(n,{type:"CONSTRUCT",path:t.map(u=>u.toString()),argumentList:l},a).then(mt)}});return Tn(s,n),s}function kn(n){return Array.prototype.concat.apply([],n)}function ur(n){const t=n.map(Jt);return[t.map(r=>r[0]),kn(t.map(r=>r[1]))]}const hr=new WeakMap;function zn(n,t){return hr.set(n,t),n}function Fn(n){return Object.assign(n,{[O]:!0})}function Jt(n){for(const[t,r]of ir)if(r.canHandle(n)){const[e,s]=r.serialize(n);return[{type:"HANDLER",name:t,value:e},s]}return[{type:"RAW",value:n},hr.get(n)||[]]}function mt(n){switch(n.type){case"HANDLER":return ir.get(n.name).deserialize(n.value);case"RAW":return n.value}}function Et(n,t,r){return new Promise(e=>{const s=Dn();n.addEventListener("message",function o(i){!i.data||!i.data.id||i.data.id!==s||(n.removeEventListener("message",o),e(i.data))}),n.start&&n.start(),n.postMessage(Object.assign({id:s},t),r)})}function Dn(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var gt={},Rn=Object.freeze({__proto__:null,default:gt});const dt=Object.freeze({UINT8:{name:"UINT8",max:Math.pow(2,8)-1,min:0,scale:Math.pow(2,8)-1,array:Uint8Array},UINT16:{name:"UINT16",max:Math.pow(2,16)-1,min:0,scale:Math.pow(2,16)-1,array:Uint16Array},UINT32:{name:"UINT32",max:Math.pow(2,32)-1,min:0,scale:Math.pow(2,32)-1,array:Uint32Array},INT8:{name:"INT8",max:Math.pow(2,7)-1,min:-Math.pow(2,7),scale:Math.pow(2,7)-1,array:Int8Array},INT16:{name:"INT16",max:Math.pow(2,15)-1,min:-Math.pow(2,15),scale:Math.pow(2,15)-1,array:Int16Array},INT32:{name:"INT32",max:Math.pow(2,31)-1,min:-Math.pow(2,31),scale:Math.pow(2,31)-1,array:Int32Array},FLOAT32:{name:"FLOAT32",max:Number.POSITIVE_INFINITY,min:Number.NEGATIVE_INFINITY,scale:1,array:Float32Array},FLOAT64:{name:"FLOAT64",max:Number.POSITIVE_INFINITY,min:Number.NEGATIVE_INFINITY,scale:1,array:Float64Array}});function fr(n){if(typeof n=="string"){for(const t of Object.values(dt))if(t.name===n)return t}else return n}class L{constructor(t){V(this,"data");V(this,"size");V(this,"featureAmount");V(this,"sampleDuration");V(this,"numberType");V(this,"length");this.size=t.size,this.featureAmount=t.featureAmount||1,this.numberType=fr(t.numberType)||dt.FLOAT32,this.sampleDuration=t.sampleDuration||1,this.length=(this.size*this.size+this.size)/2*this.featureAmount,t.buffer?(this.data=new this.numberType.array(t.buffer),gt(this.length===this.data.length)):this.data=new this.numberType.array(this.length)}static get NumberType(){return dt}static from(t,r){if(typeof t===B)return this.fromMatrix(t);r||(r={});const e=r.featureAmount||t.featureAmount,s=r.numberType||t.numberType,o=r.sampleDuration||t.sampleDuration;return new L({size:t.size,featureAmount:e,numberType:s,sampleDuration:o})}static fromMatrix(t){const r=new L({size:t.width,numberType:t.numberType,sampleDuration:t.sampleDuration});return r.fill((e,s)=>t.getValue(e,s)),r}clone(){const t=new L({size:this.size,numberType:this.numberType,sampleDuration:this.sampleDuration});return t.fillByIndex(r=>this.data[r]),t}getCellFromIndex(t){}hasCell(t,r){return t<=r&&r<this.size&&t>=0&&r>=0}setValue(t,r,e){this.data[(r*r+r)/2*this.featureAmount+t*this.featureAmount]=e}setValueNormalized(t,r,e){this.data[(r*r+r)/2*this.featureAmount+t*this.featureAmount]=e*this.numberType.scale}setValueNormalizedMirrored(t,r,e){t>r?this.data[(t*t+t)/2*this.featureAmount+r*this.featureAmount]=e*this.numberType.scale:this.data[(r*r+r)/2*this.featureAmount+t*this.featureAmount]=e*this.numberType.scale}getValue(t,r,e=0){return this.data[(r*r+r)/2*this.featureAmount+t*this.featureAmount+e]}getValues(t,r){const e=new this.numberType.array(this.featureAmount);for(let s=0;s<this.featureAmount;s++)e[s]=this.data[(r*r+r)/2*this.featureAmount+t*this.featureAmount+s];return e}getValueMirrored(t,r){return t>r?this.data[(t*t+t)/2*this.featureAmount+r*this.featureAmount]:this.data[(r*r+r)/2*this.featureAmount+t*this.featureAmount]}getValuesNormalized(t,r){const e=new this.numberType.array(this.featureAmount);for(let s=0;s<this.featureAmount;s++)e[s]=this.data[(r*r+r)/2*this.featureAmount+t*this.featureAmount+s]/this.numberType.scale;return e}getValueNormalizedMirrored(t,r){return t>r?this.data[(t*t+t)/2*this.featureAmount+r*this.featureAmount]/this.numberType.scale:this.data[(r*r+r)/2*this.featureAmount+t*this.featureAmount]/this.numberType.scale}getValueNormalized(t,r,e=0){return this.data[(r*r+r)/2*this.featureAmount+t*this.featureAmount+e]/this.numberType.scale}getColumnNormalized(t){const r=new Float32Array(this.size);for(let e=0;e<this.size;e++)r[e]=this.getValueNormalizedMirrored(t,e);return r}fillByIndex(t){let r=this.length;for(;r--;)this.data[r]=t(r)}fill(t){for(let r=0;r<this.size;r++){const e=(r*r+r)/2*this.featureAmount;for(let s=0;s<r+1;s++)this.data[e+s*this.featureAmount]=t(s,r)}}fillFeatures(t){for(let r=0;r<this.size;r++){const e=(r*r+r)/2*this.featureAmount;for(let s=0;s<r+1;s++)for(let o=0;o<this.featureAmount;o++)this.data[e+s*this.featureAmount+o]=t(s,r,o)}}fillFeaturesNormalized(t){for(let r=0;r<this.size;r++){const e=(r*r+r)/2*this.featureAmount;for(let s=0;s<r+1;s++)for(let o=0;o<this.featureAmount;o++)this.data[e+s*this.featureAmount+o]=t(s,r,o)*this.numberType.scale}}forEach(t){let r=this.length;for(;r--;)t(this.data[r],r)}forEachCell(t){for(let r=0;r<this.size;r++){const e=(r*r+r)/2*this.featureAmount;for(let s=0;s<r+1;s++)t(s,r,this.data[e+s])}}fillNormalized(t){for(let r=0;r<this.size;r++){const e=(r*r+r)/2;for(let s=0;s<r+1;s++)this.data[e+s]=t(s,r)*this.numberType.scale}}map(t){let r=this.length;for(;r--;)this.data[r]=t(this.data[r])}divide(t){let r=this.length;for(;r--;)this.data[r]/=t}multiply(t){let r=this.length;for(;r--;)this.data[r]*=t}add(t){let r=this.length;for(;r--;)this.data[r]+=t}getFirstFeatureMatrix(){const t=new L(this);return t.fill((r,e)=>this.getValue(r,e)),t}getFeatureMatrix(t){const r=new L(this);return r.fill((e,s)=>this.getValue(e,s,t)),r}getBuffer(){return{type:"HalfMatrix",buffer:this.data.buffer,size:this.size,numberType:this.numberType.name,featureAmount:this.featureAmount,sampleDuration:this.sampleDuration}}getSampleAmount(){return this.size}getSampleDuration(){return this.sampleDuration}getNestedArray(){const t=new Array(this.size);for(let r=0;r<this.size;r++){t[r]=new Array(this.size);for(let e=0;e<this.size;e++)t[r][e]=this.getValueMirrored(e,r)}return t}getNewEmptyMatrix(){return new L(this)}getSize(){return this.size}normalize(){let t=this.numberType.max,r=this.numberType.min;this.forEach(s=>{s>r&&(r=s),s<t&&(t=s)});let e=this.length;for(;e--;)this.data[e]=(this.data[e]-t)/(r-t)}getMeanAndStandardDeviation(){if(this.featureAmount>1)return 0;let t=0;for(let o=0;o<this.size;o++){const i=(o*o+o)/2*this.featureAmount;for(let l=0;l<o+1;l++)t+=this.data[i+l]/this.numberType.scale}const r=t/this.data.length;let e=0;for(let o=0;o<this.size;o++){const i=(o*o+o)/2*this.featureAmount;for(let l=0;l<o+1;l++)e+=Math.pow(this.data[i+l]/this.numberType.scale-r,2)}const s=Math.sqrt(e/this.data.length);return[r,s]}changeDistribution(t,r){const[e,s]=this.getMeanAndStandardDeviation();let o=this.length;for(;o--;){let i=this.data[o]/this.numberType.scale;i-=e,i*=r,i+=e+t,i=Math.min(1,Math.max(0,i)),this.data[o]=i*this.numberType.scale}}}var An=Object.freeze({__proto__:null,default:L});let Nt=class St{constructor(t){V(this,"data");V(this,"width");V(this,"height");V(this,"featureAmount");V(this,"sampleDuration");V(this,"numberType");V(this,"length");this.width=t.width||t.size,this.height=t.height||t.size,this.featureAmount=t.featureAmount||1,this.numberType=fr(t.numberType)||dt.FLOAT32,this.sampleDuration=t.sampleDuration||1,this.length=this.width*this.height*this.featureAmount,t.buffer?(this.data=new this.numberType.array(t.buffer),gt(this.length===this.data.length)):this.data=new this.numberType.array(this.length)}static get NumberType(){return dt}static from(t,r){if(typeof t===An)return this.fromHalfMatrix(t);r||(r={});const e=r.featureAmount||t.featureAmount,s=r.numberType||t.numberType,o=r.sampleDuration||t.sampleDuration,i=t.width||t.size,l=t.height||t.size;return new St({width:i,height:l,featureAmount:e,numberType:s,sampleDuration:o})}static fromHalfMatrix(t){const r=new St({width:t.size,height:t.size,numberType:t.numberType,sampleDuration:t.sampleDuration});return r.fill((e,s)=>t.getValueMirrored(e,s)),r}static createTimeLagMatrix(t){const r=t.size||t.width,e=new St(t);return e.fill((s,o)=>{const i=(s+o)%r;return t.getValueMirrored(i,s)}),e}static combine(t,r){gt(t.size===r.size),gt(t.numberType===r.numberType),gt(t.sampleDuration===r.sampleDuration);const e=t.size,s=t.numberType,o=t.sampleDuration,i=new St({width:e,height:e,numberType:s,sampleDuration:o});return i.fill((l,a)=>l>a?r.getValueMirrored(l,a):t.getValue(l,a)),i}clone(){const t=new St({height:this.height,width:this.width,numberType:this.numberType,sampleDuration:this.sampleDuration});return t.fillByIndex(r=>this.data[r]),t}hasCell(t,r){return t<this.width&&r<this.height&&t>=0&&r>=0}setValue(t,r,e){this.data[(r*this.width+t)*this.featureAmount]=e}getValueMirrored(t,r,e=0){return this.getValue(t,r,e)}getValue(t,r,e=0){return this.data[(r*this.width+t)*this.featureAmount+e]}getValues(t,r){const e=new this.numberType.array(this.featureAmount);for(let s=0;s<this.featureAmount;s++)e[s]=this.data[(r*this.width+t)*this.featureAmount+s];return e}getValuesNormalized(t,r){const e=new this.numberType.array(this.featureAmount);for(let s=0;s<this.featureAmount;s++)e[s]=this.data[(r*this.width+t)*this.featureAmount+s]/this.numberType.scale;return e}getValueNormalizedMirrored(t,r){return this.getValueNormalized(t,r)}getValueNormalized(t,r,e=0){return this.data[(r*this.width+t)*this.featureAmount+e]/this.numberType.scale}getColumnNormalized(t){const r=new Float32Array(this.height);for(let e=0;e<this.height;e++)r[e]=this.data[(e*this.width+t)*this.featureAmount]/this.numberType.scale;return r}fillByIndex(t){let r=this.length;for(;r--;)this.data[r]=t(r)}fill(t){for(let r=0;r<this.height;r++)for(let e=0;e<this.width;e++)this.data[(r*this.width+e)*this.featureAmount]=t(e,r)}fillFeatures(t){for(let r=0;r<this.height;r++)for(let e=0;e<this.width;e++)for(let s=0;s<this.featureAmount;s++)this.data[(r*this.width+e)*this.featureAmount+s]=t(e,r,s)}fillFeaturesNormalized(t){for(let r=0;r<this.height;r++)for(let e=0;e<this.width;e++)for(let s=0;s<this.featureAmount;s++)this.data[(r*this.width+e)*this.featureAmount+s]=t(e,r,s)*this.numberType.scale}forEach(t){let r=this.length;for(;r--;)t(this.data[r],r)}forEachCell(t){for(let r=0;r<this.height;r++)for(let e=0;e<this.width;e++)t(e,r,this.data[(r*this.width+e)*this.featureAmount])}fillNormalized(t){for(let r=0;r<this.height;r++)for(let e=0;e<this.width;e++)this.data[(r*this.width+e)*this.featureAmount]=t(e,r)*this.numberType.max}map(t){let r=this.length;for(;r--;)this.data[r]=t(this.data[r])}divide(t){let r=this.length;for(;r--;)this.data[r]/=t}multiply(t){let r=this.length;for(;r--;)this.data[r]*=t}add(t){let r=this.length;for(;r--;)this.data[r]+=t}getBuffer(){return{type:"Matrix",buffer:this.data.buffer,width:this.width,height:this.height,numberType:this.numberType.name,featureAmount:this.featureAmount,sampleDuration:this.sampleDuration}}getNewEmptyMatrix(){return new St(this)}getSize(){return gt(this.width===this.height),this.width}getSampleAmount(){return this.height}getSampleDuration(){return this.sampleDuration}normalize(){let t=this.numberType.max,r=this.numberType.min;this.forEach(s=>{s>r&&(r=s),s<t&&(t=s)});let e=this.length;for(;e--;)this.data[e]=(this.data[e]-t)/(r-t)}subtract(t){}};function Cn(n,t=n/2){const r=new Float32Array(n),e=(n-1)/2;let s=0;for(let o=0;o<n;o++)r[o]=Math.exp(-.5*Math.pow((o-e)/t,2)),s+=r[o];for(let o=0;o<n;o++)r[o]/=s;return r}function Pn(n,t){const r=[],e=t*2+1,s=Cn(e,t/2),o=n[0].length;for(let i=0;i<n.length;i++){const l=new Float32Array(o);for(let a=0;a<o;a++){let u=0,f=0;for(let h=-t;h<=t;h++)i+h>=0&&i+h<n.length&&(u+=n[i+h][a]*s[h+t],f+=s[h+t]);l[a]=u/f}r.push(l)}return r}const Vn=Math.sqrt(12),$n=Math.sqrt(Math.pow(2,2)*12);function qn(n,t,r){for(var e=0,s=0,o=0,i=0;i<n.length;i++){let l=(i+r)%12;e+=n[i]*t[l],s+=n[i]*n[i],o+=t[l]*t[l]}return s=Math.sqrt(s),o=Math.sqrt(o),e/(s*o)}function On(n,t){return Math.sqrt(Un(n,t))}function Ln(n,t,r){return Math.sqrt(Gn(n,t,r))}function Bn(n,t){return 1-On(n,t)/$n}function cr(n,t,r){return 1-Ln(n,t,r)/Vn}function Un(n,t){let r=0;for(let e=0;e<n.length;e++){const s=n[e]-t[e];r+=s*s}return r}function Gn(n,t,r){let e=0;for(let s=0;s<n.length;s++){let o=(s+r)%12;const i=n[s]-t[o];e+=i*i}return e}function gr(n,t,r,e,s){const o=n.length,i=1e-16;let l=0;for(let c=0;c<o;c++)l+=n[c].length/2;const a=Math.max(0,(r-s)/(l+i)),u=Ct(n),f=(u-s)/(e+i);return{fitness:2*a*f/(a+f+i),normalizedScore:a,coverage:u,normalizedCoverage:f,pathFamilyLength:l,prunedPathFamily:n}}function Yn(n,t,r,e,s){const o=n.length,i=1e-16,l=o-1;let a=0;for(let d=0;d<o;d++)a+=n[d].length/2;const u=Math.max(0,(r-s)/(a+i)),f=Ct(n);let h=(f-s)/(e+i),c=2*u*h/(u+h+i);return c*=l,{fitness:c,normalizedScore:u,coverage:f,normalizedCoverage:h,pathFamilyLength:a,prunedPathFamily:n}}function _n(n,t,r,e,s){const o=n.length,i=1e-16;let l=0;for(let c=0;c<o;c++)l+=n[c].length/2;const a=Math.max(0,(r-s)/(l+i)),u=Ct(n);let f=(u-s)/(e+i);return{fitness:3*a*f*o/(a*f+f*o+o*a),normalizedScore:a,coverage:u,normalizedCoverage:f,pathFamilyLength:l,prunedPathFamily:n}}function Wn(n,t,r,e,s){const[o,i,l]=mr(n,t,s,.25,.05);n=o,t=i,r=l;const a=1e-16,u=n.length,f=u-1;let h=0;for(let N=0;N<u;N++)h+=n[N].length/2;const c=Math.max(0,(r-s)/(h+a)),d=Ct(n);let g=(d-s)/(e+a),w=2*c*g/(c+g+a);return w*=Math.log(f),{fitness:w,normalizedScore:c,coverage:d,normalizedCoverage:g,pathFamilyLength:h,prunedPathFamily:n}}function Xn(n,t,r,e,s){const[o,i,l]=mr(n,t,s,.5,.4);n=o,t=i,r=l;const a=n.length,u=1e-16;let f=s*a;const h=Math.max(0,(r-s)/(f+u)),c=Ct(n),d=(c-s)/(e+u),g=(f-s)/(e+u);return{fitness:2*h*g/(h+g+u),normalizedScore:h,coverage:c,normalizedCoverage:d,pathFamilyLength:f,prunedPathFamily:o,prunedPathScores:i}}function Ct(n){const t=n.length;let r=0;if(t>0)for(let e=0;e<t;e++){const s=n[e][1],o=n[e][n[e].length-1];r+=Math.abs(s-o)}return r}function mr(n,t,r,e=.3,s=.3){const o=t.reduce((h,c)=>h+c,0),i=n.length;let l=0,a=0;t.forEach(h=>{h>l&&(l=h)}),t.forEach(h=>{h>a&&h<l&&(a=h)});const u=[],f=[];for(let h=0;h<i;h++){const c=n[h],d=t[h];d>e*a&&d/r>s&&(u.push(c),f.push(d))}return[u,f,o]}function Zt(n){return new Float32Array(n*n).fill(Number.NEGATIVE_INFINITY)}function Qn(n,t,r){let e;const{D:s,width:o,height:i,score:l}=wr(n,t,r,e),a=yr(s,o,i),u=Kn(n,a,t);return[a,u,l,o]}const dr=1,pr=1;function wr(n,t,r,e){const s=n.getSampleAmount();t<0&&console.error("start below 0: ",t),r>s&&console.error("end above sampleAmount: ",s,"end",r);const i=r-t+1,l=s;e||(e=new Float32Array(l*i).fill(Number.NEGATIVE_INFINITY));const a=-2,u=h=>h<=0?a:h;e[0]=0,e[1]=u(n.getValueNormalized(t,0));for(let h=1;h<l;h++){e[h*i+0]=Math.max(e[(h-1)*i+0],e[(h-1)*i+i-1]),e[h*i+1]=e[h*i+0]+u(n.getValueNormalized(t,h));for(let c=2;c<i;c++){let d;h===1?d=Number.NEGATIVE_INFINITY:d=e[(h-2)*i+c-1],d<0?d*=dr:d*=pr;let g=e[(h-1)*i+c-2];g<0?g*=dr:g*=pr;const w=e[(h-1)*i+c-1];e[h*i+c]=u(n.getValueNormalized(t+c-1,h))+Math.max(w,g,d)}}const f=Math.max(e[(l-1)*i+0],e[(l-1)*i+i-1]);return{D:e,width:i,height:l,score:f}}function yr(n,t,r){const e=[];let s=[],o=r-1,i;n[o*t+t-1]<n[o*t+0]?i=0:(i=t-1,s.push(i-1,o));let l=new Uint16Array(6),a=0;for(;o>0||i>0;)if(l[0]=o-1,l[1]=i-1,o<=2&&i<=2?a=1:o<=2&&i>2?(l[2]=o-1,l[3]=i-2,a=2):o>2&&i<=2?(l[2]=o-2,l[3]=i-1,a=2):(l[2]=o-2,l[3]=i-1,l[4]=o-1,l[5]=i-2,a=3),o===0)i--;else if(i===0)n[(o-1)*t+t-1]>n[(o-1)*t+0]?(o--,i=t-1,s.length>0&&e.push(s),s=[i-1,o]):(o--,i=0);else if(i===1)i=0;else{let u=Number.NEGATIVE_INFINITY;for(let f=0;f<a;f++){let h=n[l[f*2+0]*t+l[f*2+1]];h>u&&(u=h,o=l[f*2+0],i=l[f*2+1])}s.push(i-1,o)}return e.push(s),e}function Kn(n,t,r){let e=[];return t.forEach(s=>{let o=0;for(let l=0;l<s.length;l+=2){const a=r+s[l+0],u=s[l+1],f=n.getValueNormalized(a,u);o+=f}const i=o/(s.length/2);e.push(i)}),e}function Jn(n){const t=n.length,r=new Uint16Array(t*2);if(t>0)for(let e=0;e<t;e++){const s=n[e][1],o=n[e][n[e].length-1];r[e*2]=o,r[e*2+1]=s}return r}function Zn(n,t,r){const{D:e,width:s,height:o,score:i}=wr(r,n,t),l=yr(e,s,o);return Jn(l)}function Hn(n,t,r){const e=Math.floor(n.start/r.getSampleDuration()),o=Math.floor(n.end/r.getSampleDuration())-e+1,i=Math.floor(t.start/r.getSampleDuration()),a=Math.floor(t.end/r.getSampleDuration())-i+1,u=new Float32Array(o*a).fill(Number.NEGATIVE_INFINITY),f=0,h=m=>m<=0?f:m;u[0]=h(r.getValueNormalized(e,i));for(let m=0;m<o;m++)for(let y=0;y<a;y++){if(m===0&&y===0)continue;let M=m-2>=0&&y-1>=0?u[(m-2)*a+y-1]:Number.NEGATIVE_INFINITY,v=m-1>=0&&y-2>=0?u[(m-1)*a+y-2]:Number.NEGATIVE_INFINITY,E=m-1>=0&&y-1>=0?u[(m-1)*a+y-1]:Number.NEGATIVE_INFINITY;u[m*a+y]=h(r.getValueNormalized(i+y,e+m))+Math.max(E,v,M)}const c=u[u.length-1];if(c<=0)return 0;let d=a-1,g=o-1,w=1;for(;d>0||g>0;){let m=g-2>=0&&d-1>=0?u[(g-2)*a+d-1]:Number.NEGATIVE_INFINITY,y=g-1>=0&&d-2>=0?u[(g-1)*a+d-2]:Number.NEGATIVE_INFINITY,M=g-1>=0&&d-1>=0?u[(g-1)*a+d-1]:Number.NEGATIVE_INFINITY;d===0?d--:g===0?g--:m>=y&&m>=M?(g-=2,d-=1):y>=m&&y>=M?(g-=1,d-=2):M>=m&&M>=y&&(g-=1,d-=1),w++}return c/w}function ts(n,t){let r=0;for(let e=0;e<n.length;e+=2)for(let s=0;s<t.length;s+=2){const o=n[e],i=n[e+1],l=t[s],a=t[s+1];if(i<=l||a<=o)continue;const f=Math.min(o,l),c=Math.max(i,a)-f,d=Math.min(i,a),g=Math.max(o,l),N=(d-g)/c;N>r&&(r=N)}return 1-r}function je(n,t,r,e,s){const o=n.getSampleAmount();e||(e=Zt(o));const[i,l,a,u]=Qn(n,t,r),f=(M,v,E,j,S,T)=>{switch(M){case"classic":return gr(v,E,j,S,T);case"fine":return _n(v,E,j,S,T);case"pruned":return Xn(v,E,j,S,T);case"custom":return Yn(v,E,j,S,T);case"customPruned":return Wn(v,E,j,S,T);default:return console.warn("No fitness strategy given, falling back to classic"),gr(v,E,j,S,T)}},{fitness:h,normalizedScore:c,coverage:d,normalizedCoverage:g,pathFamilyLength:w,prunedPathFamily:N,prunedPathScores:m}=f(s,i,l,a,o,u),y=[];return N.forEach(M=>{const v=[];for(let E=0;E<M.length;E+=2){const j=t+M[E],S=M[E+1];v.push([j,S])}y.push(v)}),{score:a,pathScores:l,normalizedScore:c,coverage:d,normalizedCoverage:g,fitness:h,pathFamily:y}}function br(n,t,r,e=1){const s=n.length,o=new L({size:s,numberType:L.NumberType.FLOAT32}),i=[];return n.forEach(l=>{const a=Math.floor(l.start/t.getSampleDuration()),u=Math.floor(l.end/t.getSampleDuration()),f=Zn(a,u,t);i.push(f)}),o.fill((l,a)=>{let u=0;const f=n[l].groupID===n[a].groupID;switch(r){case"DTW":u=(1-Hn(n[l],n[a],t))*(f?e:1);break;case"overlap":u=ts(i[l],i[a]);break}return u}),o}var pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function es(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function ke(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(n).forEach(function(e){var s=Object.getOwnPropertyDescriptor(n,e);Object.defineProperty(r,e,s.get?s:{enumerable:!0,get:function(){return n[e]}})}),r}var ze={exports:{}};ze.exports,function(n){(function(t,r,e){function s(a){var u=this,f=l();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=f(" "),u.s1=f(" "),u.s2=f(" "),u.s0-=f(a),u.s0<0&&(u.s0+=1),u.s1-=f(a),u.s1<0&&(u.s1+=1),u.s2-=f(a),u.s2<0&&(u.s2+=1),f=null}function o(a,u){return u.c=a.c,u.s0=a.s0,u.s1=a.s1,u.s2=a.s2,u}function i(a,u){var f=new s(a),h=u&&u.state,c=f.next;return c.int32=function(){return f.next()*4294967296|0},c.double=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.quick=c,h&&(typeof h=="object"&&o(h,f),c.state=function(){return o(f,{})}),c}function l(){var a=4022871197,u=function(f){f=String(f);for(var h=0;h<f.length;h++){a+=f.charCodeAt(h);var c=.02519603282416938*a;a=c>>>0,c-=a,c*=a,a=c>>>0,c-=a,a+=c*4294967296}return(a>>>0)*23283064365386963e-26};return u}r&&r.exports?r.exports=i:e&&e.amd?e(function(){return i}):this.alea=i})(pt,n,!1)}(ze);var rs=ze.exports,Fe={exports:{}};Fe.exports,function(n){(function(t,r,e){function s(l){var a=this,u="";a.x=0,a.y=0,a.z=0,a.w=0,a.next=function(){var h=a.x^a.x<<11;return a.x=a.y,a.y=a.z,a.z=a.w,a.w^=a.w>>>19^h^h>>>8},l===(l|0)?a.x=l:u+=l;for(var f=0;f<u.length+64;f++)a.x^=u.charCodeAt(f)|0,a.next()}function o(l,a){return a.x=l.x,a.y=l.y,a.z=l.z,a.w=l.w,a}function i(l,a){var u=new s(l),f=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var c=u.next()>>>11,d=(u.next()>>>0)/4294967296,g=(c+d)/(1<<21);while(g===0);return g},h.int32=u.next,h.quick=h,f&&(typeof f=="object"&&o(f,u),h.state=function(){return o(u,{})}),h}r&&r.exports?r.exports=i:e&&e.amd?e(function(){return i}):this.xor128=i})(pt,n,!1)}(Fe);var ns=Fe.exports,De={exports:{}};De.exports,function(n){(function(t,r,e){function s(l){var a=this,u="";a.next=function(){var h=a.x^a.x>>>2;return a.x=a.y,a.y=a.z,a.z=a.w,a.w=a.v,(a.d=a.d+362437|0)+(a.v=a.v^a.v<<4^(h^h<<1))|0},a.x=0,a.y=0,a.z=0,a.w=0,a.v=0,l===(l|0)?a.x=l:u+=l;for(var f=0;f<u.length+64;f++)a.x^=u.charCodeAt(f)|0,f==u.length&&(a.d=a.x<<10^a.x>>>4),a.next()}function o(l,a){return a.x=l.x,a.y=l.y,a.z=l.z,a.w=l.w,a.v=l.v,a.d=l.d,a}function i(l,a){var u=new s(l),f=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var c=u.next()>>>11,d=(u.next()>>>0)/4294967296,g=(c+d)/(1<<21);while(g===0);return g},h.int32=u.next,h.quick=h,f&&(typeof f=="object"&&o(f,u),h.state=function(){return o(u,{})}),h}r&&r.exports?r.exports=i:e&&e.amd?e(function(){return i}):this.xorwow=i})(pt,n,!1)}(De);var ss=De.exports,Re={exports:{}};Re.exports,function(n){(function(t,r,e){function s(l){var a=this;a.next=function(){var f=a.x,h=a.i,c,d;return c=f[h],c^=c>>>7,d=c^c<<24,c=f[h+1&7],d^=c^c>>>10,c=f[h+3&7],d^=c^c>>>3,c=f[h+4&7],d^=c^c<<7,c=f[h+7&7],c=c^c<<13,d^=c^c<<9,f[h]=d,a.i=h+1&7,d};function u(f,h){var c,d=[];if(h===(h|0))d[0]=h;else for(h=""+h,c=0;c<h.length;++c)d[c&7]=d[c&7]<<15^h.charCodeAt(c)+d[c+1&7]<<13;for(;d.length<8;)d.push(0);for(c=0;c<8&&d[c]===0;++c);for(c==8?d[7]=-1:d[c],f.x=d,f.i=0,c=256;c>0;--c)f.next()}u(a,l)}function o(l,a){return a.x=l.x.slice(),a.i=l.i,a}function i(l,a){l==null&&(l=+new Date);var u=new s(l),f=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var c=u.next()>>>11,d=(u.next()>>>0)/4294967296,g=(c+d)/(1<<21);while(g===0);return g},h.int32=u.next,h.quick=h,f&&(f.x&&o(f,u),h.state=function(){return o(u,{})}),h}r&&r.exports?r.exports=i:e&&e.amd?e(function(){return i}):this.xorshift7=i})(pt,n,!1)}(Re);var os=Re.exports,Ae={exports:{}};Ae.exports,function(n){(function(t,r,e){function s(l){var a=this;a.next=function(){var f=a.w,h=a.X,c=a.i,d,g;return a.w=f=f+1640531527|0,g=h[c+34&127],d=h[c=c+1&127],g^=g<<13,d^=d<<17,g^=g>>>15,d^=d>>>12,g=h[c]=g^d,a.i=c,g+(f^f>>>16)|0};function u(f,h){var c,d,g,w,N,m=[],y=128;for(h===(h|0)?(d=h,h=null):(h=h+"\0",d=0,y=Math.max(y,h.length)),g=0,w=-32;w<y;++w)h&&(d^=h.charCodeAt((w+32)%h.length)),w===0&&(N=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,w>=0&&(N=N+1640531527|0,c=m[w&127]^=d+N,g=c==0?g+1:0);for(g>=128&&(m[(h&&h.length||0)&127]=-1),g=127,w=4*128;w>0;--w)d=m[g+34&127],c=m[g=g+1&127],d^=d<<13,c^=c<<17,d^=d>>>15,c^=c>>>12,m[g]=d^c;f.w=N,f.X=m,f.i=g}u(a,l)}function o(l,a){return a.i=l.i,a.w=l.w,a.X=l.X.slice(),a}function i(l,a){l==null&&(l=+new Date);var u=new s(l),f=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var c=u.next()>>>11,d=(u.next()>>>0)/4294967296,g=(c+d)/(1<<21);while(g===0);return g},h.int32=u.next,h.quick=h,f&&(f.X&&o(f,u),h.state=function(){return o(u,{})}),h}r&&r.exports?r.exports=i:e&&e.amd?e(function(){return i}):this.xor4096=i})(pt,n,!1)}(Ae);var is=Ae.exports,Ce={exports:{}};Ce.exports,function(n){(function(t,r,e){function s(l){var a=this,u="";a.next=function(){var h=a.b,c=a.c,d=a.d,g=a.a;return h=h<<25^h>>>7^c,c=c-d|0,d=d<<24^d>>>8^g,g=g-h|0,a.b=h=h<<20^h>>>12^c,a.c=c=c-d|0,a.d=d<<16^c>>>16^g,a.a=g-h|0},a.a=0,a.b=0,a.c=-1640531527,a.d=1367130551,l===Math.floor(l)?(a.a=l/4294967296|0,a.b=l|0):u+=l;for(var f=0;f<u.length+20;f++)a.b^=u.charCodeAt(f)|0,a.next()}function o(l,a){return a.a=l.a,a.b=l.b,a.c=l.c,a.d=l.d,a}function i(l,a){var u=new s(l),f=a&&a.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var c=u.next()>>>11,d=(u.next()>>>0)/4294967296,g=(c+d)/(1<<21);while(g===0);return g},h.int32=u.next,h.quick=h,f&&(typeof f=="object"&&o(f,u),h.state=function(){return o(u,{})}),h}r&&r.exports?r.exports=i:e&&e.amd?e(function(){return i}):this.tychei=i})(pt,n,!1)}(Ce);var ls=Ce.exports,Mr={exports:{}},as=ke(Rn);(function(n){(function(t,r,e){var s=256,o=6,i=52,l="random",a=e.pow(s,o),u=e.pow(2,i),f=u*2,h=s-1,c;function d(v,E,j){var S=[];E=E==!0?{entropy:!0}:E||{};var T=m(N(E.entropy?[v,M(r)]:v??y(),3),S),F=new g(S),p=function(){for(var b=F.g(o),I=a,x=0;b<u;)b=(b+x)*s,I*=s,x=F.g(1);for(;b>=f;)b/=2,I/=2,x>>>=1;return(b+x)/I};return p.int32=function(){return F.g(4)|0},p.quick=function(){return F.g(4)/4294967296},p.double=p,m(M(F.S),r),(E.pass||j||function(b,I,x,z){return z&&(z.S&&w(z,F),b.state=function(){return w(F,{})}),x?(e[l]=b,I):b})(p,T,"global"in E?E.global:this==e,E.state)}function g(v){var E,j=v.length,S=this,T=0,F=S.i=S.j=0,p=S.S=[];for(j||(v=[j++]);T<s;)p[T]=T++;for(T=0;T<s;T++)p[T]=p[F=h&F+v[T%j]+(E=p[T])],p[F]=E;(S.g=function(b){for(var I,x=0,z=S.i,A=S.j,C=S.S;b--;)I=C[z=h&z+1],x=x*s+C[h&(C[z]=C[A=h&A+I])+(C[A]=I)];return S.i=z,S.j=A,x})(s)}function w(v,E){return E.i=v.i,E.j=v.j,E.S=v.S.slice(),E}function N(v,E){var j=[],S=typeof v,T;if(E&&S=="object")for(T in v)try{j.push(N(v[T],E-1))}catch{}return j.length?j:S=="string"?v:v+"\0"}function m(v,E){for(var j=v+"",S,T=0;T<j.length;)E[h&T]=h&(S^=E[h&T]*19)+j.charCodeAt(T++);return M(E)}function y(){try{var v;return c&&(v=c.randomBytes)?v=v(s):(v=new Uint8Array(s),(t.crypto||t.msCrypto).getRandomValues(v)),M(v)}catch{var E=t.navigator,j=E&&E.plugins;return[+new Date,t,j,t.screen,M(r)]}}function M(v){return String.fromCharCode.apply(0,v)}if(m(e.random(),r),n.exports){n.exports=d;try{c=as}catch{}}else e["seed"+l]=d})(typeof self<"u"?self:pt,[],Math)})(Mr);var us=Mr.exports,hs=rs,fs=ns,cs=ss,gs=os,ms=is,ds=ls,wt=us;wt.alea=hs,wt.xor128=fs,wt.xorwow=cs,wt.xorshift7=gs,wt.xor4096=ms,wt.tychei=ds;var ps=wt,ws=es(ps);const ys=2220446049250313e-31;function bs(n){var t,r=ys,e=1e-64/r,s=50,o=0,i=0,l=0,a=0,u=0,f=Pe(n),h=f.length,c=f[0].length;if(h<c)throw"Need more rows than columns";var d=new Array(c),g=new Array(c);for(i=0;i<c;i++)d[i]=g[i]=0;var w=vr([c,c],0);function N(b,I){return b=Math.abs(b),I=Math.abs(I),b>I?b*Math.sqrt(1+I*I/b/b):I==0?b:I*Math.sqrt(1+b*b/I/I)}var m=0,y=0,M=0,v=0,E=0,j=0,S=0;for(i=0;i<c;i++){for(d[i]=y,S=0,u=i+1,l=i;l<h;l++)S+=f[l][i]*f[l][i];if(S<=e)y=0;else for(m=f[i][i],y=Math.sqrt(S),m>=0&&(y=-y),M=m*y-S,f[i][i]=m-y,l=u;l<c;l++){for(S=0,a=i;a<h;a++)S+=f[a][i]*f[a][l];for(m=S/M,a=i;a<h;a++)f[a][l]+=m*f[a][i]}for(g[i]=y,S=0,l=u;l<c;l++)S=S+f[i][l]*f[i][l];if(S<=e)y=0;else{for(m=f[i][i+1],y=Math.sqrt(S),m>=0&&(y=-y),M=m*y-S,f[i][i+1]=m-y,l=u;l<c;l++)d[l]=f[i][l]/M;for(l=u;l<h;l++){for(S=0,a=u;a<c;a++)S+=f[l][a]*f[i][a];for(a=u;a<c;a++)f[l][a]+=S*d[a]}}E=Math.abs(g[i])+Math.abs(d[i]),E>v&&(v=E)}for(i=c-1;i!=-1;i+=-1){if(y!=0){for(M=y*f[i][i+1],l=u;l<c;l++)w[l][i]=f[i][l]/M;for(l=u;l<c;l++){for(S=0,a=u;a<c;a++)S+=f[i][a]*w[a][l];for(a=u;a<c;a++)w[a][l]+=S*w[a][i]}}for(l=u;l<c;l++)w[i][l]=0,w[l][i]=0;w[i][i]=1,y=d[i],u=i}for(i=c-1;i!=-1;i+=-1){for(u=i+1,y=g[i],l=u;l<c;l++)f[i][l]=0;if(y!=0){for(M=f[i][i]*y,l=u;l<c;l++){for(S=0,a=u;a<h;a++)S+=f[a][i]*f[a][l];for(m=S/M,a=i;a<h;a++)f[a][l]+=m*f[a][i]}for(l=i;l<h;l++)f[l][i]=f[l][i]/y}else for(l=i;l<h;l++)f[l][i]=0;f[i][i]+=1}for(r=r*v,a=c-1;a!=-1;a+=-1)for(var T=0;T<s;T++){var F=!1;for(u=a;u!=-1;u+=-1){if(Math.abs(d[u])<=r){F=!0;break}if(Math.abs(g[u-1])<=r)break}if(!F){o=0,S=1;var p=u-1;for(i=u;i<a+1&&(m=S*d[i],d[i]=o*d[i],!(Math.abs(m)<=r));i++)for(y=g[i],M=N(m,y),g[i]=M,o=y/M,S=-m/M,l=0;l<h;l++)E=f[l][p],j=f[l][i],f[l][p]=E*o+j*S,f[l][i]=-E*S+j*o}if(j=g[a],u==a){if(j<0)for(g[a]=-j,l=0;l<c;l++)w[l][a]=-w[l][a];break}if(T>s-1)throw new Error("numeric.js, svd(): no convergence");for(v=g[u],E=g[a-1],y=d[a-1],M=d[a],m=((E-j)*(E+j)+(y-M)*(y+M))/(2*M*E),y=N(m,1),m<0?m=((v-j)*(v+j)+M*(E/(m-y)-M))/v:m=((v-j)*(v+j)+M*(E/(m+y)-M))/v,o=1,S=1,i=u+1;i<a+1;i++){for(y=d[i],E=g[i],M=S*y,y=o*y,j=N(m,M),d[i-1]=j,o=m/j,S=M/j,m=v*o+y*S,y=-v*S+y*o,M=E*S,E=E*o,l=0;l<c;l++)v=w[l][i-1],j=w[l][i],w[l][i-1]=v*o+j*S,w[l][i]=-v*S+j*o;for(j=N(m,M),g[i-1]=j,o=m/j,S=M/j,m=o*y+S*E,v=-S*y+o*E,l=0;l<h;l++)E=f[l][i-1],j=f[l][i],f[l][i-1]=E*o+j*S,f[l][i]=-E*S+j*o}d[u]=0,d[a]=m,g[a]=v}for(i=0;i<g.length;i++)g[i]<r&&(g[i]=0);for(i=0;i<c;i++)for(l=i-1;l>=0;l--)if(g[l]<g[i]){for(o=g[l],g[l]=g[i],g[i]=o,a=0;a<f.length;a++)t=f[a][i],f[a][i]=f[a][l],f[a][l]=t;for(a=0;a<w.length;a++)t=w[a][i],w[a][i]=w[a][l],w[a][l]=t;i=l}return{U:f,S:g,V:w}}function Pe(n,t,r){typeof t>"u"&&(t=0),typeof r>"u"&&(r=Pt(n).length);var e,s=Array(n.length);if(t===r-1){for(e in n)Object.getOwnPropertyDescriptor(n,e)&&(s[e]=n[e]);return s}for(e in n)Object.getOwnPropertyDescriptor(n,e)&&(s[e]=Pe(n[e],t+1,r)),s[e]=Pe(n[e],t+1,r);return s}function vr(n,t,r){typeof r>"u"&&(r=0);var e=n[r],s=Array(e),o;if(r===n.length-1){for(o=e-2;o>=0;o-=2)s[o+1]=t,s[o]=t;return o===-1&&(s[0]=t),s}for(o=e-1;o>=0;o--)s[o]=vr(n,t,r+1);return s}function Pt(n,t,r){if(typeof t>"u"&&(t=[]),typeof n!="object")return t;typeof r>"u"&&(r=0),r in t||(t[r]=0),n.length>t[r]&&(t[r]=n.length);var e;for(e in n)Object.getOwnPropertyDescriptor(n,e)&&Pt(n[e],t,r+1);return t}function xr(n,t){if(typeof t=="number")return t*n;if(t.length)return t[0].length?t.map(r=>r.map(e=>e*n)):n.length&&t.length===n.length?t.map((r,e)=>r*n[e]):t.map(r=>r*n);throw new Error(`Invalid input. A is ${t}, and n is ${n}. A should be a number, array of numbers, or matrix of numbers.`)}function Ms(n,t){if(typeof n=="number")return n/t;if(n.length)return n[0].length?n.map(r=>r.map(e=>e/t)):t.length&&n.length===t.length?n.map((r,e)=>r/t[e]):n.map(r=>r/t);throw new Error(`Invalid input. A is ${n}, and n is ${t}. A should be a number, array of numbers, or matrix of numbers.`)}function vs(n,t){if(typeof n=="number")return Math.pow(n,t);if(n.length)return n[0].length?n.map(r=>r.map(e=>Math.pow(e,t))):n.map(r=>Math.pow(r,t));throw new Error(`Invalid input. A is ${n}, and n is ${t}. A should be a number, array of numbers, or matrix of numbers.`)}function xs(n){if(typeof n=="number")return Math.sqrt(n);if(n.length)return n[0].length?n.map(t=>t.map(r=>Math.sqrt(r))):n.map(t=>Math.sqrt(t));throw new Error(`Invalid input. A is ${n}. A should be a number, array of numbers, or matrix of numbers.`)}function Ss(){var n=arguments.length,t,r=arguments[0],e;for(t=1;t!==n;++t)e=arguments[t],typeof r=="object"?typeof e=="object"?r=Ht(r,e,Pt(r),0,Es):r=Ht(r,e,Pt(r),0,Ns):typeof e=="object"?r=Ht(r,e,Pt(e),0,Is):r+=e;return r}function Es(n,t){var r=t.length,e,s=Array(r);for(e=r-1;e!==-1;--e)s[e]=n[e]+t[e];return s}function Ns(n,t){var r=n.length,e,s=Array(r);for(e=r-1;e!==-1;--e)s[e]=n[e]+t;return s}function Is(n,t){var r=t.length,e,s=Array(r);for(e=r-1;e!==-1;--e)s[e]=n+t[e];return s}function Ht(n,t,r,e,s){if(e===r.length-1)return s(n,t);var o,i=r[e],l=Array(i);for(o=i-1;o>=0;--o)l[o]=Ht(typeof n=="object"?n[o]:n,typeof t=="object"?t[o]:t,r,e+1,s);return l}function Ts(n){var t,r,e=n.length,s=n[0].length,o=Array(s),i,l,a;for(r=0;r<s;r++)o[r]=Array(e);for(t=e-1;t>=1;t-=2){for(l=n[t],i=n[t-1],r=s-1;r>=1;--r)a=o[r],a[t]=l[r],a[t-1]=i[r],--r,a=o[r],a[t]=l[r],a[t-1]=i[r];r===0&&(a=o[0],a[t]=l[0],a[t-1]=i[0])}if(t===0){for(i=n[0],r=s-1;r>=1;--r)o[r][0]=i[r],--r,o[r][0]=i[r];r===0&&(o[0][0]=i[0])}return o}var R={};const js=Object.prototype.toString;function Vt(n){const t=js.call(n);return t.endsWith("Array]")&&!t.includes("Big")}var ks=Object.freeze({__proto__:null,isAnyArray:Vt}),zs=ke(ks);function Fs(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Vt(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var r=t.fromIndex,e=r===void 0?0:r,s=t.toIndex,o=s===void 0?n.length:s;if(e<0||e>=n.length||!Number.isInteger(e))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=e||o>n.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=n[e],l=e+1;l<o;l++)n[l]>i&&(i=n[l]);return i}function Ds(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Vt(n))throw new TypeError("input must be an array");if(n.length===0)throw new TypeError("input must not be empty");var r=t.fromIndex,e=r===void 0?0:r,s=t.toIndex,o=s===void 0?n.length:s;if(e<0||e>=n.length||!Number.isInteger(e))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=e||o>n.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=n[e],l=e+1;l<o;l++)n[l]<i&&(i=n[l]);return i}function Rs(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Vt(n)){if(n.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var r;if(t.output!==void 0){if(!Vt(t.output))throw new TypeError("output option must be an array if specified");r=t.output}else r=new Array(n.length);var e=Ds(n),s=Fs(n);if(e===s)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=t.min,i=o===void 0?t.autoMinMax?e:0:o,l=t.max,a=l===void 0?t.autoMinMax?s:1:l;if(i>=a)throw new RangeError("min option must be smaller than max option");for(var u=(a-i)/(s-e),f=0;f<n.length;f++)r[f]=(n[f]-e)*u+i;return r}var As=Object.freeze({__proto__:null,default:Rs}),Cs=ke(As);Object.defineProperty(R,"__esModule",{value:!0});var Z=zs,Sr=Cs;const te=" ".repeat(2),Er=" ".repeat(4);function Ps(){return Nr(this)}function Nr(n,t={}){const{maxRows:r=15,maxColumns:e=10,maxNumSize:s=8,padMinus:o="auto"}=t;return`${n.constructor.name} {
${te}[
${Er}${Vs(n,r,e,s,o)}
${te}]
${te}rows: ${n.rows}
${te}columns: ${n.columns}
}`}function Vs(n,t,r,e,s){const{rows:o,columns:i}=n,l=Math.min(o,t),a=Math.min(i,r),u=[];if(s==="auto"){s=!1;t:for(let f=0;f<l;f++)for(let h=0;h<a;h++)if(n.get(f,h)<0){s=!0;break t}}for(let f=0;f<l;f++){let h=[];for(let c=0;c<a;c++)h.push($s(n.get(f,c),e,s));u.push(`${h.join(" ")}`)}return a!==i&&(u[u.length-1]+=` ... ${i-r} more columns`),l!==o&&u.push(`... ${o-t} more rows`),u.join(`
${Er}`)}function $s(n,t,r){return(n>=0&&r?` ${Ir(n,t-1)}`:Ir(n,t)).padEnd(t)}function Ir(n,t){let r=n.toString();if(r.length<=t)return r;let e=n.toFixed(t);if(e.length>t&&(e=n.toFixed(Math.max(0,t-(e.length-t)))),e.length<=t&&!e.startsWith("0.000")&&!e.startsWith("-0.000"))return e;let s=n.toExponential(t);return s.length>t&&(s=n.toExponential(Math.max(0,t-(s.length-t)))),s.slice(0)}function qs(n,t){n.prototype.add=function(e){return typeof e=="number"?this.addS(e):this.addM(e)},n.prototype.addS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)+e);return this},n.prototype.addM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)+e.get(s,o));return this},n.add=function(e,s){return new t(e).add(s)},n.prototype.sub=function(e){return typeof e=="number"?this.subS(e):this.subM(e)},n.prototype.subS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)-e);return this},n.prototype.subM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)-e.get(s,o));return this},n.sub=function(e,s){return new t(e).sub(s)},n.prototype.subtract=n.prototype.sub,n.prototype.subtractS=n.prototype.subS,n.prototype.subtractM=n.prototype.subM,n.subtract=n.sub,n.prototype.mul=function(e){return typeof e=="number"?this.mulS(e):this.mulM(e)},n.prototype.mulS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)*e);return this},n.prototype.mulM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)*e.get(s,o));return this},n.mul=function(e,s){return new t(e).mul(s)},n.prototype.multiply=n.prototype.mul,n.prototype.multiplyS=n.prototype.mulS,n.prototype.multiplyM=n.prototype.mulM,n.multiply=n.mul,n.prototype.div=function(e){return typeof e=="number"?this.divS(e):this.divM(e)},n.prototype.divS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)/e);return this},n.prototype.divM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)/e.get(s,o));return this},n.div=function(e,s){return new t(e).div(s)},n.prototype.divide=n.prototype.div,n.prototype.divideS=n.prototype.divS,n.prototype.divideM=n.prototype.divM,n.divide=n.div,n.prototype.mod=function(e){return typeof e=="number"?this.modS(e):this.modM(e)},n.prototype.modS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)%e);return this},n.prototype.modM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)%e.get(s,o));return this},n.mod=function(e,s){return new t(e).mod(s)},n.prototype.modulus=n.prototype.mod,n.prototype.modulusS=n.prototype.modS,n.prototype.modulusM=n.prototype.modM,n.modulus=n.mod,n.prototype.and=function(e){return typeof e=="number"?this.andS(e):this.andM(e)},n.prototype.andS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)&e);return this},n.prototype.andM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)&e.get(s,o));return this},n.and=function(e,s){return new t(e).and(s)},n.prototype.or=function(e){return typeof e=="number"?this.orS(e):this.orM(e)},n.prototype.orS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)|e);return this},n.prototype.orM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)|e.get(s,o));return this},n.or=function(e,s){return new t(e).or(s)},n.prototype.xor=function(e){return typeof e=="number"?this.xorS(e):this.xorM(e)},n.prototype.xorS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)^e);return this},n.prototype.xorM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)^e.get(s,o));return this},n.xor=function(e,s){return new t(e).xor(s)},n.prototype.leftShift=function(e){return typeof e=="number"?this.leftShiftS(e):this.leftShiftM(e)},n.prototype.leftShiftS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)<<e);return this},n.prototype.leftShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)<<e.get(s,o));return this},n.leftShift=function(e,s){return new t(e).leftShift(s)},n.prototype.signPropagatingRightShift=function(e){return typeof e=="number"?this.signPropagatingRightShiftS(e):this.signPropagatingRightShiftM(e)},n.prototype.signPropagatingRightShiftS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)>>e);return this},n.prototype.signPropagatingRightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)>>e.get(s,o));return this},n.signPropagatingRightShift=function(e,s){return new t(e).signPropagatingRightShift(s)},n.prototype.rightShift=function(e){return typeof e=="number"?this.rightShiftS(e):this.rightShiftM(e)},n.prototype.rightShiftS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)>>>e);return this},n.prototype.rightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,this.get(s,o)>>>e.get(s,o));return this},n.rightShift=function(e,s){return new t(e).rightShift(s)},n.prototype.zeroFillRightShift=n.prototype.rightShift,n.prototype.zeroFillRightShiftS=n.prototype.rightShiftS,n.prototype.zeroFillRightShiftM=n.prototype.rightShiftM,n.zeroFillRightShift=n.rightShift,n.prototype.not=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,~this.get(e,s));return this},n.not=function(e){return new t(e).not()},n.prototype.abs=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.abs(this.get(e,s)));return this},n.abs=function(e){return new t(e).abs()},n.prototype.acos=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.acos(this.get(e,s)));return this},n.acos=function(e){return new t(e).acos()},n.prototype.acosh=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.acosh(this.get(e,s)));return this},n.acosh=function(e){return new t(e).acosh()},n.prototype.asin=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.asin(this.get(e,s)));return this},n.asin=function(e){return new t(e).asin()},n.prototype.asinh=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.asinh(this.get(e,s)));return this},n.asinh=function(e){return new t(e).asinh()},n.prototype.atan=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.atan(this.get(e,s)));return this},n.atan=function(e){return new t(e).atan()},n.prototype.atanh=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.atanh(this.get(e,s)));return this},n.atanh=function(e){return new t(e).atanh()},n.prototype.cbrt=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.cbrt(this.get(e,s)));return this},n.cbrt=function(e){return new t(e).cbrt()},n.prototype.ceil=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.ceil(this.get(e,s)));return this},n.ceil=function(e){return new t(e).ceil()},n.prototype.clz32=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.clz32(this.get(e,s)));return this},n.clz32=function(e){return new t(e).clz32()},n.prototype.cos=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.cos(this.get(e,s)));return this},n.cos=function(e){return new t(e).cos()},n.prototype.cosh=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.cosh(this.get(e,s)));return this},n.cosh=function(e){return new t(e).cosh()},n.prototype.exp=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.exp(this.get(e,s)));return this},n.exp=function(e){return new t(e).exp()},n.prototype.expm1=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.expm1(this.get(e,s)));return this},n.expm1=function(e){return new t(e).expm1()},n.prototype.floor=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.floor(this.get(e,s)));return this},n.floor=function(e){return new t(e).floor()},n.prototype.fround=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.fround(this.get(e,s)));return this},n.fround=function(e){return new t(e).fround()},n.prototype.log=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.log(this.get(e,s)));return this},n.log=function(e){return new t(e).log()},n.prototype.log1p=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.log1p(this.get(e,s)));return this},n.log1p=function(e){return new t(e).log1p()},n.prototype.log10=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.log10(this.get(e,s)));return this},n.log10=function(e){return new t(e).log10()},n.prototype.log2=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.log2(this.get(e,s)));return this},n.log2=function(e){return new t(e).log2()},n.prototype.round=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.round(this.get(e,s)));return this},n.round=function(e){return new t(e).round()},n.prototype.sign=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.sign(this.get(e,s)));return this},n.sign=function(e){return new t(e).sign()},n.prototype.sin=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.sin(this.get(e,s)));return this},n.sin=function(e){return new t(e).sin()},n.prototype.sinh=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.sinh(this.get(e,s)));return this},n.sinh=function(e){return new t(e).sinh()},n.prototype.sqrt=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.sqrt(this.get(e,s)));return this},n.sqrt=function(e){return new t(e).sqrt()},n.prototype.tan=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.tan(this.get(e,s)));return this},n.tan=function(e){return new t(e).tan()},n.prototype.tanh=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.tanh(this.get(e,s)));return this},n.tanh=function(e){return new t(e).tanh()},n.prototype.trunc=function(){for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.set(e,s,Math.trunc(this.get(e,s)));return this},n.trunc=function(e){return new t(e).trunc()},n.pow=function(e,s){return new t(e).pow(s)},n.prototype.pow=function(e){return typeof e=="number"?this.powS(e):this.powM(e)},n.prototype.powS=function(e){for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,Math.pow(this.get(s,o),e));return this},n.prototype.powM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let s=0;s<this.rows;s++)for(let o=0;o<this.columns;o++)this.set(s,o,Math.pow(this.get(s,o),e.get(s,o)));return this}}function rt(n,t,r){let e=r?n.rows:n.rows-1;if(t<0||t>e)throw new RangeError("Row index out of range")}function nt(n,t,r){let e=r?n.columns:n.columns-1;if(t<0||t>e)throw new RangeError("Column index out of range")}function It(n,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==n.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function Tt(n,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==n.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function Ve(n,t){if(!Z.isAnyArray(t))throw new TypeError("row indices must be an array");for(let r=0;r<t.length;r++)if(t[r]<0||t[r]>=n.rows)throw new RangeError("row indices are out of range")}function $e(n,t){if(!Z.isAnyArray(t))throw new TypeError("column indices must be an array");for(let r=0;r<t.length;r++)if(t[r]<0||t[r]>=n.columns)throw new RangeError("column indices are out of range")}function qe(n,t,r,e,s){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(re("startRow",t),re("endRow",r),re("startColumn",e),re("endColumn",s),t>r||e>s||t<0||t>=n.rows||r<0||r>=n.rows||e<0||e>=n.columns||s<0||s>=n.columns)throw new RangeError("Submatrix indices are out of range")}function ee(n,t=0){let r=[];for(let e=0;e<n;e++)r.push(t);return r}function re(n,t){if(typeof t!="number")throw new TypeError(`${n} must be a number`)}function jt(n){if(n.isEmpty())throw new Error("Empty matrix has no elements to index")}function Os(n){let t=ee(n.rows);for(let r=0;r<n.rows;++r)for(let e=0;e<n.columns;++e)t[r]+=n.get(r,e);return t}function Ls(n){let t=ee(n.columns);for(let r=0;r<n.rows;++r)for(let e=0;e<n.columns;++e)t[e]+=n.get(r,e);return t}function Bs(n){let t=0;for(let r=0;r<n.rows;r++)for(let e=0;e<n.columns;e++)t+=n.get(r,e);return t}function Us(n){let t=ee(n.rows,1);for(let r=0;r<n.rows;++r)for(let e=0;e<n.columns;++e)t[r]*=n.get(r,e);return t}function Gs(n){let t=ee(n.columns,1);for(let r=0;r<n.rows;++r)for(let e=0;e<n.columns;++e)t[e]*=n.get(r,e);return t}function Ys(n){let t=1;for(let r=0;r<n.rows;r++)for(let e=0;e<n.columns;e++)t*=n.get(r,e);return t}function _s(n,t,r){const e=n.rows,s=n.columns,o=[];for(let i=0;i<e;i++){let l=0,a=0,u=0;for(let f=0;f<s;f++)u=n.get(i,f)-r[i],l+=u,a+=u*u;t?o.push((a-l*l/s)/(s-1)):o.push((a-l*l/s)/s)}return o}function Ws(n,t,r){const e=n.rows,s=n.columns,o=[];for(let i=0;i<s;i++){let l=0,a=0,u=0;for(let f=0;f<e;f++)u=n.get(f,i)-r[i],l+=u,a+=u*u;t?o.push((a-l*l/e)/(e-1)):o.push((a-l*l/e)/e)}return o}function Xs(n,t,r){const e=n.rows,s=n.columns,o=e*s;let i=0,l=0,a=0;for(let u=0;u<e;u++)for(let f=0;f<s;f++)a=n.get(u,f)-r,i+=a,l+=a*a;return t?(l-i*i/o)/(o-1):(l-i*i/o)/o}function Qs(n,t){for(let r=0;r<n.rows;r++)for(let e=0;e<n.columns;e++)n.set(r,e,n.get(r,e)-t[r])}function Ks(n,t){for(let r=0;r<n.rows;r++)for(let e=0;e<n.columns;e++)n.set(r,e,n.get(r,e)-t[e])}function Js(n,t){for(let r=0;r<n.rows;r++)for(let e=0;e<n.columns;e++)n.set(r,e,n.get(r,e)-t)}function Zs(n){const t=[];for(let r=0;r<n.rows;r++){let e=0;for(let s=0;s<n.columns;s++)e+=Math.pow(n.get(r,s),2)/(n.columns-1);t.push(Math.sqrt(e))}return t}function Hs(n,t){for(let r=0;r<n.rows;r++)for(let e=0;e<n.columns;e++)n.set(r,e,n.get(r,e)/t[r])}function to(n){const t=[];for(let r=0;r<n.columns;r++){let e=0;for(let s=0;s<n.rows;s++)e+=Math.pow(n.get(s,r),2)/(n.rows-1);t.push(Math.sqrt(e))}return t}function eo(n,t){for(let r=0;r<n.rows;r++)for(let e=0;e<n.columns;e++)n.set(r,e,n.get(r,e)/t[e])}function ro(n){const t=n.size-1;let r=0;for(let e=0;e<n.columns;e++)for(let s=0;s<n.rows;s++)r+=Math.pow(n.get(s,e),2)/t;return Math.sqrt(r)}function no(n,t){for(let r=0;r<n.rows;r++)for(let e=0;e<n.columns;e++)n.set(r,e,n.get(r,e)/t)}class D{static from1DArray(t,r,e){if(t*r!==e.length)throw new RangeError("data length does not match given dimensions");let o=new k(t,r);for(let i=0;i<t;i++)for(let l=0;l<r;l++)o.set(i,l,e[i*r+l]);return o}static rowVector(t){let r=new k(1,t.length);for(let e=0;e<t.length;e++)r.set(0,e,t[e]);return r}static columnVector(t){let r=new k(t.length,1);for(let e=0;e<t.length;e++)r.set(e,0,t[e]);return r}static zeros(t,r){return new k(t,r)}static ones(t,r){return new k(t,r).fill(1)}static rand(t,r,e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{random:s=Math.random}=e;let o=new k(t,r);for(let i=0;i<t;i++)for(let l=0;l<r;l++)o.set(i,l,s());return o}static randInt(t,r,e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{min:s=0,max:o=1e3,random:i=Math.random}=e;if(!Number.isInteger(s))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(s>=o)throw new RangeError("min must be smaller than max");let l=o-s,a=new k(t,r);for(let u=0;u<t;u++)for(let f=0;f<r;f++){let h=s+Math.round(i()*l);a.set(u,f,h)}return a}static eye(t,r,e){r===void 0&&(r=t),e===void 0&&(e=1);let s=Math.min(t,r),o=this.zeros(t,r);for(let i=0;i<s;i++)o.set(i,i,e);return o}static diag(t,r,e){let s=t.length;r===void 0&&(r=s),e===void 0&&(e=r);let o=Math.min(s,r,e),i=this.zeros(r,e);for(let l=0;l<o;l++)i.set(l,l,t[l]);return i}static min(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);let e=t.rows,s=t.columns,o=new k(e,s);for(let i=0;i<e;i++)for(let l=0;l<s;l++)o.set(i,l,Math.min(t.get(i,l),r.get(i,l)));return o}static max(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);let e=t.rows,s=t.columns,o=new this(e,s);for(let i=0;i<e;i++)for(let l=0;l<s;l++)o.set(i,l,Math.max(t.get(i,l),r.get(i,l)));return o}static checkMatrix(t){return D.isMatrix(t)?t:new k(t)}static isMatrix(t){return t!=null&&t.klass==="Matrix"}get size(){return this.rows*this.columns}apply(t){if(typeof t!="function")throw new TypeError("callback must be a function");for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)t.call(this,r,e);return this}to1DArray(){let t=[];for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)t.push(this.get(r,e));return t}to2DArray(){let t=[];for(let r=0;r<this.rows;r++){t.push([]);for(let e=0;e<this.columns;e++)t[r].push(this.get(r,e))}return t}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(this.get(t,t)!==0)return!1;return!0}isEchelonForm(){let t=0,r=0,e=-1,s=!0,o=!1;for(;t<this.rows&&s;){for(r=0,o=!1;r<this.columns&&o===!1;)this.get(t,r)===0?r++:this.get(t,r)===1&&r>e?(o=!0,e=r):(s=!1,o=!0);t++}return s}isReducedEchelonForm(){let t=0,r=0,e=-1,s=!0,o=!1;for(;t<this.rows&&s;){for(r=0,o=!1;r<this.columns&&o===!1;)this.get(t,r)===0?r++:this.get(t,r)===1&&r>e?(o=!0,e=r):(s=!1,o=!0);for(let i=r+1;i<this.rows;i++)this.get(t,i)!==0&&(s=!1);t++}return s}echelonForm(){let t=this.clone(),r=0,e=0;for(;r<t.rows&&e<t.columns;){let s=r;for(let o=r;o<t.rows;o++)t.get(o,e)>t.get(s,e)&&(s=o);if(t.get(s,e)===0)e++;else{t.swapRows(r,s);let o=t.get(r,e);for(let i=e;i<t.columns;i++)t.set(r,i,t.get(r,i)/o);for(let i=r+1;i<t.rows;i++){let l=t.get(i,e)/t.get(r,e);t.set(i,e,0);for(let a=e+1;a<t.columns;a++)t.set(i,a,t.get(i,a)-t.get(r,a)*l)}r++,e++}}return t}reducedEchelonForm(){let t=this.echelonForm(),r=t.columns,e=t.rows,s=e-1;for(;s>=0;)if(t.maxRow(s)===0)s--;else{let o=0,i=!1;for(;o<e&&i===!1;)t.get(s,o)===1?i=!0:o++;for(let l=0;l<s;l++){let a=t.get(l,o);for(let u=o;u<r;u++){let f=t.get(l,u)-a*t.get(s,u);t.set(l,u,f)}}s--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if(typeof t!="object")throw new TypeError("options must be an object");const{rows:r=1,columns:e=1}=t;if(!Number.isInteger(r)||r<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(e)||e<=0)throw new TypeError("columns must be a positive integer");let s=new k(this.rows*r,this.columns*e);for(let o=0;o<r;o++)for(let i=0;i<e;i++)s.setSubMatrix(this,this.rows*o,this.columns*i);return s}fill(t){for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,t);return this}neg(){return this.mulS(-1)}getRow(t){rt(this,t);let r=[];for(let e=0;e<this.columns;e++)r.push(this.get(t,e));return r}getRowVector(t){return k.rowVector(this.getRow(t))}setRow(t,r){rt(this,t),r=It(this,r);for(let e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}swapRows(t,r){rt(this,t),rt(this,r);for(let e=0;e<this.columns;e++){let s=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,s)}return this}getColumn(t){nt(this,t);let r=[];for(let e=0;e<this.rows;e++)r.push(this.get(e,t));return r}getColumnVector(t){return k.columnVector(this.getColumn(t))}setColumn(t,r){nt(this,t),r=Tt(this,r);for(let e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}swapColumns(t,r){nt(this,t),nt(this,r);for(let e=0;e<this.rows;e++){let s=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,s)}return this}addRowVector(t){t=It(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}subRowVector(t){t=It(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}mulRowVector(t){t=It(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}divRowVector(t){t=It(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}addColumnVector(t){t=Tt(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}subColumnVector(t){t=Tt(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}mulColumnVector(t){t=Tt(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}divColumnVector(t){t=Tt(this,t);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}mulRow(t,r){rt(this,t);for(let e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}mulColumn(t,r){nt(this,t);for(let e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const r=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.get(e,s)>r[e]&&(r[e]=this.get(e,s));return r}case"column":{const r=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.get(e,s)>r[s]&&(r[s]=this.get(e,s));return r}case void 0:{let r=this.get(0,0);for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.get(e,s)>r&&(r=this.get(e,s));return r}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){jt(this);let t=this.get(0,0),r=[0,0];for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.get(e,s)>t&&(t=this.get(e,s),r[0]=e,r[1]=s);return r}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const r=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.get(e,s)<r[e]&&(r[e]=this.get(e,s));return r}case"column":{const r=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.get(e,s)<r[s]&&(r[s]=this.get(e,s));return r}case void 0:{let r=this.get(0,0);for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.get(e,s)<r&&(r=this.get(e,s));return r}default:throw new Error(`invalid option: ${t}`)}}minIndex(){jt(this);let t=this.get(0,0),r=[0,0];for(let e=0;e<this.rows;e++)for(let s=0;s<this.columns;s++)this.get(e,s)<t&&(t=this.get(e,s),r[0]=e,r[1]=s);return r}maxRow(t){if(rt(this,t),this.isEmpty())return NaN;let r=this.get(t,0);for(let e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}maxRowIndex(t){rt(this,t),jt(this);let r=this.get(t,0),e=[t,0];for(let s=1;s<this.columns;s++)this.get(t,s)>r&&(r=this.get(t,s),e[1]=s);return e}minRow(t){if(rt(this,t),this.isEmpty())return NaN;let r=this.get(t,0);for(let e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}minRowIndex(t){rt(this,t),jt(this);let r=this.get(t,0),e=[t,0];for(let s=1;s<this.columns;s++)this.get(t,s)<r&&(r=this.get(t,s),e[1]=s);return e}maxColumn(t){if(nt(this,t),this.isEmpty())return NaN;let r=this.get(0,t);for(let e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}maxColumnIndex(t){nt(this,t),jt(this);let r=this.get(0,t),e=[0,t];for(let s=1;s<this.rows;s++)this.get(s,t)>r&&(r=this.get(s,t),e[0]=s);return e}minColumn(t){if(nt(this,t),this.isEmpty())return NaN;let r=this.get(0,t);for(let e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}minColumnIndex(t){nt(this,t),jt(this);let r=this.get(0,t),e=[0,t];for(let s=1;s<this.rows;s++)this.get(s,t)<r&&(r=this.get(s,t),e[0]=s);return e}diag(){let t=Math.min(this.rows,this.columns),r=[];for(let e=0;e<t;e++)r.push(this.get(e,e));return r}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}dot(t){D.isMatrix(t)&&(t=t.to1DArray());let r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");let e=0;for(let s=0;s<r.length;s++)e+=r[s]*t[s];return e}mmul(t){t=k.checkMatrix(t);let r=this.rows,e=this.columns,s=t.columns,o=new k(r,s),i=new Float64Array(e);for(let l=0;l<s;l++){for(let a=0;a<e;a++)i[a]=t.get(a,l);for(let a=0;a<r;a++){let u=0;for(let f=0;f<e;f++)u+=this.get(a,f)*i[f];o.set(a,l,u)}}return o}strassen2x2(t){t=k.checkMatrix(t);let r=new k(2,2);const e=this.get(0,0),s=t.get(0,0),o=this.get(0,1),i=t.get(0,1),l=this.get(1,0),a=t.get(1,0),u=this.get(1,1),f=t.get(1,1),h=(e+u)*(s+f),c=(l+u)*s,d=e*(i-f),g=u*(a-s),w=(e+o)*f,N=(l-e)*(s+i),m=(o-u)*(a+f),y=h+g-w+m,M=d+w,v=c+g,E=h-c+d+N;return r.set(0,0,y),r.set(0,1,M),r.set(1,0,v),r.set(1,1,E),r}strassen3x3(t){t=k.checkMatrix(t);let r=new k(3,3);const e=this.get(0,0),s=this.get(0,1),o=this.get(0,2),i=this.get(1,0),l=this.get(1,1),a=this.get(1,2),u=this.get(2,0),f=this.get(2,1),h=this.get(2,2),c=t.get(0,0),d=t.get(0,1),g=t.get(0,2),w=t.get(1,0),N=t.get(1,1),m=t.get(1,2),y=t.get(2,0),M=t.get(2,1),v=t.get(2,2),E=(e+s+o-i-l-f-h)*N,j=(e-i)*(-d+N),S=l*(-c+d+w-N-m-y+v),T=(-e+i+l)*(c-d+N),F=(i+l)*(-c+d),p=e*c,b=(-e+u+f)*(c-g+m),I=(-e+u)*(g-m),x=(u+f)*(-c+g),z=(e+s+o-l-a-u-f)*m,A=f*(-c+g+w-N-m-y+M),C=(-o+f+h)*(N+y-M),q=(o-h)*(N-M),G=o*y,Y=(f+h)*(-y+M),W=(-o+l+a)*(m+y-v),at=(o-a)*(m-v),ct=(l+a)*(-y+v),P=s*w,Q=a*M,tt=i*g,et=u*d,X=h*v,xl=p+G+P,Sl=E+T+F+p+C+G+Y,El=p+b+x+z+G+W+ct,Nl=j+S+T+p+G+W+at,Il=j+T+F+p+Q,Tl=G+W+at+ct+tt,jl=p+b+I+A+C+q+G,kl=C+q+G+Y+et,zl=p+b+I+x+X;return r.set(0,0,xl),r.set(0,1,Sl),r.set(0,2,El),r.set(1,0,Nl),r.set(1,1,Il),r.set(1,2,Tl),r.set(2,0,jl),r.set(2,1,kl),r.set(2,2,zl),r}mmulStrassen(t){t=k.checkMatrix(t);let r=this.clone(),e=r.rows,s=r.columns,o=t.rows,i=t.columns;s!==o&&console.warn(`Multiplying ${e} x ${s} and ${o} x ${i} matrix: dimensions do not match.`);function l(h,c,d){let g=h.rows,w=h.columns;if(g===c&&w===d)return h;{let N=D.zeros(c,d);return N=N.setSubMatrix(h,0,0),N}}let a=Math.max(e,o),u=Math.max(s,i);r=l(r,a,u),t=l(t,a,u);function f(h,c,d,g){if(d<=512||g<=512)return h.mmul(c);d%2===1&&g%2===1?(h=l(h,d+1,g+1),c=l(c,d+1,g+1)):d%2===1?(h=l(h,d+1,g),c=l(c,d+1,g)):g%2===1&&(h=l(h,d,g+1),c=l(c,d,g+1));let w=parseInt(h.rows/2,10),N=parseInt(h.columns/2,10),m=h.subMatrix(0,w-1,0,N-1),y=c.subMatrix(0,w-1,0,N-1),M=h.subMatrix(0,w-1,N,h.columns-1),v=c.subMatrix(0,w-1,N,c.columns-1),E=h.subMatrix(w,h.rows-1,0,N-1),j=c.subMatrix(w,c.rows-1,0,N-1),S=h.subMatrix(w,h.rows-1,N,h.columns-1),T=c.subMatrix(w,c.rows-1,N,c.columns-1),F=f(D.add(m,S),D.add(y,T),w,N),p=f(D.add(E,S),y,w,N),b=f(m,D.sub(v,T),w,N),I=f(S,D.sub(j,y),w,N),x=f(D.add(m,M),T,w,N),z=f(D.sub(E,m),D.add(y,v),w,N),A=f(D.sub(M,S),D.add(j,T),w,N),C=D.add(F,I);C.sub(x),C.add(A);let q=D.add(b,x),G=D.add(p,I),Y=D.sub(F,p);Y.add(b),Y.add(z);let W=D.zeros(2*C.rows,2*C.columns);return W=W.setSubMatrix(C,0,0),W=W.setSubMatrix(q,C.rows,0),W=W.setSubMatrix(G,0,C.columns),W=W.setSubMatrix(Y,C.rows,C.columns),W.subMatrix(0,d-1,0,g-1)}return f(r,t,a,u)}scaleRows(t={}){if(typeof t!="object")throw new TypeError("options must be an object");const{min:r=0,max:e=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(r>=e)throw new RangeError("min must be smaller than max");let s=new k(this.rows,this.columns);for(let o=0;o<this.rows;o++){const i=this.getRow(o);i.length>0&&Sr(i,{min:r,max:e,output:i}),s.setRow(o,i)}return s}scaleColumns(t={}){if(typeof t!="object")throw new TypeError("options must be an object");const{min:r=0,max:e=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(e))throw new TypeError("max must be a number");if(r>=e)throw new RangeError("min must be smaller than max");let s=new k(this.rows,this.columns);for(let o=0;o<this.columns;o++){const i=this.getColumn(o);i.length&&Sr(i,{min:r,max:e,output:i}),s.setColumn(o,i)}return s}flipRows(){const t=Math.ceil(this.columns/2);for(let r=0;r<this.rows;r++)for(let e=0;e<t;e++){let s=this.get(r,e),o=this.get(r,this.columns-1-e);this.set(r,e,o),this.set(r,this.columns-1-e,s)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let r=0;r<this.columns;r++)for(let e=0;e<t;e++){let s=this.get(e,r),o=this.get(this.rows-1-e,r);this.set(e,r,o),this.set(this.rows-1-e,r,s)}return this}kroneckerProduct(t){t=k.checkMatrix(t);let r=this.rows,e=this.columns,s=t.rows,o=t.columns,i=new k(r*s,e*o);for(let l=0;l<r;l++)for(let a=0;a<e;a++)for(let u=0;u<s;u++)for(let f=0;f<o;f++)i.set(s*l+u,o*a+f,this.get(l,a)*t.get(u,f));return i}kroneckerSum(t){if(t=k.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let r=this.rows,e=t.rows,s=this.kroneckerProduct(k.eye(e,e)),o=k.eye(r,r).kroneckerProduct(t);return s.add(o)}transpose(){let t=new k(this.columns,this.rows);for(let r=0;r<this.rows;r++)for(let e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}sortRows(t=Tr){for(let r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}sortColumns(t=Tr){for(let r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}subMatrix(t,r,e,s){qe(this,t,r,e,s);let o=new k(r-t+1,s-e+1);for(let i=t;i<=r;i++)for(let l=e;l<=s;l++)o.set(i-t,l-e,this.get(i,l));return o}subMatrixRow(t,r,e){if(r===void 0&&(r=0),e===void 0&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");let s=new k(t.length,e-r+1);for(let o=0;o<t.length;o++)for(let i=r;i<=e;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);s.set(o,i-r,this.get(t[o],i))}return s}subMatrixColumn(t,r,e){if(r===void 0&&(r=0),e===void 0&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");let s=new k(e-r+1,t.length);for(let o=0;o<t.length;o++)for(let i=r;i<=e;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);s.set(i-r,o,this.get(i,t[o]))}return s}setSubMatrix(t,r,e){if(t=k.checkMatrix(t),t.isEmpty())return this;let s=r+t.rows-1,o=e+t.columns-1;qe(this,r,s,e,o);for(let i=0;i<t.rows;i++)for(let l=0;l<t.columns;l++)this.set(r+i,e+l,t.get(i,l));return this}selection(t,r){Ve(this,t),$e(this,r);let e=new k(t.length,r.length);for(let s=0;s<t.length;s++){let o=t[s];for(let i=0;i<r.length;i++){let l=r[i];e.set(s,i,this.get(o,l))}}return e}trace(){let t=Math.min(this.rows,this.columns),r=0;for(let e=0;e<t;e++)r+=this.get(e,e);return r}clone(){return this.constructor.copy(this,new k(this.rows,this.columns))}static copy(t,r){for(const[e,s,o]of t.entries())r.set(e,s,o);return r}sum(t){switch(t){case"row":return Os(this);case"column":return Ls(this);case void 0:return Bs(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return Us(this);case"column":return Gs(this);case void 0:return Ys(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const r=this.sum(t);switch(t){case"row":{for(let e=0;e<this.rows;e++)r[e]/=this.columns;return r}case"column":{for(let e=0;e<this.columns;e++)r[e]/=this.rows;return r}case void 0:return r/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,r={}){if(typeof t=="object"&&(r=t,t=void 0),typeof r!="object")throw new TypeError("options must be an object");const{unbiased:e=!0,mean:s=this.mean(t)}=r;if(typeof e!="boolean")throw new TypeError("unbiased must be a boolean");switch(t){case"row":{if(!Z.isAnyArray(s))throw new TypeError("mean must be an array");return _s(this,e,s)}case"column":{if(!Z.isAnyArray(s))throw new TypeError("mean must be an array");return Ws(this,e,s)}case void 0:{if(typeof s!="number")throw new TypeError("mean must be a number");return Xs(this,e,s)}default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,r){typeof t=="object"&&(r=t,t=void 0);const e=this.variance(t,r);if(t===void 0)return Math.sqrt(e);for(let s=0;s<e.length;s++)e[s]=Math.sqrt(e[s]);return e}center(t,r={}){if(typeof t=="object"&&(r=t,t=void 0),typeof r!="object")throw new TypeError("options must be an object");const{center:e=this.mean(t)}=r;switch(t){case"row":{if(!Z.isAnyArray(e))throw new TypeError("center must be an array");return Qs(this,e),this}case"column":{if(!Z.isAnyArray(e))throw new TypeError("center must be an array");return Ks(this,e),this}case void 0:{if(typeof e!="number")throw new TypeError("center must be a number");return Js(this,e),this}default:throw new Error(`invalid option: ${t}`)}}scale(t,r={}){if(typeof t=="object"&&(r=t,t=void 0),typeof r!="object")throw new TypeError("options must be an object");let e=r.scale;switch(t){case"row":{if(e===void 0)e=Zs(this);else if(!Z.isAnyArray(e))throw new TypeError("scale must be an array");return Hs(this,e),this}case"column":{if(e===void 0)e=to(this);else if(!Z.isAnyArray(e))throw new TypeError("scale must be an array");return eo(this,e),this}case void 0:{if(e===void 0)e=ro(this);else if(typeof e!="number")throw new TypeError("scale must be a number");return no(this,e),this}default:throw new Error(`invalid option: ${t}`)}}toString(t){return Nr(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)yield[t,r,this.get(t,r)]}*values(){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)yield this.get(t,r)}}D.prototype.klass="Matrix",typeof Symbol<"u"&&(D.prototype[Symbol.for("nodejs.util.inspect.custom")]=Ps);function Tr(n,t){return n-t}function so(n){return n.every(t=>typeof t=="number")}D.random=D.rand,D.randomInt=D.randInt,D.diagonal=D.diag,D.prototype.diagonal=D.prototype.diag,D.identity=D.eye,D.prototype.negate=D.prototype.neg,D.prototype.tensorProduct=D.prototype.kroneckerProduct;let k=(At=class extends D{constructor(r,e){super();rr(this,Yt);V(this,"data");if(At.isMatrix(r))nr(this,Yt,sr).call(this,r.rows,r.columns),At.copy(r,this);else if(Number.isInteger(r)&&r>=0)nr(this,Yt,sr).call(this,r,e);else if(Z.isAnyArray(r)){const s=r;if(r=s.length,e=r?s[0].length:0,typeof e!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let o=0;o<r;o++){if(s[o].length!==e)throw new RangeError("Inconsistent array dimensions");if(!so(s[o]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(s[o]))}this.rows=r,this.columns=e}else throw new TypeError("First argument must be a positive number or an array")}set(r,e,s){return this.data[r][e]=s,this}get(r,e){return this.data[r][e]}removeRow(r){return rt(this,r),this.data.splice(r,1),this.rows-=1,this}addRow(r,e){return e===void 0&&(e=r,r=this.rows),rt(this,r,!0),e=Float64Array.from(It(this,e)),this.data.splice(r,0,e),this.rows+=1,this}removeColumn(r){nt(this,r);for(let e=0;e<this.rows;e++){const s=new Float64Array(this.columns-1);for(let o=0;o<r;o++)s[o]=this.data[e][o];for(let o=r+1;o<this.columns;o++)s[o-1]=this.data[e][o];this.data[e]=s}return this.columns-=1,this}addColumn(r,e){typeof e>"u"&&(e=r,r=this.columns),nt(this,r,!0),e=Tt(this,e);for(let s=0;s<this.rows;s++){const o=new Float64Array(this.columns+1);let i=0;for(;i<r;i++)o[i]=this.data[s][i];for(o[i++]=e[s];i<this.columns+1;i++)o[i]=this.data[s][i-1];this.data[s]=o}return this.columns+=1,this}},Yt=new WeakSet,sr=function(r,e){if(this.data=[],Number.isInteger(e)&&e>=0)for(let s=0;s<r;s++)this.data.push(new Float64Array(e));else throw new TypeError("nColumns must be a positive integer");this.rows=r,this.columns=e},At);qs(D,k);const Se=class Se extends D{constructor(r){super();rr(this,J,void 0);if(k.isMatrix(r)){if(!r.isSymmetric())throw new TypeError("not symmetric data");Ee(this,J,k.copy(r,new k(r.rows,r.rows)))}else if(Number.isInteger(r)&&r>=0)Ee(this,J,new k(r,r));else if(Ee(this,J,new k(r)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return ot(this,J).size}get rows(){return ot(this,J).rows}get columns(){return ot(this,J).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(r){return k.isMatrix(r)&&r.klassType==="SymmetricMatrix"}static zeros(r){return new this(r)}static ones(r){return new this(r).fill(1)}clone(){const r=new Se(this.diagonalSize);for(const[e,s,o]of this.upperRightEntries())r.set(e,s,o);return r}toMatrix(){return new k(this)}get(r,e){return ot(this,J).get(r,e)}set(r,e,s){return ot(this,J).set(r,e,s),ot(this,J).set(e,r,s),this}removeCross(r){return ot(this,J).removeRow(r),ot(this,J).removeColumn(r),this}addCross(r,e){e===void 0&&(e=r,r=this.diagonalSize);const s=e.slice();return s.splice(r,1),ot(this,J).addRow(r,s),ot(this,J).addColumn(r,e),this}applyMask(r){if(r.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[s,o]of r.entries())o||e.push(s);e.reverse();for(const s of e)this.removeCross(s);return this}toCompact(){const{diagonalSize:r}=this,e=new Array(r*(r+1)/2);for(let s=0,o=0,i=0;i<e.length;i++)e[i]=this.get(o,s),++s>=r&&(s=++o);return e}static fromCompact(r){const e=r.length,s=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(s))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(r)}`);const o=new Se(s);for(let i=0,l=0,a=0;a<e;a++)o.set(i,l,r[a]),++i>=s&&(i=++l);return o}*upperRightEntries(){for(let r=0,e=0;r<this.diagonalSize;void 0){const s=this.get(r,e);yield[r,e,s],++e>=this.diagonalSize&&(e=++r)}}*upperRightValues(){for(let r=0,e=0;r<this.diagonalSize;void 0)yield this.get(r,e),++e>=this.diagonalSize&&(e=++r)}};J=new WeakMap;let yt=Se;yt.prototype.klassType="SymmetricMatrix";class ne extends yt{static isDistanceMatrix(t){return yt.isSymmetricMatrix(t)&&t.klassSubType==="DistanceMatrix"}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,r,e){return t===r&&(e=0),super.set(t,r,e)}addCross(t,r){return r===void 0&&(r=t,t=this.diagonalSize),r=r.slice(),r[t]=0,super.addCross(t,r)}toSymmetricMatrix(){return new yt(this)}clone(){const t=new ne(this.diagonalSize);for(const[r,e,s]of this.upperRightEntries())r!==e&&t.set(r,e,s);return t}toCompact(){const{diagonalSize:t}=this,r=(t-1)*t/2,e=new Array(r);for(let s=1,o=0,i=0;i<e.length;i++)e[i]=this.get(o,s),++s>=t&&(s=++o+1);return e}static fromCompact(t){const r=t.length,e=(Math.sqrt(8*r+1)+1)/2;if(!Number.isInteger(e))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const s=new this(e);for(let o=1,i=0,l=0;l<r;l++)s.set(o,i,t[l]),++o>=e&&(o=++i+1);return s}}ne.prototype.klassSubType="DistanceMatrix";class ut extends D{constructor(t,r,e){super(),this.matrix=t,this.rows=r,this.columns=e}}class oo extends ut{constructor(t,r){nt(t,r),super(t,t.rows,1),this.column=r}set(t,r,e){return this.matrix.set(t,this.column,e),this}get(t){return this.matrix.get(t,this.column)}}class io extends ut{constructor(t,r){$e(t,r),super(t,t.rows,r.length),this.columnIndices=r}set(t,r,e){return this.matrix.set(t,this.columnIndices[r],e),this}get(t,r){return this.matrix.get(t,this.columnIndices[r])}}class lo extends ut{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(t,this.columns-r-1,e),this}get(t,r){return this.matrix.get(t,this.columns-r-1)}}class ao extends ut{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(this.rows-t-1,r,e),this}get(t,r){return this.matrix.get(this.rows-t-1,r)}}class uo extends ut{constructor(t,r){rt(t,r),super(t,1,t.columns),this.row=r}set(t,r,e){return this.matrix.set(this.row,r,e),this}get(t,r){return this.matrix.get(this.row,r)}}class ho extends ut{constructor(t,r){Ve(t,r),super(t,r.length,t.columns),this.rowIndices=r}set(t,r,e){return this.matrix.set(this.rowIndices[t],r,e),this}get(t,r){return this.matrix.get(this.rowIndices[t],r)}}class se extends ut{constructor(t,r,e){Ve(t,r),$e(t,e),super(t,r.length,e.length),this.rowIndices=r,this.columnIndices=e}set(t,r,e){return this.matrix.set(this.rowIndices[t],this.columnIndices[r],e),this}get(t,r){return this.matrix.get(this.rowIndices[t],this.columnIndices[r])}}class fo extends ut{constructor(t,r,e,s,o){qe(t,r,e,s,o),super(t,e-r+1,o-s+1),this.startRow=r,this.startColumn=s}set(t,r,e){return this.matrix.set(this.startRow+t,this.startColumn+r,e),this}get(t,r){return this.matrix.get(this.startRow+t,this.startColumn+r)}}class co extends ut{constructor(t){super(t,t.columns,t.rows)}set(t,r,e){return this.matrix.set(r,t,e),this}get(t,r){return this.matrix.get(r,t)}}class jr extends D{constructor(t,r={}){const{rows:e=1}=r;if(t.length%e!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=e,this.columns=t.length/e,this.data=t}set(t,r,e){let s=this._calculateIndex(t,r);return this.data[s]=e,this}get(t,r){let e=this._calculateIndex(t,r);return this.data[e]}_calculateIndex(t,r){return t*this.columns+r}}class H extends D{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,r,e){return this.data[t][r]=e,this}get(t,r){return this.data[t][r]}}function go(n,t){if(Z.isAnyArray(n))return n[0]&&Z.isAnyArray(n[0])?new H(n):new jr(n,t);throw new Error("the argument is not an array")}class oe{constructor(t){t=H.checkMatrix(t);let r=t.clone(),e=r.rows,s=r.columns,o=new Float64Array(e),i=1,l,a,u,f,h,c,d,g,w;for(l=0;l<e;l++)o[l]=l;for(g=new Float64Array(e),a=0;a<s;a++){for(l=0;l<e;l++)g[l]=r.get(l,a);for(l=0;l<e;l++){for(w=Math.min(l,a),h=0,u=0;u<w;u++)h+=r.get(l,u)*g[u];g[l]-=h,r.set(l,a,g[l])}for(f=a,l=a+1;l<e;l++)Math.abs(g[l])>Math.abs(g[f])&&(f=l);if(f!==a){for(u=0;u<s;u++)c=r.get(f,u),r.set(f,u,r.get(a,u)),r.set(a,u,c);d=o[f],o[f]=o[a],o[a]=d,i=-i}if(a<e&&r.get(a,a)!==0)for(l=a+1;l<e;l++)r.set(l,a,r.get(l,a)/r.get(a,a))}this.LU=r,this.pivotVector=o,this.pivotSign=i}isSingular(){let t=this.LU,r=t.columns;for(let e=0;e<r;e++)if(t.get(e,e)===0)return!0;return!1}solve(t){t=k.checkMatrix(t);let r=this.LU;if(r.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let s=t.columns,o=t.subMatrixRow(this.pivotVector,0,s-1),i=r.columns,l,a,u;for(u=0;u<i;u++)for(l=u+1;l<i;l++)for(a=0;a<s;a++)o.set(l,a,o.get(l,a)-o.get(u,a)*r.get(l,u));for(u=i-1;u>=0;u--){for(a=0;a<s;a++)o.set(u,a,o.get(u,a)/r.get(u,u));for(l=0;l<u;l++)for(a=0;a<s;a++)o.set(l,a,o.get(l,a)-o.get(u,a)*r.get(l,u))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let r=this.pivotSign,e=t.columns;for(let s=0;s<e;s++)r*=t.get(s,s);return r}get lowerTriangularMatrix(){let t=this.LU,r=t.rows,e=t.columns,s=new k(r,e);for(let o=0;o<r;o++)for(let i=0;i<e;i++)o>i?s.set(o,i,t.get(o,i)):o===i?s.set(o,i,1):s.set(o,i,0);return s}get upperTriangularMatrix(){let t=this.LU,r=t.rows,e=t.columns,s=new k(r,e);for(let o=0;o<r;o++)for(let i=0;i<e;i++)o<=i?s.set(o,i,t.get(o,i)):s.set(o,i,0);return s}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function ht(n,t){let r=0;return Math.abs(n)>Math.abs(t)?(r=t/n,Math.abs(n)*Math.sqrt(1+r*r)):t!==0?(r=n/t,Math.abs(t)*Math.sqrt(1+r*r)):0}class Oe{constructor(t){t=H.checkMatrix(t);let r=t.clone(),e=t.rows,s=t.columns,o=new Float64Array(s),i,l,a,u;for(a=0;a<s;a++){let f=0;for(i=a;i<e;i++)f=ht(f,r.get(i,a));if(f!==0){for(r.get(a,a)<0&&(f=-f),i=a;i<e;i++)r.set(i,a,r.get(i,a)/f);for(r.set(a,a,r.get(a,a)+1),l=a+1;l<s;l++){for(u=0,i=a;i<e;i++)u+=r.get(i,a)*r.get(i,l);for(u=-u/r.get(a,a),i=a;i<e;i++)r.set(i,l,r.get(i,l)+u*r.get(i,a))}}o[a]=-f}this.QR=r,this.Rdiag=o}solve(t){t=k.checkMatrix(t);let r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let s=t.columns,o=t.clone(),i=r.columns,l,a,u,f;for(u=0;u<i;u++)for(a=0;a<s;a++){for(f=0,l=u;l<e;l++)f+=r.get(l,u)*o.get(l,a);for(f=-f/r.get(u,u),l=u;l<e;l++)o.set(l,a,o.get(l,a)+f*r.get(l,u))}for(u=i-1;u>=0;u--){for(a=0;a<s;a++)o.set(u,a,o.get(u,a)/this.Rdiag[u]);for(l=0;l<u;l++)for(a=0;a<s;a++)o.set(l,a,o.get(l,a)-o.get(u,a)*r.get(l,u))}return o.subMatrix(0,i-1,0,s-1)}isFullRank(){let t=this.QR.columns;for(let r=0;r<t;r++)if(this.Rdiag[r]===0)return!1;return!0}get upperTriangularMatrix(){let t=this.QR,r=t.columns,e=new k(r,r),s,o;for(s=0;s<r;s++)for(o=0;o<r;o++)s<o?e.set(s,o,t.get(s,o)):s===o?e.set(s,o,this.Rdiag[s]):e.set(s,o,0);return e}get orthogonalMatrix(){let t=this.QR,r=t.rows,e=t.columns,s=new k(r,e),o,i,l,a;for(l=e-1;l>=0;l--){for(o=0;o<r;o++)s.set(o,l,0);for(s.set(l,l,1),i=l;i<e;i++)if(t.get(l,l)!==0){for(a=0,o=l;o<r;o++)a+=t.get(o,l)*s.get(o,i);for(a=-a/t.get(l,l),o=l;o<r;o++)s.set(o,i,s.get(o,i)+a*t.get(o,l))}}return s}}class kt{constructor(t,r={}){if(t=H.checkMatrix(t),t.isEmpty())throw new Error("Matrix must be non-empty");let e=t.rows,s=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:l=!1}=r;let a=!!o,u=!!i,f=!1,h;if(e<s)if(!l)h=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{h=t.transpose(),e=h.rows,s=h.columns,f=!0;let p=a;a=u,u=p}else h=t.clone();let c=Math.min(e,s),d=Math.min(e+1,s),g=new Float64Array(d),w=new k(e,c),N=new k(s,s),m=new Float64Array(s),y=new Float64Array(e),M=new Float64Array(d);for(let p=0;p<d;p++)M[p]=p;let v=Math.min(e-1,s),E=Math.max(0,Math.min(s-2,e)),j=Math.max(v,E);for(let p=0;p<j;p++){if(p<v){g[p]=0;for(let b=p;b<e;b++)g[p]=ht(g[p],h.get(b,p));if(g[p]!==0){h.get(p,p)<0&&(g[p]=-g[p]);for(let b=p;b<e;b++)h.set(b,p,h.get(b,p)/g[p]);h.set(p,p,h.get(p,p)+1)}g[p]=-g[p]}for(let b=p+1;b<s;b++){if(p<v&&g[p]!==0){let I=0;for(let x=p;x<e;x++)I+=h.get(x,p)*h.get(x,b);I=-I/h.get(p,p);for(let x=p;x<e;x++)h.set(x,b,h.get(x,b)+I*h.get(x,p))}m[b]=h.get(p,b)}if(a&&p<v)for(let b=p;b<e;b++)w.set(b,p,h.get(b,p));if(p<E){m[p]=0;for(let b=p+1;b<s;b++)m[p]=ht(m[p],m[b]);if(m[p]!==0){m[p+1]<0&&(m[p]=0-m[p]);for(let b=p+1;b<s;b++)m[b]/=m[p];m[p+1]+=1}if(m[p]=-m[p],p+1<e&&m[p]!==0){for(let b=p+1;b<e;b++)y[b]=0;for(let b=p+1;b<e;b++)for(let I=p+1;I<s;I++)y[b]+=m[I]*h.get(b,I);for(let b=p+1;b<s;b++){let I=-m[b]/m[p+1];for(let x=p+1;x<e;x++)h.set(x,b,h.get(x,b)+I*y[x])}}if(u)for(let b=p+1;b<s;b++)N.set(b,p,m[b])}}let S=Math.min(s,e+1);if(v<s&&(g[v]=h.get(v,v)),e<S&&(g[S-1]=0),E+1<S&&(m[E]=h.get(E,S-1)),m[S-1]=0,a){for(let p=v;p<c;p++){for(let b=0;b<e;b++)w.set(b,p,0);w.set(p,p,1)}for(let p=v-1;p>=0;p--)if(g[p]!==0){for(let b=p+1;b<c;b++){let I=0;for(let x=p;x<e;x++)I+=w.get(x,p)*w.get(x,b);I=-I/w.get(p,p);for(let x=p;x<e;x++)w.set(x,b,w.get(x,b)+I*w.get(x,p))}for(let b=p;b<e;b++)w.set(b,p,-w.get(b,p));w.set(p,p,1+w.get(p,p));for(let b=0;b<p-1;b++)w.set(b,p,0)}else{for(let b=0;b<e;b++)w.set(b,p,0);w.set(p,p,1)}}if(u)for(let p=s-1;p>=0;p--){if(p<E&&m[p]!==0)for(let b=p+1;b<s;b++){let I=0;for(let x=p+1;x<s;x++)I+=N.get(x,p)*N.get(x,b);I=-I/N.get(p+1,p);for(let x=p+1;x<s;x++)N.set(x,b,N.get(x,b)+I*N.get(x,p))}for(let b=0;b<s;b++)N.set(b,p,0);N.set(p,p,1)}let T=S-1,F=Number.EPSILON;for(;S>0;){let p,b;for(p=S-2;p>=-1&&p!==-1;p--){const I=Number.MIN_VALUE+F*Math.abs(g[p]+Math.abs(g[p+1]));if(Math.abs(m[p])<=I||Number.isNaN(m[p])){m[p]=0;break}}if(p===S-2)b=4;else{let I;for(I=S-1;I>=p&&I!==p;I--){let x=(I!==S?Math.abs(m[I]):0)+(I!==p+1?Math.abs(m[I-1]):0);if(Math.abs(g[I])<=F*x){g[I]=0;break}}I===p?b=3:I===S-1?b=1:(b=2,p=I)}switch(p++,b){case 1:{let I=m[S-2];m[S-2]=0;for(let x=S-2;x>=p;x--){let z=ht(g[x],I),A=g[x]/z,C=I/z;if(g[x]=z,x!==p&&(I=-C*m[x-1],m[x-1]=A*m[x-1]),u)for(let q=0;q<s;q++)z=A*N.get(q,x)+C*N.get(q,S-1),N.set(q,S-1,-C*N.get(q,x)+A*N.get(q,S-1)),N.set(q,x,z)}break}case 2:{let I=m[p-1];m[p-1]=0;for(let x=p;x<S;x++){let z=ht(g[x],I),A=g[x]/z,C=I/z;if(g[x]=z,I=-C*m[x],m[x]=A*m[x],a)for(let q=0;q<e;q++)z=A*w.get(q,x)+C*w.get(q,p-1),w.set(q,p-1,-C*w.get(q,x)+A*w.get(q,p-1)),w.set(q,x,z)}break}case 3:{const I=Math.max(Math.abs(g[S-1]),Math.abs(g[S-2]),Math.abs(m[S-2]),Math.abs(g[p]),Math.abs(m[p])),x=g[S-1]/I,z=g[S-2]/I,A=m[S-2]/I,C=g[p]/I,q=m[p]/I,G=((z+x)*(z-x)+A*A)/2,Y=x*A*(x*A);let W=0;(G!==0||Y!==0)&&(G<0?W=0-Math.sqrt(G*G+Y):W=Math.sqrt(G*G+Y),W=Y/(G+W));let at=(C+x)*(C-x)+W,ct=C*q;for(let P=p;P<S-1;P++){let Q=ht(at,ct);Q===0&&(Q=Number.MIN_VALUE);let tt=at/Q,et=ct/Q;if(P!==p&&(m[P-1]=Q),at=tt*g[P]+et*m[P],m[P]=tt*m[P]-et*g[P],ct=et*g[P+1],g[P+1]=tt*g[P+1],u)for(let X=0;X<s;X++)Q=tt*N.get(X,P)+et*N.get(X,P+1),N.set(X,P+1,-et*N.get(X,P)+tt*N.get(X,P+1)),N.set(X,P,Q);if(Q=ht(at,ct),Q===0&&(Q=Number.MIN_VALUE),tt=at/Q,et=ct/Q,g[P]=Q,at=tt*m[P]+et*g[P+1],g[P+1]=-et*m[P]+tt*g[P+1],ct=et*m[P+1],m[P+1]=tt*m[P+1],a&&P<e-1)for(let X=0;X<e;X++)Q=tt*w.get(X,P)+et*w.get(X,P+1),w.set(X,P+1,-et*w.get(X,P)+tt*w.get(X,P+1)),w.set(X,P,Q)}m[S-2]=at;break}case 4:{if(g[p]<=0&&(g[p]=g[p]<0?-g[p]:0,u))for(let I=0;I<=T;I++)N.set(I,p,-N.get(I,p));for(;p<T&&!(g[p]>=g[p+1]);){let I=g[p];if(g[p]=g[p+1],g[p+1]=I,u&&p<s-1)for(let x=0;x<s;x++)I=N.get(x,p+1),N.set(x,p+1,N.get(x,p)),N.set(x,p,I);if(a&&p<e-1)for(let x=0;x<e;x++)I=w.get(x,p+1),w.set(x,p+1,w.get(x,p)),w.set(x,p,I);p++}S--;break}}}if(f){let p=N;N=w,w=p}this.m=e,this.n=s,this.s=g,this.U=w,this.V=N}solve(t){let r=t,e=this.threshold,s=this.s.length,o=k.zeros(s,s);for(let c=0;c<s;c++)Math.abs(this.s[c])<=e?o.set(c,c,0):o.set(c,c,1/this.s[c]);let i=this.U,l=this.rightSingularVectors,a=l.mmul(o),u=l.rows,f=i.rows,h=k.zeros(u,f);for(let c=0;c<u;c++)for(let d=0;d<f;d++){let g=0;for(let w=0;w<s;w++)g+=a.get(c,w)*i.get(d,w);h.set(c,d,g)}return h.mmul(r)}solveForDiagonal(t){return this.solve(k.diag(t))}inverse(){let t=this.V,r=this.threshold,e=t.rows,s=t.columns,o=new k(e,this.s.length);for(let f=0;f<e;f++)for(let h=0;h<s;h++)Math.abs(this.s[h])>r&&o.set(f,h,t.get(f,h)/this.s[h]);let i=this.U,l=i.rows,a=i.columns,u=new k(e,l);for(let f=0;f<e;f++)for(let h=0;h<l;h++){let c=0;for(let d=0;d<a;d++)c+=o.get(f,d)*i.get(h,d);u.set(f,h,c)}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,e=this.s;for(let s=0,o=e.length;s<o;s++)e[s]>t&&r++;return r}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return k.diag(this.s)}}function mo(n,t=!1){return n=H.checkMatrix(n),t?new kt(n).inverse():kr(n,k.eye(n.rows))}function kr(n,t,r=!1){return n=H.checkMatrix(n),t=H.checkMatrix(t),r?new kt(n).solve(t):n.isSquare()?new oe(n).solve(t):new Oe(n).solve(t)}function ie(n){if(n=k.checkMatrix(n),n.isSquare()){if(n.columns===0)return 1;let t,r,e,s;if(n.columns===2)return t=n.get(0,0),r=n.get(0,1),e=n.get(1,0),s=n.get(1,1),t*s-r*e;if(n.columns===3){let o,i,l;return o=new se(n,[1,2],[1,2]),i=new se(n,[1,2],[0,2]),l=new se(n,[1,2],[0,1]),t=n.get(0,0),r=n.get(0,1),e=n.get(0,2),t*ie(o)-r*ie(i)+e*ie(l)}else return new oe(n).determinant}else throw Error("determinant can only be calculated for a square matrix")}function po(n,t){let r=[];for(let e=0;e<n;e++)e!==t&&r.push(e);return r}function wo(n,t,r,e=1e-9,s=1e-9){if(n>s)return new Array(t.rows+1).fill(0);{let o=t.addRow(r,[0]);for(let i=0;i<o.rows;i++)Math.abs(o.get(i,0))<e&&o.set(i,0,0);return o.to1DArray()}}function yo(n,t={}){const{thresholdValue:r=1e-9,thresholdError:e=1e-9}=t;n=k.checkMatrix(n);let s=n.rows,o=new k(s,s);for(let i=0;i<s;i++){let l=k.columnVector(n.getRow(i)),a=n.subMatrixRow(po(s,i)).transpose(),f=new kt(a).solve(l),h=k.sub(l,a.mmul(f)).abs().max();o.setRow(i,wo(h,f,i,r,e))}return o}function bo(n,t=Number.EPSILON){if(n=k.checkMatrix(n),n.isEmpty())return n.transpose();let r=new kt(n,{autoTranspose:!0}),e=r.leftSingularVectors,s=r.rightSingularVectors,o=r.diagonal;for(let i=0;i<o.length;i++)Math.abs(o[i])>t?o[i]=1/o[i]:o[i]=0;return s.mmul(k.diag(o).mmul(e.transpose()))}function Mo(n,t=n,r={}){n=new k(n);let e=!1;if(typeof t=="object"&&!k.isMatrix(t)&&!Z.isAnyArray(t)?(r=t,t=n,e=!0):t=new k(t),n.rows!==t.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0}=r;s&&(n=n.center("column"),e||(t=t.center("column")));const o=n.transpose().mmul(t);for(let i=0;i<o.rows;i++)for(let l=0;l<o.columns;l++)o.set(i,l,o.get(i,l)*(1/(n.rows-1)));return o}function vo(n,t=n,r={}){n=new k(n);let e=!1;if(typeof t=="object"&&!k.isMatrix(t)&&!Z.isAnyArray(t)?(r=t,t=n,e=!0):t=new k(t),n.rows!==t.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0,scale:o=!0}=r;s&&(n.center("column"),e||t.center("column")),o&&(n.scale("column"),e||t.scale("column"));const i=n.standardDeviation("column",{unbiased:!0}),l=e?i:t.standardDeviation("column",{unbiased:!0}),a=n.transpose().mmul(t);for(let u=0;u<a.rows;u++)for(let f=0;f<a.columns;f++)a.set(u,f,a.get(u,f)*(1/(i[u]*l[f]))*(1/(n.rows-1)));return a}class zr{constructor(t,r={}){const{assumeSymmetric:e=!1}=r;if(t=H.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let s=t.columns,o=new k(s,s),i=new Float64Array(s),l=new Float64Array(s),a=t,u,f,h=!1;if(e?h=!0:h=t.isSymmetric(),h){for(u=0;u<s;u++)for(f=0;f<s;f++)o.set(u,f,a.get(u,f));xo(s,l,i,o),So(s,l,i,o)}else{let c=new k(s,s),d=new Float64Array(s);for(f=0;f<s;f++)for(u=0;u<s;u++)c.set(u,f,a.get(u,f));Eo(s,c,d,o),No(s,l,i,o,c)}this.n=s,this.e=l,this.d=i,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t=this.n,r=this.e,e=this.d,s=new k(t,t),o,i;for(o=0;o<t;o++){for(i=0;i<t;i++)s.set(o,i,0);s.set(o,o,e[o]),r[o]>0?s.set(o,o+1,r[o]):r[o]<0&&s.set(o,o-1,r[o])}return s}}function xo(n,t,r,e){let s,o,i,l,a,u,f,h;for(a=0;a<n;a++)r[a]=e.get(n-1,a);for(l=n-1;l>0;l--){for(h=0,i=0,u=0;u<l;u++)h=h+Math.abs(r[u]);if(h===0)for(t[l]=r[l-1],a=0;a<l;a++)r[a]=e.get(l-1,a),e.set(l,a,0),e.set(a,l,0);else{for(u=0;u<l;u++)r[u]/=h,i+=r[u]*r[u];for(s=r[l-1],o=Math.sqrt(i),s>0&&(o=-o),t[l]=h*o,i=i-s*o,r[l-1]=s-o,a=0;a<l;a++)t[a]=0;for(a=0;a<l;a++){for(s=r[a],e.set(a,l,s),o=t[a]+e.get(a,a)*s,u=a+1;u<=l-1;u++)o+=e.get(u,a)*r[u],t[u]+=e.get(u,a)*s;t[a]=o}for(s=0,a=0;a<l;a++)t[a]/=i,s+=t[a]*r[a];for(f=s/(i+i),a=0;a<l;a++)t[a]-=f*r[a];for(a=0;a<l;a++){for(s=r[a],o=t[a],u=a;u<=l-1;u++)e.set(u,a,e.get(u,a)-(s*t[u]+o*r[u]));r[a]=e.get(l-1,a),e.set(l,a,0)}}r[l]=i}for(l=0;l<n-1;l++){if(e.set(n-1,l,e.get(l,l)),e.set(l,l,1),i=r[l+1],i!==0){for(u=0;u<=l;u++)r[u]=e.get(u,l+1)/i;for(a=0;a<=l;a++){for(o=0,u=0;u<=l;u++)o+=e.get(u,l+1)*e.get(u,a);for(u=0;u<=l;u++)e.set(u,a,e.get(u,a)-o*r[u])}}for(u=0;u<=l;u++)e.set(u,l+1,0)}for(a=0;a<n;a++)r[a]=e.get(n-1,a),e.set(n-1,a,0);e.set(n-1,n-1,1),t[0]=0}function So(n,t,r,e){let s,o,i,l,a,u,f,h,c,d,g,w,N,m,y,M;for(i=1;i<n;i++)t[i-1]=t[i];t[n-1]=0;let v=0,E=0,j=Number.EPSILON;for(u=0;u<n;u++){for(E=Math.max(E,Math.abs(r[u])+Math.abs(t[u])),f=u;f<n&&!(Math.abs(t[f])<=j*E);)f++;if(f>u)do{for(s=r[u],h=(r[u+1]-s)/(2*t[u]),c=ht(h,1),h<0&&(c=-c),r[u]=t[u]/(h+c),r[u+1]=t[u]*(h+c),d=r[u+1],o=s-r[u],i=u+2;i<n;i++)r[i]-=o;for(v=v+o,h=r[f],g=1,w=g,N=g,m=t[u+1],y=0,M=0,i=f-1;i>=u;i--)for(N=w,w=g,M=y,s=g*t[i],o=g*h,c=ht(h,t[i]),t[i+1]=y*c,y=t[i]/c,g=h/c,h=g*r[i]-y*s,r[i+1]=o+y*(g*s+y*r[i]),a=0;a<n;a++)o=e.get(a,i+1),e.set(a,i+1,y*e.get(a,i)+g*o),e.set(a,i,g*e.get(a,i)-y*o);h=-y*M*N*m*t[u]/d,t[u]=y*h,r[u]=g*h}while(Math.abs(t[u])>j*E);r[u]=r[u]+v,t[u]=0}for(i=0;i<n-1;i++){for(a=i,h=r[i],l=i+1;l<n;l++)r[l]<h&&(a=l,h=r[l]);if(a!==i)for(r[a]=r[i],r[i]=h,l=0;l<n;l++)h=e.get(l,i),e.set(l,i,e.get(l,a)),e.set(l,a,h)}}function Eo(n,t,r,e){let s=0,o=n-1,i,l,a,u,f,h,c;for(h=s+1;h<=o-1;h++){for(c=0,u=h;u<=o;u++)c=c+Math.abs(t.get(u,h-1));if(c!==0){for(a=0,u=o;u>=h;u--)r[u]=t.get(u,h-1)/c,a+=r[u]*r[u];for(l=Math.sqrt(a),r[h]>0&&(l=-l),a=a-r[h]*l,r[h]=r[h]-l,f=h;f<n;f++){for(i=0,u=o;u>=h;u--)i+=r[u]*t.get(u,f);for(i=i/a,u=h;u<=o;u++)t.set(u,f,t.get(u,f)-i*r[u])}for(u=0;u<=o;u++){for(i=0,f=o;f>=h;f--)i+=r[f]*t.get(u,f);for(i=i/a,f=h;f<=o;f++)t.set(u,f,t.get(u,f)-i*r[f])}r[h]=c*r[h],t.set(h,h-1,c*l)}}for(u=0;u<n;u++)for(f=0;f<n;f++)e.set(u,f,u===f?1:0);for(h=o-1;h>=s+1;h--)if(t.get(h,h-1)!==0){for(u=h+1;u<=o;u++)r[u]=t.get(u,h-1);for(f=h;f<=o;f++){for(l=0,u=h;u<=o;u++)l+=r[u]*e.get(u,f);for(l=l/r[h]/t.get(h,h-1),u=h;u<=o;u++)e.set(u,f,e.get(u,f)+l*r[u])}}}function No(n,t,r,e,s){let o=n-1,i=0,l=n-1,a=Number.EPSILON,u=0,f=0,h=0,c=0,d=0,g=0,w=0,N=0,m,y,M,v,E,j,S,T,F,p,b,I,x,z,A;for(m=0;m<n;m++)for((m<i||m>l)&&(r[m]=s.get(m,m),t[m]=0),y=Math.max(m-1,0);y<n;y++)f=f+Math.abs(s.get(m,y));for(;o>=i;){for(v=o;v>i&&(g=Math.abs(s.get(v-1,v-1))+Math.abs(s.get(v,v)),g===0&&(g=f),!(Math.abs(s.get(v,v-1))<a*g));)v--;if(v===o)s.set(o,o,s.get(o,o)+u),r[o]=s.get(o,o),t[o]=0,o--,N=0;else if(v===o-1){if(S=s.get(o,o-1)*s.get(o-1,o),h=(s.get(o-1,o-1)-s.get(o,o))/2,c=h*h+S,w=Math.sqrt(Math.abs(c)),s.set(o,o,s.get(o,o)+u),s.set(o-1,o-1,s.get(o-1,o-1)+u),T=s.get(o,o),c>=0){for(w=h>=0?h+w:h-w,r[o-1]=T+w,r[o]=r[o-1],w!==0&&(r[o]=T-S/w),t[o-1]=0,t[o]=0,T=s.get(o,o-1),g=Math.abs(T)+Math.abs(w),h=T/g,c=w/g,d=Math.sqrt(h*h+c*c),h=h/d,c=c/d,y=o-1;y<n;y++)w=s.get(o-1,y),s.set(o-1,y,c*w+h*s.get(o,y)),s.set(o,y,c*s.get(o,y)-h*w);for(m=0;m<=o;m++)w=s.get(m,o-1),s.set(m,o-1,c*w+h*s.get(m,o)),s.set(m,o,c*s.get(m,o)-h*w);for(m=i;m<=l;m++)w=e.get(m,o-1),e.set(m,o-1,c*w+h*e.get(m,o)),e.set(m,o,c*e.get(m,o)-h*w)}else r[o-1]=T+h,r[o]=T+h,t[o-1]=w,t[o]=-w;o=o-2,N=0}else{if(T=s.get(o,o),F=0,S=0,v<o&&(F=s.get(o-1,o-1),S=s.get(o,o-1)*s.get(o-1,o)),N===10){for(u+=T,m=i;m<=o;m++)s.set(m,m,s.get(m,m)-T);g=Math.abs(s.get(o,o-1))+Math.abs(s.get(o-1,o-2)),T=F=.75*g,S=-.4375*g*g}if(N===30&&(g=(F-T)/2,g=g*g+S,g>0)){for(g=Math.sqrt(g),F<T&&(g=-g),g=T-S/((F-T)/2+g),m=i;m<=o;m++)s.set(m,m,s.get(m,m)-g);u+=g,T=F=S=.964}for(N=N+1,E=o-2;E>=v&&(w=s.get(E,E),d=T-w,g=F-w,h=(d*g-S)/s.get(E+1,E)+s.get(E,E+1),c=s.get(E+1,E+1)-w-d-g,d=s.get(E+2,E+1),g=Math.abs(h)+Math.abs(c)+Math.abs(d),h=h/g,c=c/g,d=d/g,!(E===v||Math.abs(s.get(E,E-1))*(Math.abs(c)+Math.abs(d))<a*(Math.abs(h)*(Math.abs(s.get(E-1,E-1))+Math.abs(w)+Math.abs(s.get(E+1,E+1))))));)E--;for(m=E+2;m<=o;m++)s.set(m,m-2,0),m>E+2&&s.set(m,m-3,0);for(M=E;M<=o-1&&(z=M!==o-1,M!==E&&(h=s.get(M,M-1),c=s.get(M+1,M-1),d=z?s.get(M+2,M-1):0,T=Math.abs(h)+Math.abs(c)+Math.abs(d),T!==0&&(h=h/T,c=c/T,d=d/T)),T!==0);M++)if(g=Math.sqrt(h*h+c*c+d*d),h<0&&(g=-g),g!==0){for(M!==E?s.set(M,M-1,-g*T):v!==E&&s.set(M,M-1,-s.get(M,M-1)),h=h+g,T=h/g,F=c/g,w=d/g,c=c/h,d=d/h,y=M;y<n;y++)h=s.get(M,y)+c*s.get(M+1,y),z&&(h=h+d*s.get(M+2,y),s.set(M+2,y,s.get(M+2,y)-h*w)),s.set(M,y,s.get(M,y)-h*T),s.set(M+1,y,s.get(M+1,y)-h*F);for(m=0;m<=Math.min(o,M+3);m++)h=T*s.get(m,M)+F*s.get(m,M+1),z&&(h=h+w*s.get(m,M+2),s.set(m,M+2,s.get(m,M+2)-h*d)),s.set(m,M,s.get(m,M)-h),s.set(m,M+1,s.get(m,M+1)-h*c);for(m=i;m<=l;m++)h=T*e.get(m,M)+F*e.get(m,M+1),z&&(h=h+w*e.get(m,M+2),e.set(m,M+2,e.get(m,M+2)-h*d)),e.set(m,M,e.get(m,M)-h),e.set(m,M+1,e.get(m,M+1)-h*c)}}}if(f!==0){for(o=n-1;o>=0;o--)if(h=r[o],c=t[o],c===0)for(v=o,s.set(o,o,1),m=o-1;m>=0;m--){for(S=s.get(m,m)-h,d=0,y=v;y<=o;y++)d=d+s.get(m,y)*s.get(y,o);if(t[m]<0)w=S,g=d;else if(v=m,t[m]===0?s.set(m,o,S!==0?-d/S:-d/(a*f)):(T=s.get(m,m+1),F=s.get(m+1,m),c=(r[m]-h)*(r[m]-h)+t[m]*t[m],j=(T*g-w*d)/c,s.set(m,o,j),s.set(m+1,o,Math.abs(T)>Math.abs(w)?(-d-S*j)/T:(-g-F*j)/w)),j=Math.abs(s.get(m,o)),a*j*j>1)for(y=m;y<=o;y++)s.set(y,o,s.get(y,o)/j)}else if(c<0)for(v=o-1,Math.abs(s.get(o,o-1))>Math.abs(s.get(o-1,o))?(s.set(o-1,o-1,c/s.get(o,o-1)),s.set(o-1,o,-(s.get(o,o)-h)/s.get(o,o-1))):(A=le(0,-s.get(o-1,o),s.get(o-1,o-1)-h,c),s.set(o-1,o-1,A[0]),s.set(o-1,o,A[1])),s.set(o,o-1,0),s.set(o,o,1),m=o-2;m>=0;m--){for(p=0,b=0,y=v;y<=o;y++)p=p+s.get(m,y)*s.get(y,o-1),b=b+s.get(m,y)*s.get(y,o);if(S=s.get(m,m)-h,t[m]<0)w=S,d=p,g=b;else if(v=m,t[m]===0?(A=le(-p,-b,S,c),s.set(m,o-1,A[0]),s.set(m,o,A[1])):(T=s.get(m,m+1),F=s.get(m+1,m),I=(r[m]-h)*(r[m]-h)+t[m]*t[m]-c*c,x=(r[m]-h)*2*c,I===0&&x===0&&(I=a*f*(Math.abs(S)+Math.abs(c)+Math.abs(T)+Math.abs(F)+Math.abs(w))),A=le(T*d-w*p+c*b,T*g-w*b-c*p,I,x),s.set(m,o-1,A[0]),s.set(m,o,A[1]),Math.abs(T)>Math.abs(w)+Math.abs(c)?(s.set(m+1,o-1,(-p-S*s.get(m,o-1)+c*s.get(m,o))/T),s.set(m+1,o,(-b-S*s.get(m,o)-c*s.get(m,o-1))/T)):(A=le(-d-F*s.get(m,o-1),-g-F*s.get(m,o),w,c),s.set(m+1,o-1,A[0]),s.set(m+1,o,A[1]))),j=Math.max(Math.abs(s.get(m,o-1)),Math.abs(s.get(m,o))),a*j*j>1)for(y=m;y<=o;y++)s.set(y,o-1,s.get(y,o-1)/j),s.set(y,o,s.get(y,o)/j)}for(m=0;m<n;m++)if(m<i||m>l)for(y=m;y<n;y++)e.set(m,y,s.get(m,y));for(y=n-1;y>=i;y--)for(m=i;m<=l;m++){for(w=0,M=i;M<=Math.min(y,l);M++)w=w+e.get(m,M)*s.get(M,y);e.set(m,y,w)}}}function le(n,t,r,e){let s,o;return Math.abs(r)>Math.abs(e)?(s=e/r,o=r+s*e,[(n+s*t)/o,(t-s*n)/o]):(s=r/e,o=e+s*r,[(s*n+t)/o,(s*t-n)/o])}class Fr{constructor(t){if(t=H.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");let r=t,e=r.rows,s=new k(e,e),o=!0,i,l,a;for(l=0;l<e;l++){let u=0;for(a=0;a<l;a++){let f=0;for(i=0;i<a;i++)f+=s.get(a,i)*s.get(l,i);f=(r.get(l,a)-f)/s.get(a,a),s.set(l,a,f),u=u+f*f}for(u=r.get(l,l)-u,o&=u>0,s.set(l,l,Math.sqrt(Math.max(u,0))),a=l+1;a<e;a++)s.set(l,a,0)}this.L=s,this.positiveDefinite=!!o}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=H.checkMatrix(t);let r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let s=t.columns,o=t.clone(),i,l,a;for(a=0;a<e;a++)for(l=0;l<s;l++){for(i=0;i<a;i++)o.set(a,l,o.get(a,l)-o.get(i,l)*r.get(a,i));o.set(a,l,o.get(a,l)/r.get(a,a))}for(a=e-1;a>=0;a--)for(l=0;l<s;l++){for(i=a+1;i<e;i++)o.set(a,l,o.get(a,l)-o.get(i,l)*r.get(i,a));o.set(a,l,o.get(a,l)/r.get(a,a))}return o}get lowerTriangularMatrix(){return this.L}}class Dr{constructor(t,r={}){t=H.checkMatrix(t);let{Y:e}=r;const{scaleScores:s=!1,maxIterations:o=1e3,terminationCriteria:i=1e-10}=r;let l;if(e){if(Z.isAnyArray(e)&&typeof e[0]=="number"?e=k.columnVector(e):e=H.checkMatrix(e),e.rows!==t.rows)throw new Error("Y should have the same number of rows as X");l=e.getColumnVector(0)}else l=t.getColumnVector(0);let a=1,u,f,h,c;for(let d=0;d<o&&a>i;d++)h=t.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),h=h.div(h.norm()),u=t.mmul(h).div(h.transpose().mmul(h).get(0,0)),d>0&&(a=u.clone().sub(c).pow(2).sum()),c=u.clone(),e?(f=e.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0)),f=f.div(f.norm()),l=e.mmul(f).div(f.transpose().mmul(f).get(0,0))):l=u;if(e){let d=t.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0));d=d.div(d.norm());let g=t.clone().sub(u.clone().mmul(d.transpose())),w=l.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0)),N=e.clone().sub(u.clone().mulS(w.get(0,0)).mmul(f.transpose()));this.t=u,this.p=d.transpose(),this.w=h.transpose(),this.q=f,this.u=l,this.s=u.transpose().mmul(u),this.xResidual=g,this.yResidual=N,this.betas=w}else this.w=h.transpose(),this.s=u.transpose().mmul(u).sqrt(),s?this.t=u.clone().div(this.s.get(0,0)):this.t=u,this.xResidual=t.sub(u.mmul(h.transpose()))}}R.AbstractMatrix=D,R.CHO=Fr,R.CholeskyDecomposition=Fr,R.DistanceMatrix=ne,R.EVD=zr,R.EigenvalueDecomposition=zr,R.LU=oe,R.LuDecomposition=oe;var Rr=R.Matrix=k;R.MatrixColumnSelectionView=io,R.MatrixColumnView=oo,R.MatrixFlipColumnView=lo,R.MatrixFlipRowView=ao,R.MatrixRowSelectionView=ho,R.MatrixRowView=uo,R.MatrixSelectionView=se,R.MatrixSubView=fo,R.MatrixTransposeView=co,R.NIPALS=Dr,R.Nipals=Dr,R.QR=Oe,R.QrDecomposition=Oe,R.SVD=kt,R.SingularValueDecomposition=kt,R.SymmetricMatrix=yt,R.WrapperMatrix1D=jr,R.WrapperMatrix2D=H,R.correlation=vo,R.covariance=Mo;var Ar=R.default=k;R.determinant=ie,R.inverse=mo,R.linearDependencies=yo;var Io=R.pseudoInverse=bo;R.solve=kr,R.wrap=go;const U=Rr;Ar.Matrix&&Ar.Matrix;const To=Io;function jo(n){let t=$r(n.getNestedArray(),1);t=t.map(s=>s[0]);let r=Math.max(...t),e=Math.min(...t);return t=t.map(s=>(s-e)/(r-e)),t}function ko(n,t="Classic"){const r=[13];let e=null,s=1,o;switch(t){case"Classic":o=$r(n.getNestedArray(),2);break;case"GDTries":r.push(.5,1,2,4,8);for(let i=0;i<r.length;i++){const l=r[i];o=Cr(new U(n.getNestedArray()),{lr:l}),o.lossPerStep[o.lossPerStep.length-1]<s&&(e=o,s=o.lossPerStep[o.lossPerStep.length-1])}o=e.coordinates.data;break;case"GD":for(let i=0;i<r.length;i++){const l=r[i];o=Cr(new U(n.getNestedArray()),{lr:l}),isNaN(o.lossPerStep[o.lossPerStep.length-1])?r.push(r[r.length-1]/2):o.lossPerStep[o.lossPerStep.length-1]<s&&(e=o,s=o.lossPerStep[o.lossPerStep.length-1])}o=e.coordinates.data;break;case"GN":o=zo(new U(n.getNestedArray())).coordinates.data;break}return Ao(o)}function Cr(n,{lr:t=7,maxSteps:r=500,minLossDifference:e=1e-9,momentum:s=0,logEvery:o=0}={}){const i=n.rows;let l=Pr(i);const a=[];let u=null;for(let f=0;f<r;f++){const h=Vr(n,l);if(a.push(h),a.length>1){const c=a[a.length-2];if(Math.abs(c-h)<e||isNaN(h)||h>10)return{coordinates:l,lossPerStep:a}}for(let c=0;c<i;c++){const d=Do(n,l,c);s===0||u==null?u=d:u=U.add(U.mul(u,s),d);const g=U.mul(u,t),w=U.sub(l.getRowVector(c),g);l.setRow(c,w)}}return{coordinates:l,lossPerStep:a}}function zo(n,{lr:t=.7,maxSteps:r=100,minLossDifference:e=1e-4,logEvery:s=5}={}){const o=n.rows;let i=Pr(o);const l=i.columns,a=[];for(let u=0;u<r;u++){const f=Vr(n,i);if(a.push(f),a.length>1){const g=a[a.length-2];if(Math.abs(g-f)<e)return{coordinates:i,lossPerStep:a}}const{residuals:h,jacobian:c}=Fo(n,i),d=To(c).mmul(h);for(let g=0;g<o;g++)for(let w=0;w<l;w++){const N=g*l+w,m=i.get(g,w),y=t*d.get(N,0),M=m-y;i.set(g,w,M)}}return{coordinates:i,lossPerStep:a}}function Pr(n,t=2,r=1){const e=U.rand(n,t,{random:new ws(r)});return U.div(e,Math.sqrt(t))}function Vr(n,t){let r=0;const e=Math.pow(t.rows,2);for(let s=0;s<t.rows;s++)for(let o=0;o<t.rows;o++){if(s===o)continue;const i=t.getRowVector(s),l=t.getRowVector(o),a=n.get(s,o),u=U.sub(i,l).norm();r+=Math.pow(a-u,2)/e}return r}function Fo(n,t){const r=[],e=t.rows,s=t.columns,o=U.zeros(e*e,e*s);for(let i=0;i<e;i++)for(let l=0;l<e;l++){if(i===l){r.push(0);continue}const a=t.getRowVector(i),u=t.getRowVector(l),f=U.sub(a,u).pow(2).sum(),h=Math.sqrt(f),d=(n.get(i,l)-h)/e;r.push(d);const g=-1/e,w=.5/Math.sqrt(f),N=U.mul(U.sub(a,u),2),m=U.mul(N,g*w),y=e*i+l;for(let M=0;M<s;M++){const v=s*i+M,j=o.get(y,v)+m.get(0,M);o.set(y,v,j)}}return{residuals:U.columnVector(r),jacobian:o}}function Do(n,t,r){const e=t.getRowVector(r),s=Math.pow(t.rows,2);let o=U.zeros(1,e.columns);for(let i=0;i<t.rows;i++){if(r===i)continue;const l=t.getRowVector(i),a=U.sub(e,l).pow(2).sum(),u=Math.sqrt(a),f=[n.get(r,i),n.get(i,r)];for(const h of f){const c=-2*(h-u)/s,d=.5/Math.sqrt(a),g=U.mul(U.sub(e,l),2),w=U.mul(g,c*d);o=U.add(o,w)}}return o}function $r(n,t){t=t||2;var r=xr(-.5,vs(n,2));function e(c){return Ms(Ss.apply(null,c),c.length)}for(var s=e(r),o=e(Ts(r)),i=e(s),l=0;l<r.length;++l)for(var a=0;a<r[0].length;++a)r[l][a]+=i-s[l]-o[a];var u=bs(r),f=xs(u.S);return u.U.map(function(c){return xr(c,f).splice(0,t)})}function Ro(n){const t=n[0],r=n[1];let e=Math.atan2(r,t)/(2*Math.PI)||.5;e=e<0?1+e:e;const s=Math.sqrt(Math.pow(t,2)+Math.pow(r,2))||.5;return[e,s]}function Ao(n){let t=0,r=0;for(let s=0;s<n.length;s++)t+=n[s][0],r+=n[s][1];t/=n.length,r/=n.length;for(let s=0;s<n.length;s++)n[s][0]-=t,n[s][1]-=r;let e=0;for(let s=0;s<n.length;s++){const o=n[s],i=Math.sqrt(o[0]*o[0]+o[1]*o[1]);i>e&&(e=i)}for(let s=0;s<n.length;s++)n[s]=[n[s][0]/e,n[s][1]/e];return n}var qr={eudist:function(t,r){for(var e=t.length,s=0,o=0;o<e;o++){var i=(t[o]||0)-(r[o]||0);s+=i*i}return s},mandist:function(t,r){for(var e=t.length,s=0,o=0,i=0;i<e;i++)o=(t[i]||0)-(r[i]||0),s+=o>=0?o:-o;return s},dist:function(t,r,e){var s=Math.abs(t-r);return e?s:s*s}},Or=qr,Co=Or.eudist,Po=Or.dist,Vo={kmrand:function(t,r){for(var e={},s=[],o=r<<2,i=t.length,l=t[0].length>0;s.length<r&&o-- >0;){var a=t[Math.floor(Math.random()*i)],u=l?a.join("_"):"".concat(a);e[u]||(e[u]=!0,s.push(a))}if(s.length<r)throw new Error("Error initializating clusters");return s},kmpp:function(t,r,e){var s=e||(t[0].length?Co:Po),o=[],i=t.length,l=t[0].length>0,a=t[Math.floor(Math.random()*i)];for(l?a.join("_"):"".concat(a),o.push(a);o.length<r;){for(var u=[],f=o.length,h=0,c=[],d=0;d<i;d++){for(var g=1/0,w=0;w<f;w++){var N=s(t[d],o[w]);N<=g&&(g=N)}u[d]=g}for(var m=0;m<i;m++)h+=u[m];for(var y=0;y<i;y++)c[y]={i:y,v:t[y],pr:u[y]/h,cs:0};c.sort(function(j,S){return j.pr-S.pr}),c[0].cs=c[0].pr;for(var M=1;M<i;M++)c[M].cs=c[M-1].cs+c[M].pr;for(var v=Math.random(),E=0;E<i-1&&c[E++].cs<v;);o.push(c[E-1].v)}return o}},Le=qr,Lr=Vo;Le.eudist,Le.mandist,Le.dist,Lr.kmrand,Lr.kmpp;function $o(n,t,r=!1,e=0,s="cosine"){const o=new L({size:n.length,numberType:L.NumberType.UINT8,sampleDuration:t,featureAmount:r?12:1});return o.fillFeaturesNormalized((i,l,a)=>{if(s==="cosine")return Math.max(0,qn(n[i],n[l],a)-e)/(1-e);if(s==="euclidean")return cr(n[i],n[l],a),Math.max(0,Math.min(1,cr(n[i],n[l],a)-e))/(1-e);if(s==="euclideanTimbre")return Math.max(0,Math.min(1,Bn(n[i],n[l])-e))/(1-e)}),o}function qo(n,t,r=!1){const e=t.blurLength||Math.round(t.blurTime/n.sampleDuration)||4,s=t.tempoRatios||[1],o=t.strategy||"linmed",i=[];for(const a of s)o==="onedir"&&i.push(ae(n,1,Math.floor(e/2),a)),o==="onedir"&&i.push(ae(n,-1,Math.floor(e/2),a)),(o==="linear"||o==="lin")&&i.push(Br(n,e,a)),(o==="gaussian"||o==="gauss")&&i.push(Ur(n,e,a)),o==="onedirmed"&&i.push($t(ae(n,1,Math.floor(e/2),a),e,a)),o==="onedirmed"&&i.push($t(ae(n,-1,Math.floor(e/2),a),e,a)),o==="linmed"&&i.push($t(Br(n,e,a),e*1.5,a)),o==="gaussmed"&&i.push($t(Ur(n,e,a),e*1.5,a)),o==="med"&&i.push($t(n,e,a));const l=L.from(n);return l.fillByIndex(a=>{let u=0;for(const f of i)f.data[a]>u&&(u=f.data[a]);return u}),l}function ae(n,t,r,e){const s=L.from(n),o=new Int8Array(r);for(let i=0;i<r;i++)o[i]=Math.round(i*e);return s.fillFeatures((i,l,a)=>{let u=0;for(let f=0;f!==t*r;f+=t)n.hasCell(i+f,l+t*o[Math.abs(f)])&&(u+=n.getValue(i+f,l+t*o[Math.abs(f)],a));return u/r}),s}function Br(n,t,r){const e=L.from(n),s=Math.round(t/2),o=Math.pow(s+1,2),i=new Int8Array(s*2+1);for(let l=-s;l<1+s;l++)i[l+s]=Math.round(l*r);return e.fillFeatures((l,a,u)=>{let f=0;for(let h=-s;h<1+s;h++)n.hasCell(l+h,a+i[h+s])&&(f+=n.getValue(l+h,a+i[h+s],u)*(s+1-Math.abs(h)));return f/o}),e}function $t(n,t,r,e=128){const s=new Float32Array(e),o=Math.floor((t-1)/2),i=new Int8Array(o*2+1);for(let a=-o;a<1+o;a++)i[a+o]=Math.round(a*r);const l=L.from(n);return l.fillFeaturesNormalized((a,u,f)=>{let h=o*2+1;for(let g=-o;g<=o;g++)if(n.hasCell(a+g,u+i[g+o])){const w=n.getValueNormalized(a+g,u+i[g+o],f);s[Math.floor(w*(e-1))]++}else s[0]++;let c=h/2,d=-1;for(let g=0;g<e;g++)c-=s[g],c<0&&d===-1&&(d=g/(e-1)),s[g]=0;return d}),l}function Ur(n,t,r){const e=L.from(n),s=Math.round(t/2),o=new Int8Array(s*2+1),i=Oo(s);for(let l=-s;l<1+s;l++)o[l+s]=Math.round(l*r);return e.fillFeatures((l,a,u)=>{let f=0;for(let h=-s;h<1+s;h++)n.hasCell(l+h,a+o[h+s])&&(f+=n.getValue(l+h,a+o[h+s],u)*i[h+s]);return f}),e}function Oo(n,t=2){const r=new Float32Array(n*2+1);for(let e=-n;e<1+n;e++)r[e+n]=1/(t*Math.sqrt(2*Math.PI))*Math.exp(-Math.pow(e,2)/(2*Math.pow(t,2)));return r}function Lo(n){const t=n.length/n.featureAmount,r=new L({size:n.size,numberType:L.NumberType.UINT8,sampleDuration:n.sampleDuration});let e=0;for(;e<t;){let s=0;for(let o=0;o<n.featureAmount;o++)n.data[e*n.featureAmount+o]>s&&(s=n.data[e*n.featureAmount+o]);r.data[e]=s,e++}return r}function Bo(n,t,r=t){const e=n.numberType.scale,s=new L({size:n.size,numberType:dt.UINT8}),o=new L({size:n.size,numberType:dt.UINT8});let i=new Uint16Array(e+1);for(let a=0;a<n.size;a++){i.fill(0);for(let h=0;h<n.size;h++)i[n.getValueMirrored(h,a)]++;let u=n.size*t,f=0;for(let h=e;h>0;h--)if(u-=i[h],u<=0){f=h;break}for(let h=0;h<=a;h++)n.getValue(h,a)>=f&&s.setValue(h,a,Math.min(Math.max(n.getValue(h,a)-f,0)/(e-f)*e,e))}for(let a=0;a<n.size;a++){i.fill(0);for(let h=0;h<n.size;h++)i[n.getValueMirrored(a,h)]++;let u=n.size*r,f=0;for(let h=e;h>0;h--)if(u-=i[h],u<=0){f=h;break}for(let h=a;h<=n.size;h++)n.getValue(a,h)>=f&&o.setValue(a,h,Math.min(Math.max(n.getValue(a,h)-f,0)/(e-f)*e,e))}const l=L.from(n);return l.fill((a,u)=>(s.getValue(a,u)+o.getValue(a,u))/2),l}function Uo(n,t){let r;return n instanceof Nt?r=Nt.from(n):r=L.from(n),r.fill((e,s)=>{if(e===s)return r.numberType.max;const o=t.some(l=>l.start<=e&&e<l.end),i=t.some(l=>l.start<=s&&s<l.end);return o&&i?0:n.getValueMirrored(e,s)}),r}function Go(n,t){let r;return n instanceof Nt?r=Nt.from(n):r=L.from(n),r.fill((e,s)=>e===s?r.numberType.max:t.some(i=>i.start<=e&&e<i.end||i.start<=s&&s<i.end)?0:n.getValueMirrored(e,s)),r}function Yo(n,t){let r=n.clone();return t.forEach(e=>{t.forEach(s=>{if(e!==s){const o=e.start,i=s.start,l=e.end,a=s.end,u=l-o,h=(a-i)/u;for(let c=0;c<u;c++){const d=o+c,g=i+c*h;r.setValue(d+2,g-2,0),r.setValue(d+1,g-1,0),r.setValue(d,g,0),r.setValue(d-1,g+1,0),r.setValue(d-2,g+2,0)}}})}),r}function ue(n){if(n instanceof RegExp)return new RegExp(n);if(n instanceof Date)return new Date(n.getTime());if(Array.isArray(n))return n.map(ue);if(typeof n=="object"&&n!==null){const t={};return Object.keys(n).forEach(r=>{t[r]=ue(n[r])}),t}return n}function he(n,t){return n==null||t==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function _o(n,t){return n==null||t==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function Gr(n){let t,r,e;n.length!==2?(t=he,r=(l,a)=>he(n(l),a),e=(l,a)=>n(l)-a):(t=n===he||n===_o?n:Wo,r=n,e=n);function s(l,a,u=0,f=l.length){if(u<f){if(t(a,a)!==0)return f;do{const h=u+f>>>1;r(l[h],a)<0?u=h+1:f=h}while(u<f)}return u}function o(l,a,u=0,f=l.length){if(u<f){if(t(a,a)!==0)return f;do{const h=u+f>>>1;r(l[h],a)<=0?u=h+1:f=h}while(u<f)}return u}function i(l,a,u=0,f=l.length){const h=s(l,a,u,f-1);return h>u&&e(l[h-1],a)>-e(l[h],a)?h-1:h}return{left:s,center:i,right:o}}function Wo(){return 0}function Xo(n){return n===null?NaN:+n}const Qo=Gr(he).right;Gr(Xo).center;const Ko=Math.sqrt(50),Jo=Math.sqrt(10),Zo=Math.sqrt(2);function fe(n,t,r){const e=(t-n)/Math.max(0,r),s=Math.floor(Math.log10(e)),o=e/Math.pow(10,s),i=o>=Ko?10:o>=Jo?5:o>=Zo?2:1;let l,a,u;return s<0?(u=Math.pow(10,-s)/i,l=Math.round(n*u),a=Math.round(t*u),l/u<n&&++l,a/u>t&&--a,u=-u):(u=Math.pow(10,s)*i,l=Math.round(n/u),a=Math.round(t/u),l*u<n&&++l,a*u>t&&--a),a<l&&.5<=r&&r<2?fe(n,t,r*2):[l,a,u]}function Ho(n,t,r){if(t=+t,n=+n,r=+r,!(r>0))return[];if(n===t)return[n];const e=t<n,[s,o,i]=e?fe(t,n,r):fe(n,t,r);if(!(o>=s))return[];const l=o-s+1,a=new Array(l);if(e)if(i<0)for(let u=0;u<l;++u)a[u]=(o-u)/-i;else for(let u=0;u<l;++u)a[u]=(o-u)*i;else if(i<0)for(let u=0;u<l;++u)a[u]=(s+u)/-i;else for(let u=0;u<l;++u)a[u]=(s+u)*i;return a}function Be(n,t,r){return t=+t,n=+n,r=+r,fe(n,t,r)[2]}function ti(n,t,r){t=+t,n=+n,r=+r;const e=t<n,s=e?Be(t,n,r):Be(n,t,r);return(e?-1:1)*(s<0?1/-s:s)}function qt(n,t,r){n.prototype=t.prototype=r,r.constructor=n}function ce(n,t){var r=Object.create(n.prototype);for(var e in t)r[e]=t[e];return r}function bt(){}var Ot=.7,ge=1/Ot,zt="\\s*([+-]?\\d+)\\s*",Lt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",it="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ei=/^#([0-9a-f]{3,8})$/,ri=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),ni=new RegExp(`^rgb\\(${it},${it},${it}\\)$`),si=new RegExp(`^rgba\\(${zt},${zt},${zt},${Lt}\\)$`),oi=new RegExp(`^rgba\\(${it},${it},${it},${Lt}\\)$`),ii=new RegExp(`^hsl\\(${Lt},${it},${it}\\)$`),li=new RegExp(`^hsla\\(${Lt},${it},${it},${Lt}\\)$`),Yr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qt(bt,Bt,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:_r,formatHex:_r,formatHex8:ai,formatHsl:ui,formatRgb:Wr,toString:Wr});function _r(){return this.rgb().formatHex()}function ai(){return this.rgb().formatHex8()}function ui(){return Hr(this).formatHsl()}function Wr(){return this.rgb().formatRgb()}function Bt(n){var t,r;return n=(n+"").trim().toLowerCase(),(t=ei.exec(n))?(r=t[1].length,t=parseInt(t[1],16),r===6?Xr(t):r===3?new K(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?me(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?me(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ri.exec(n))?new K(t[1],t[2],t[3],1):(t=ni.exec(n))?new K(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=si.exec(n))?me(t[1],t[2],t[3],t[4]):(t=oi.exec(n))?me(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ii.exec(n))?Zr(t[1],t[2]/100,t[3]/100,1):(t=li.exec(n))?Zr(t[1],t[2]/100,t[3]/100,t[4]):Yr.hasOwnProperty(n)?Xr(Yr[n]):n==="transparent"?new K(NaN,NaN,NaN,0):null}function Xr(n){return new K(n>>16&255,n>>8&255,n&255,1)}function me(n,t,r,e){return e<=0&&(n=t=r=NaN),new K(n,t,r,e)}function Qr(n){return n instanceof bt||(n=Bt(n)),n?(n=n.rgb(),new K(n.r,n.g,n.b,n.opacity)):new K}function $(n,t,r,e){return arguments.length===1?Qr(n):new K(n,t,r,e??1)}function K(n,t,r,e){this.r=+n,this.g=+t,this.b=+r,this.opacity=+e}qt(K,$,ce(bt,{brighter(n){return n=n==null?ge:Math.pow(ge,n),new K(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Ot:Math.pow(Ot,n),new K(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new K(Mt(this.r),Mt(this.g),Mt(this.b),de(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kr,formatHex:Kr,formatHex8:hi,formatRgb:Jr,toString:Jr}));function Kr(){return`#${vt(this.r)}${vt(this.g)}${vt(this.b)}`}function hi(){return`#${vt(this.r)}${vt(this.g)}${vt(this.b)}${vt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Jr(){const n=de(this.opacity);return`${n===1?"rgb(":"rgba("}${Mt(this.r)}, ${Mt(this.g)}, ${Mt(this.b)}${n===1?")":`, ${n})`}`}function de(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Mt(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function vt(n){return n=Mt(n),(n<16?"0":"")+n.toString(16)}function Zr(n,t,r,e){return e<=0?n=t=r=NaN:r<=0||r>=1?n=t=NaN:t<=0&&(n=NaN),new st(n,t,r,e)}function Hr(n){if(n instanceof st)return new st(n.h,n.s,n.l,n.opacity);if(n instanceof bt||(n=Bt(n)),!n)return new st;if(n instanceof st)return n;n=n.rgb();var t=n.r/255,r=n.g/255,e=n.b/255,s=Math.min(t,r,e),o=Math.max(t,r,e),i=NaN,l=o-s,a=(o+s)/2;return l?(t===o?i=(r-e)/l+(r<e)*6:r===o?i=(e-t)/l+2:i=(t-r)/l+4,l/=a<.5?o+s:2-o-s,i*=60):l=a>0&&a<1?0:i,new st(i,l,a,n.opacity)}function fi(n,t,r,e){return arguments.length===1?Hr(n):new st(n,t,r,e??1)}function st(n,t,r,e){this.h=+n,this.s=+t,this.l=+r,this.opacity=+e}qt(st,fi,ce(bt,{brighter(n){return n=n==null?ge:Math.pow(ge,n),new st(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Ot:Math.pow(Ot,n),new st(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,t=isNaN(n)||isNaN(this.s)?0:this.s,r=this.l,e=r+(r<.5?r:1-r)*t,s=2*r-e;return new K(Ue(n>=240?n-240:n+120,s,e),Ue(n,s,e),Ue(n<120?n+240:n-120,s,e),this.opacity)},clamp(){return new st(tn(this.h),pe(this.s),pe(this.l),de(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=de(this.opacity);return`${n===1?"hsl(":"hsla("}${tn(this.h)}, ${pe(this.s)*100}%, ${pe(this.l)*100}%${n===1?")":`, ${n})`}`}}));function tn(n){return n=(n||0)%360,n<0?n+360:n}function pe(n){return Math.max(0,Math.min(1,n||0))}function Ue(n,t,r){return(n<60?t+(r-t)*n/60:n<180?r:n<240?t+(r-t)*(240-n)/60:t)*255}const ci=Math.PI/180,gi=180/Math.PI,we=18,en=.96422,rn=1,nn=.82521,sn=4/29,Ft=6/29,on=3*Ft*Ft,mi=Ft*Ft*Ft;function ln(n){if(n instanceof lt)return new lt(n.l,n.a,n.b,n.opacity);if(n instanceof ft)return an(n);n instanceof K||(n=Qr(n));var t=We(n.r),r=We(n.g),e=We(n.b),s=Ge((.2225045*t+.7168786*r+.0606169*e)/rn),o,i;return t===r&&r===e?o=i=s:(o=Ge((.4360747*t+.3850649*r+.1430804*e)/en),i=Ge((.0139322*t+.0971045*r+.7141733*e)/nn)),new lt(116*s-16,500*(o-s),200*(s-i),n.opacity)}function di(n,t,r,e){return arguments.length===1?ln(n):new lt(n,t,r,e??1)}function lt(n,t,r,e){this.l=+n,this.a=+t,this.b=+r,this.opacity=+e}qt(lt,di,ce(bt,{brighter(n){return new lt(this.l+we*(n??1),this.a,this.b,this.opacity)},darker(n){return new lt(this.l-we*(n??1),this.a,this.b,this.opacity)},rgb(){var n=(this.l+16)/116,t=isNaN(this.a)?n:n+this.a/500,r=isNaN(this.b)?n:n-this.b/200;return t=en*Ye(t),n=rn*Ye(n),r=nn*Ye(r),new K(_e(3.1338561*t-1.6168667*n-.4906146*r),_e(-.9787684*t+1.9161415*n+.033454*r),_e(.0719453*t-.2289914*n+1.4052427*r),this.opacity)}}));function Ge(n){return n>mi?Math.pow(n,1/3):n/on+sn}function Ye(n){return n>Ft?n*n*n:on*(n-sn)}function _e(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function We(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function pi(n){if(n instanceof ft)return new ft(n.h,n.c,n.l,n.opacity);if(n instanceof lt||(n=ln(n)),n.a===0&&n.b===0)return new ft(NaN,0<n.l&&n.l<100?0:NaN,n.l,n.opacity);var t=Math.atan2(n.b,n.a)*gi;return new ft(t<0?t+360:t,Math.sqrt(n.a*n.a+n.b*n.b),n.l,n.opacity)}function Xe(n,t,r,e){return arguments.length===1?pi(n):new ft(n,t,r,e??1)}function ft(n,t,r,e){this.h=+n,this.c=+t,this.l=+r,this.opacity=+e}function an(n){if(isNaN(n.h))return new lt(n.l,0,0,n.opacity);var t=n.h*ci;return new lt(n.l,Math.cos(t)*n.c,Math.sin(t)*n.c,n.opacity)}qt(ft,Xe,ce(bt,{brighter(n){return new ft(this.h,this.c,this.l+we*(n??1),this.opacity)},darker(n){return new ft(this.h,this.c,this.l-we*(n??1),this.opacity)},rgb(){return an(this).rgb()}}));var ye=n=>()=>n;function un(n,t){return function(r){return n+r*t}}function wi(n,t,r){return n=Math.pow(n,r),t=Math.pow(t,r)-n,r=1/r,function(e){return Math.pow(n+e*t,r)}}function yi(n,t){var r=t-n;return r?un(n,r>180||r<-180?r-360*Math.round(r/360):r):ye(isNaN(n)?t:n)}function bi(n){return(n=+n)==1?Ut:function(t,r){return r-t?wi(t,r,n):ye(isNaN(t)?r:t)}}function Ut(n,t){var r=t-n;return r?un(n,r):ye(isNaN(n)?t:n)}var hn=function n(t){var r=bi(t);function e(s,o){var i=r((s=$(s)).r,(o=$(o)).r),l=r(s.g,o.g),a=r(s.b,o.b),u=Ut(s.opacity,o.opacity);return function(f){return s.r=i(f),s.g=l(f),s.b=a(f),s.opacity=u(f),s+""}}return e.gamma=n,e}(1);function Mi(n,t){t||(t=[]);var r=n?Math.min(t.length,n.length):0,e=t.slice(),s;return function(o){for(s=0;s<r;++s)e[s]=n[s]*(1-o)+t[s]*o;return e}}function vi(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function xi(n,t){var r=t?t.length:0,e=n?Math.min(r,n.length):0,s=new Array(e),o=new Array(r),i;for(i=0;i<e;++i)s[i]=Je(n[i],t[i]);for(;i<r;++i)o[i]=t[i];return function(l){for(i=0;i<e;++i)o[i]=s[i](l);return o}}function Si(n,t){var r=new Date;return n=+n,t=+t,function(e){return r.setTime(n*(1-e)+t*e),r}}function be(n,t){return n=+n,t=+t,function(r){return n*(1-r)+t*r}}function Ei(n,t){var r={},e={},s;(n===null||typeof n!="object")&&(n={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in n?r[s]=Je(n[s],t[s]):e[s]=t[s];return function(o){for(s in r)e[s]=r[s](o);return e}}var Qe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ke=new RegExp(Qe.source,"g");function Ni(n){return function(){return n}}function Ii(n){return function(t){return n(t)+""}}function Ti(n,t){var r=Qe.lastIndex=Ke.lastIndex=0,e,s,o,i=-1,l=[],a=[];for(n=n+"",t=t+"";(e=Qe.exec(n))&&(s=Ke.exec(t));)(o=s.index)>r&&(o=t.slice(r,o),l[i]?l[i]+=o:l[++i]=o),(e=e[0])===(s=s[0])?l[i]?l[i]+=s:l[++i]=s:(l[++i]=null,a.push({i,x:be(e,s)})),r=Ke.lastIndex;return r<t.length&&(o=t.slice(r),l[i]?l[i]+=o:l[++i]=o),l.length<2?a[0]?Ii(a[0].x):Ni(t):(t=a.length,function(u){for(var f=0,h;f<t;++f)l[(h=a[f]).i]=h.x(u);return l.join("")})}function Je(n,t){var r=typeof t,e;return t==null||r==="boolean"?ye(t):(r==="number"?be:r==="string"?(e=Bt(t))?(t=e,hn):Ti:t instanceof Bt?hn:t instanceof Date?Si:vi(t)?Mi:Array.isArray(t)?xi:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Ei:be)(n,t)}function ji(n,t){return n=+n,t=+t,function(r){return Math.round(n*(1-r)+t*r)}}function ki(n){return function(t,r){var e=n((t=Xe(t)).h,(r=Xe(r)).h),s=Ut(t.c,r.c),o=Ut(t.l,r.l),i=Ut(t.opacity,r.opacity);return function(l){return t.h=e(l),t.c=s(l),t.l=o(l),t.opacity=i(l),t+""}}}var fn=ki(yi);function zi(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Me(n,t){if((r=(n=t?n.toExponential(t-1):n.toExponential()).indexOf("e"))<0)return null;var r,e=n.slice(0,r);return[e.length>1?e[0]+e.slice(2):e,+n.slice(r+1)]}function Dt(n){return n=Me(Math.abs(n)),n?n[1]:NaN}function Fi(n,t){return function(r,e){for(var s=r.length,o=[],i=0,l=n[0],a=0;s>0&&l>0&&(a+l+1>e&&(l=Math.max(1,e-a)),o.push(r.substring(s-=l,s+l)),!((a+=l+1)>e));)l=n[i=(i+1)%n.length];return o.reverse().join(t)}}function Di(n){return function(t){return t.replace(/[0-9]/g,function(r){return n[+r]})}}var Ri=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ve(n){if(!(t=Ri.exec(n)))throw new Error("invalid format: "+n);var t;return new Ze({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ve.prototype=Ze.prototype;function Ze(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Ze.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ai(n){t:for(var t=n.length,r=1,e=-1,s;r<t;++r)switch(n[r]){case".":e=s=r;break;case"0":e===0&&(e=r),s=r;break;default:if(!+n[r])break t;e>0&&(e=0);break}return e>0?n.slice(0,e)+n.slice(s+1):n}var cn;function Ci(n,t){var r=Me(n,t);if(!r)return n+"";var e=r[0],s=r[1],o=s-(cn=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,i=e.length;return o===i?e:o>i?e+new Array(o-i+1).join("0"):o>0?e.slice(0,o)+"."+e.slice(o):"0."+new Array(1-o).join("0")+Me(n,Math.max(0,t+o-1))[0]}function gn(n,t){var r=Me(n,t);if(!r)return n+"";var e=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+e:e.length>s+1?e.slice(0,s+1)+"."+e.slice(s+1):e+new Array(s-e.length+2).join("0")}var mn={"%":(n,t)=>(n*100).toFixed(t),b:n=>Math.round(n).toString(2),c:n=>n+"",d:zi,e:(n,t)=>n.toExponential(t),f:(n,t)=>n.toFixed(t),g:(n,t)=>n.toPrecision(t),o:n=>Math.round(n).toString(8),p:(n,t)=>gn(n*100,t),r:gn,s:Ci,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function dn(n){return n}var pn=Array.prototype.map,wn=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Pi(n){var t=n.grouping===void 0||n.thousands===void 0?dn:Fi(pn.call(n.grouping,Number),n.thousands+""),r=n.currency===void 0?"":n.currency[0]+"",e=n.currency===void 0?"":n.currency[1]+"",s=n.decimal===void 0?".":n.decimal+"",o=n.numerals===void 0?dn:Di(pn.call(n.numerals,String)),i=n.percent===void 0?"%":n.percent+"",l=n.minus===void 0?"":n.minus+"",a=n.nan===void 0?"NaN":n.nan+"";function u(h){h=ve(h);var c=h.fill,d=h.align,g=h.sign,w=h.symbol,N=h.zero,m=h.width,y=h.comma,M=h.precision,v=h.trim,E=h.type;E==="n"?(y=!0,E="g"):mn[E]||(M===void 0&&(M=12),v=!0,E="g"),(N||c==="0"&&d==="=")&&(N=!0,c="0",d="=");var j=w==="$"?r:w==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",S=w==="$"?e:/[%p]/.test(E)?i:"",T=mn[E],F=/[defgprs%]/.test(E);M=M===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function p(b){var I=j,x=S,z,A,C;if(E==="c")x=T(b)+x,b="";else{b=+b;var q=b<0||1/b<0;if(b=isNaN(b)?a:T(Math.abs(b),M),v&&(b=Ai(b)),q&&+b==0&&g!=="+"&&(q=!1),I=(q?g==="("?g:l:g==="-"||g==="("?"":g)+I,x=(E==="s"?wn[8+cn/3]:"")+x+(q&&g==="("?")":""),F){for(z=-1,A=b.length;++z<A;)if(C=b.charCodeAt(z),48>C||C>57){x=(C===46?s+b.slice(z+1):b.slice(z))+x,b=b.slice(0,z);break}}}y&&!N&&(b=t(b,1/0));var G=I.length+b.length+x.length,Y=G<m?new Array(m-G+1).join(c):"";switch(y&&N&&(b=t(Y+b,Y.length?m-x.length:1/0),Y=""),d){case"<":b=I+b+x+Y;break;case"=":b=I+Y+b+x;break;case"^":b=Y.slice(0,G=Y.length>>1)+I+b+x+Y.slice(G);break;default:b=Y+I+b+x;break}return o(b)}return p.toString=function(){return h+""},p}function f(h,c){var d=u((h=ve(h),h.type="f",h)),g=Math.max(-8,Math.min(8,Math.floor(Dt(c)/3)))*3,w=Math.pow(10,-g),N=wn[8+g/3];return function(m){return d(w*m)+N}}return{format:u,formatPrefix:f}}var xe,yn,bn;Vi({thousands:",",grouping:[3],currency:["$",""]});function Vi(n){return xe=Pi(n),yn=xe.format,bn=xe.formatPrefix,xe}function $i(n){return Math.max(0,-Dt(Math.abs(n)))}function qi(n,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Dt(t)/3)))*3-Dt(Math.abs(n)))}function Oi(n,t){return n=Math.abs(n),t=Math.abs(t)-n,Math.max(0,Dt(t)-Dt(n))+1}function Li(n,t){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(t).domain(n);break}return this}function Bi(n){return function(){return n}}function Ui(n){return+n}var Mn=[0,1];function Rt(n){return n}function He(n,t){return(t-=n=+n)?function(r){return(r-n)/t}:Bi(isNaN(t)?NaN:.5)}function Gi(n,t){var r;return n>t&&(r=n,n=t,t=r),function(e){return Math.max(n,Math.min(t,e))}}function Yi(n,t,r){var e=n[0],s=n[1],o=t[0],i=t[1];return s<e?(e=He(s,e),o=r(i,o)):(e=He(e,s),o=r(o,i)),function(l){return o(e(l))}}function _i(n,t,r){var e=Math.min(n.length,t.length)-1,s=new Array(e),o=new Array(e),i=-1;for(n[e]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++i<e;)s[i]=He(n[i],n[i+1]),o[i]=r(t[i],t[i+1]);return function(l){var a=Qo(n,l,1,e)-1;return o[a](s[a](l))}}function Wi(n,t){return t.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function Xi(){var n=Mn,t=Mn,r=Je,e,s,o,i=Rt,l,a,u;function f(){var c=Math.min(n.length,t.length);return i!==Rt&&(i=Gi(n[0],n[c-1])),l=c>2?_i:Yi,a=u=null,h}function h(c){return c==null||isNaN(c=+c)?o:(a||(a=l(n.map(e),t,r)))(e(i(c)))}return h.invert=function(c){return i(s((u||(u=l(t,n.map(e),be)))(c)))},h.domain=function(c){return arguments.length?(n=Array.from(c,Ui),f()):n.slice()},h.range=function(c){return arguments.length?(t=Array.from(c),f()):t.slice()},h.rangeRound=function(c){return t=Array.from(c),r=ji,f()},h.clamp=function(c){return arguments.length?(i=c?!0:Rt,f()):i!==Rt},h.interpolate=function(c){return arguments.length?(r=c,f()):r},h.unknown=function(c){return arguments.length?(o=c,h):o},function(c,d){return e=c,s=d,f()}}function Qi(){return Xi()(Rt,Rt)}function Ki(n,t,r,e){var s=ti(n,t,r),o;switch(e=ve(e??",f"),e.type){case"s":{var i=Math.max(Math.abs(n),Math.abs(t));return e.precision==null&&!isNaN(o=qi(s,i))&&(e.precision=o),bn(e,i)}case"":case"e":case"g":case"p":case"r":{e.precision==null&&!isNaN(o=Oi(s,Math.max(Math.abs(n),Math.abs(t))))&&(e.precision=o-(e.type==="e"));break}case"f":case"%":{e.precision==null&&!isNaN(o=$i(s))&&(e.precision=o-(e.type==="%")*2);break}}return yn(e)}function Ji(n){var t=n.domain;return n.ticks=function(r){var e=t();return Ho(e[0],e[e.length-1],r??10)},n.tickFormat=function(r,e){var s=t();return Ki(s[0],s[s.length-1],r??10,e)},n.nice=function(r){r==null&&(r=10);var e=t(),s=0,o=e.length-1,i=e[s],l=e[o],a,u,f=10;for(l<i&&(u=i,i=l,l=u,u=s,s=o,o=u);f-- >0;){if(u=Be(i,l,r),u===a)return e[s]=i,e[o]=l,t(e);if(u>0)i=Math.floor(i/u)*u,l=Math.ceil(l/u)*u;else if(u<0)i=Math.ceil(i*u)/u,l=Math.floor(l*u)/u;else break;a=u}return n},n}function tr(){var n=Qi();return n.copy=function(){return Wi(n,tr())},Li.apply(n,arguments),Ji(n)}function Gt(n,t,r){this.k=n,this.x=t,this.y=r}Gt.prototype={constructor:Gt,scale:function(n){return n===1?this:new Gt(this.k*n,this.x,this.y)},translate:function(n,t){return n===0&t===0?this:new Gt(this.k,this.x+this.k*n,this.y+this.k*t)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},Gt.prototype;const Zi=["C","D","D","E","E","F","F","G","A","A","B","B","Cm","Dm","Dm","Em","Em","Fm","Fm","Gm","Am","Am","Bm","Bm"];tr().domain([0,1/12,2/12,2.8/12,3.8/12,4.3/12,5.3/12,6.8/12,8/12,8.8/12,9.3/12,10.5/12,1]).interpolate(fn).range([$("#FE0000"),$("#FF7300"),$("#FFAA01"),$("#FFD300"),$("#FFFF01"),$("#9FEE00"),$("#01CC00"),$("#009899"),$("#1241AB"),$("#3914B1"),$("#7209AC"),$("#CD0174"),$("#FE0000")]),tr().domain([0,1/12,2/12,3/12,4/12,5/12,6/12,7/12,8/12,9/12,10/12,11/12,1]).interpolate(fn).range([$("#da321f"),$("#e06300"),$("#e89b00"),$("#ebcb03"),$("#9fbb04"),$("#2cbe03"),$("#03b779"),$("#06b3bd"),$("#3875cc"),$("#7503db"),$("#c203ae"),$("#e84b90"),$("#da321f")]);class xt{constructor(t){V(this,"start");V(this,"end");V(this,"startSample");V(this,"endSample");V(this,"confidence",1);V(this,"groupID",0);V(this,"key",-1);V(this,"mdsFeature");V(this,"parent",!1);V(this,"pathFamily");V(this,"pathFamilyScores");V(this,"score");V(this,"normalizedScore");V(this,"coverage");V(this,"normalizedCoverage");V(this,"fitness");this.start=t.start,this.end=t.end,this.startSample=t.startSample,this.endSample=t.endSample,t.groupID!==void 0&&(this.groupID=t.groupID),t.confidence!==void 0&&(this.confidence=t.confidence),t.mdsFeature!==void 0&&(this.mdsFeature=t.mdsFeature),t.colorAngle!==void 0&&(this.colorAngle=t.colorAngle),t.colorRadius!==void 0&&(this.colorRadius=t.colorRadius)}getDuration(){return this.end-this.start}getVerticalPosition(){}overlaps(t){return this.start<=t.start&&this.end>t.start||this.start<t.start&&this.end>=t.end||t.start<=this.start&&t.end>this.start||t.start<this.start&&t.end>=this.end||this.start>=t.start&&this.end<=t.end||t.start>=this.start&&t.end<=this.end}splits(t){return t.start<this.start&&t.end>this.end}covers(t){return this.start<=t.start&&this.end>=t.end}clipsStart(t){return this.end>t.start&&this.end<t.end&&this.start<=t.start}clipsEnd(t){return this.start>t.start&&this.start<t.end&&this.end>=t.end}disjoint(t){return this.end<=t.start||this.start>=t.end}clone(){return ue(this)}amountOfSectionsAfterSubtract(t){return t.covers(this)?0:t.splits(this)?2:1}subtract(t){if(t.disjoint(this))return this;if(gt(this.amountOfSectionsAfterSubtract(t)===1,`Won't subtract, subtraction yields ${this.amountOfSectionsAfterSubtract(t)} sections [${this.start}, ${this.end}] - [${t.start}, ${t.end}]`),t.clipsEnd(this)?this.end=t.start:t.clipsStart(this)&&(this.start=t.end),this.end<=this.start)throw new Error("Section end is before start");return this}subtractAndCreateNew(t){if(t.covers(this))return[];if(t.splits(this)){const e=this.clone();e.end=t.start;const s=this.clone();return s.start=t.end,[e,s]}return[this.clone().subtract(t)]}getKeyName(){return Zi[this.key]}}function Hi(n,t,r){const e=[];let s=0;for(;s+r<n;)e.push(new xt({start:s*t,end:(s+r)*t})),s+=r;return e}function tl(n,t,r=1,e=.4,s){const o=n.getSampleAmount(),i=t.length,l=n.sampleDuration,a=e*o*l,u=Zt(o),f=[];for(let h=0;h<i;h++)for(let c=h;c<i;c++){const d=t[h].start,g=t[c].end,w=g-d;if(w<r||w>a)continue;const N=Math.floor(d/l),m=Math.floor(g/l);f.push(ml(n,N,m,u,s,f.length))}return f}function el(n,t,r,e=1,s=.25){const o=[];return t.forEach(i=>{const l=tl(n,i,e,s,r);o.push(l)}),o}const rl=!0;function nl(n,t,r,e="classic",s="or",o,i="fitness",l=2,a=.02){const u=t[t.length-1].end;let f=[],h=[];const c=[];let d=[t],g=n,w=0;const N=14;for(;d.length>0&&w<N;){let m=el(g,d,e,l);const y=[].concat.apply([],m);if(y.length===0)break;let v=y.sort((x,z)=>x[i]<z[i]?1:x[i]>z[i]?-1:0).shift();const E=v.fitness;if(v=ul(g,v,sl,i,e,h,l),v===null||v[i]<=a||isNaN(v[i]))break;const j=w;v.groupID=j;const S=ol(v,r,j),T=il(v,r,j,n,e),F=al(S,T),p=ll(F,.1);p.forEach(x=>{x.normalizedScore=v.normalizedScore,x.normalizedCoverage=v.normalizedCoverage,x.fitness=v.fitness,x.initFitness=E}),h.push(...p),f.push(...p);const b=p.map(x=>{const z=x.clone();return z.start=Math.floor(z.start/r),z.end=Math.floor(z.end/r),z});s==="and"?g=Uo(g,b):s==="remove"?g=Yo(g,b):g=Go(g,b),h=h.sort((x,z)=>x.start>z.start?1:-1),o&&o(f),d=hl(ue(d),h,u,l);const I=[].concat.apply([],d);I.forEach(x=>x.groupID=w),c.push(...I),w++}return[h,w,c]}const sl=3;function ol(n,t,r){const e=[];return n.pathFamily?(n.pathFamily.forEach((s,o)=>{const i=s[s.length-1][1]*t,l=(s[0][1]+1)*t,a=n.pathFamilyScores?n.pathFamilyScores[o]:n.pathScores[o],u=new xt({start:i,end:l,groupID:r,confidence:a});u.pathFamily=n.pathFamily,e.push(u)}),e):[]}function il(n,t,r,e,s){const o=Zt(e.getSampleAmount()),i=[];return n.pathFamily.forEach((l,a)=>{const u=l[l.length-1][1]*t,f=(l[0][1]+1)*t,h=n.pathFamilyScores?n.pathFamilyScores[a]:n.pathScores[a],c=new xt({start:u,end:f,groupID:r,confidence:h});c.pathFamily=n.pathFamily,i.push(c)}),i.forEach(l=>{const a=Math.floor(l.start/t),u=Math.floor(l.end/t),f=je(e,a,u,o,s);f.pathFamily.forEach((h,c)=>{const d=h[h.length-1][1]*t,g=(h[0][1]+1)*t,w=new xt({start:d,end:g,groupID:r,confidence:l.confidence*f.pathScores[c]});w.pathFamily=n.pathFamily,i.push(w)})}),i}function ll(n,t){const r=[];return n.forEach(e=>{e.confidence>=t&&r.push(e)}),r}function al(n,t,r=0){const e=[...n];return t.sort((o,i)=>o.confidence>i.confidence?1:-1).forEach(o=>{let i=0;e.forEach(l=>{if(l.overlaps(o)){const a=l.end-l.start,u=o.end-o.start,h=gl(l,o)/(a+u);h>i&&(i=h)}}),(i>0&&i<r||i<=0)&&e.push(o)}),e}function ul(n,t,r=4,e,s,o=[],i){const l=n.getSampleAmount(),a=n.sampleDuration,u=Math.floor(t.start/a),f=Math.floor(t.end/a),h=Zt(l);let c=t[e],d=t;for(let g=-r;g<r;g++)for(let w=-r;w<r;w++){const N=u+g,m=f+w,y=N*a,M=m*a;if(N>=0&&m<l&&M-y>=i&&rl){const v=je(n,N,m,h,s);v.start=N*a,v.end=m*a,v[e]>c&&(d=v,c=v[e])}}return d}function hl(n,t,r,e){let s=[];const o=[].concat.apply([],n);return fl(t,r,e).forEach(l=>{const a=l[0],u=l[1];let f=[],h=a;o.forEach(c=>{c.start>h&&c.start<u&&(f.push(new xt({start:h,end:c.start})),h=c.start)}),f.push(new xt({start:h,end:u})),s.push(f)}),s}function fl(n,t,r){const e=[[0,t]];return n.forEach(s=>{e.forEach((o,i)=>{const l=o[0],a=o[1];if(l>=s.start&&a<=s.end){e.splice(i,1);return}if(l<=s.start&&a>s.start&&a<=s.end){o[1]=s.start;return}if(l<s.end&&a>=s.start&&l>=s.start){o[0]=s.end;return}if(l<s.start&&a>s.end){e.push([l,s.start]),e.push([s.end,a]),e.splice(i,1);return}})}),e.filter(s=>s[1]-s[0]>=r)}function cl(n,t,r="overlap",e,s=!1){if(n.length===0)return n;const o=br(n,t,r),i=vn(n,o,e);if(s){const l=br(n,t,r,0),a=vn(n,l,e);for(let u=0;u<i.length;u++)i[u].catColorAngle=a[u].colorAngle,i[u].catColorRadius=a[u].colorRadius,i[u].catMdsFeature=a[u].mdsFeature}return i}function vn(n,t,r){const e=[],s=ko(t,r),o=jo(t);n.forEach((a,u)=>{const[f,h]=Ro(s[u]),c=a.clone();c.colorAngle=f,c.colorRadius=h,c.mdsFeature=o[u],e.push(c)}),e.sort((a,u)=>a.colorAngle>u.colorAngle?1:u.colorAngle>a.colorAngle?-1:0);let i=1-e[e.length-1].colorAngle+e[0].colorAngle,l=e[0].colorAngle;for(let a=1;a<e.length;a++){const u=e[a].colorAngle-e[a-1].colorAngle;u>i&&(i=u,l=e[a].colorAngle)}return e.forEach(a=>{a.colorAngle=(1+(a.colorAngle-l))%1}),e.sort((a,u)=>a.groupID>u.groupID?1:u.groupID>a.groupID?-1:a.start-u.start),e}function gl(n,t){return n.start<=t.start&&n.end>t.start?n.end-t.start:t.start<=n.start&&t.end>n.start?t.end-n.start:n.start<t.start&&n.end>=t.end?t.end-t.start:t.start<n.start&&t.end>=n.end||n.start>=t.start&&n.end<=t.end?n.end-n.start:t.start>=n.start&&t.end<=n.end?t.end-t.start:0}function ml(n,t,r,e,s,o){const i=je(n,t,r,e,s),l=t*n.sampleDuration,a=r*n.sampleDuration,u=new xt({start:l,end:a,groupID:o});return u.pathFamily=i.pathFamily,u.pathFamilyScores=i.pathScores,u.score=i.score,u.normalizedScore=i.normalizedScore,u.coverage=i.coverage,u.normalizedCoverage=i.normalizedCoverage,u.fitness=i.fitness,u}const dl=[1.7917,-1.2083,.2917,-1.2083,1.2917,.7917,-1.2083,1.2917,-1.2083,.2917,-1.7083,.7917],pl=[1.7917,-1.2083,.2917,1.2917,-1.2083,.7917,-1.2083,1.2917,.2917,-1.2083,-1.7083,.7917];function wl(n,t,r){const e=r-t;let s=new Float32Array(12);for(let o=t;o<r;o++)for(let i=0;i<12;i++)s[i]+=n[o][i]/e;return yl(s)}function yl(n){const t=bl(n);let r=Number.NEGATIVE_INFINITY,e=-1;return t.forEach((s,o)=>{s>r&&(r=s,e=o)}),e}function bl(n){const t=dl,r=pl,e=n.reduce((h,c)=>h+c)/12,s=[],o=[];for(let h=0;h<12;h++)s.push(n.reduce((c,d,g)=>c+(d-e)*t[(12+g-h)%12])),o.push(n.reduce((c,d,g)=>c+(d-e)*r[(12+g-h)%12]));const i=Math.sqrt(n.reduce((h,c,d)=>h+Math.pow(c-e,2))),l=Math.sqrt(t.reduce((h,c)=>h+Math.pow(c,2))),a=Math.sqrt(r.reduce((h,c)=>h+Math.pow(c,2))),u=[],f=[];for(let h=0;h<12;h++)u.push(s[h]/(i*l)),f.push(o[h]/(i*a));return[...u,...f]}const Ml={computeHarmonicStructure(n){const t=n.pitchFeatures.length,r=Pn(n.pitchFeatures,1),e=$o(r,n.sampleDuration,n.allPitches,.35,"euclidean"),s=qo(e,{blurLength:n.enhanceBlurLength,tempoRatios:n.tempoRatios,strategy:"linmed"},n.allPitches),o=Lo(s);let i=Bo(o,.15);const l=Nt.fromHalfMatrix(i),u=Hi(t,n.sampleDuration,3),f=(g,w="processing",N="Classic")=>{let m=g;try{m=vl(g,l,N)}catch(y){console.warn("There was an error updating the structure: ",y,`
The final harmonic structure is: `,m)}finally{return m.forEach(y=>{const M=Math.floor(y.start/n.sampleDuration),v=Math.floor(y.end/n.sampleDuration),E=wl(n.pitchFeatures,M,v);y.key=E}),{state:w,harmonicStructure:m}}};let[h,c,d]=nl(l,u,n.sampleDuration,"classic","or",f);return f(h,"done","GD")}};function vl(n,t,r){return cl(n,t,"DTW",r,!0).sort((o,i)=>{if(o.groupID<i.groupID)return-1;if(i.groupID<o.groupID)return 1;if(o.groupID===i.groupID)return o.start-i.start})}Ie(Ml)})();
